/*! For license information please see main.0e021878.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},150:(e,t,n)=>{n.d(t,{MF:()=>de,j6:()=>ae,xZ:()=>oe,om:()=>se,Sx:()=>fe,Wp:()=>he,KO:()=>pe});var r=n(812),i=n(443),s=n(700),a=n(555);let o,l;const c=new WeakMap,u=new WeakMap,d=new WeakMap,h=new WeakMap,f=new WeakMap;let p={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return u.get(e);if("objectStoreNames"===t)return e.objectStoreNames||d.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return y(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function m(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(l||(l=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(v(this),n),y(c.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return y(e.apply(v(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(v(this),t,...r);return d.set(s,t.sort?t.sort():[t]),y(s)}}function g(e){return"function"===typeof e?m(e):(e instanceof IDBTransaction&&function(e){if(u.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));u.set(e,t)}(e),t=e,(o||(o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,p):e);var t}function y(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(y(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&c.set(t,e)})).catch((()=>{})),f.set(t,e),t}(e);if(h.has(e))return h.get(e);const t=g(e);return t!==e&&(h.set(e,t),f.set(t,e)),t}const v=e=>f.get(e);const b=["get","getKey","getAll","getAllKeys","count"],w=["put","add","delete","clear"],x=new Map;function _(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(x.get(t))return x.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=w.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!b.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var a=arguments.length,o=new Array(a>1?a-1:0),l=1;l<a;l++)o[l-1]=arguments[l];return r&&(s=s.index(o.shift())),(await Promise.all([s[n](...o),i&&t.done]))[0]};return x.set(t,s),s}p=(e=>(0,a.A)((0,a.A)({},e),{},{get:(t,n,r)=>_(t,n)||e.get(t,n,r),has:(t,n)=>!!_(t,n)||e.has(t,n)}))(p);class S{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return"".concat(t.library,"/").concat(t.version)}return null})).filter((e=>e)).join(" ")}}const E="@firebase/app",k="0.10.13",T=new i.Vy("@firebase/app"),I="@firebase/app-compat",N="@firebase/analytics-compat",C="@firebase/analytics",A="@firebase/app-check-compat",j="@firebase/app-check",D="@firebase/auth",P="@firebase/auth-compat",O="@firebase/database",R="@firebase/data-connect",M="@firebase/database-compat",L="@firebase/functions",U="@firebase/functions-compat",F="@firebase/installations",z="@firebase/installations-compat",V="@firebase/messaging",B="@firebase/messaging-compat",G="@firebase/performance",q="@firebase/performance-compat",W="@firebase/remote-config",H="@firebase/remote-config-compat",K="@firebase/storage",Q="@firebase/storage-compat",X="@firebase/firestore",Y="@firebase/vertexai-preview",$="@firebase/firestore-compat",J="firebase",Z="[DEFAULT]",ee={[E]:"fire-core",[I]:"fire-core-compat",[C]:"fire-analytics",[N]:"fire-analytics-compat",[j]:"fire-app-check",[A]:"fire-app-check-compat",[D]:"fire-auth",[P]:"fire-auth-compat",[O]:"fire-rtdb",[R]:"fire-data-connect",[M]:"fire-rtdb-compat",[L]:"fire-fn",[U]:"fire-fn-compat",[F]:"fire-iid",[z]:"fire-iid-compat",[V]:"fire-fcm",[B]:"fire-fcm-compat",[G]:"fire-perf",[q]:"fire-perf-compat",[W]:"fire-rc",[H]:"fire-rc-compat",[K]:"fire-gcs",[Q]:"fire-gcs-compat",[X]:"fire-fst",[$]:"fire-fst-compat",[Y]:"fire-vertex","fire-js":"fire-js",[J]:"fire-js-all"},te=new Map,ne=new Map,re=new Map;function ie(e,t){try{e.container.addComponent(t)}catch(n){T.debug("Component ".concat(t.name," failed to register with FirebaseApp ").concat(e.name),n)}}function se(e){const t=e.name;if(re.has(t))return T.debug("There were multiple attempts to register component ".concat(t,".")),!1;re.set(t,e);for(const n of te.values())ie(n,e);for(const n of ne.values())ie(n,e);return!0}function ae(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function oe(e){return void 0!==e.settings}const le={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ce=new s.FA("app","Firebase",le);class ue{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new r.uA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ce.create("app-deleted",{appName:this._name})}}const de="10.14.1";function he(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const i=Object.assign({name:Z,automaticDataCollectionEnabled:!1},t),a=i.name;if("string"!==typeof a||!a)throw ce.create("bad-app-name",{appName:String(a)});if(n||(n=(0,s.T9)()),!n)throw ce.create("no-options");const o=te.get(a);if(o){if((0,s.bD)(n,o.options)&&(0,s.bD)(i,o.config))return o;throw ce.create("duplicate-app",{appName:a})}const l=new r.h1(a);for(const r of re.values())l.addComponent(r);const c=new ue(n,i,l);return te.set(a,c),c}function fe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z;const t=te.get(e);if(!t&&e===Z&&(0,s.T9)())return he();if(!t)throw ce.create("no-app",{appName:e});return t}function pe(e,t,n){var i;let s=null!==(i=ee[e])&&void 0!==i?i:e;n&&(s+="-".concat(n));const a=s.match(/\s|\//),o=t.match(/\s|\//);if(a||o){const e=['Unable to register library "'.concat(s,'" with version "').concat(t,'":')];return a&&e.push('library name "'.concat(s,'" contains illegal characters (whitespace or "/")')),a&&o&&e.push("and"),o&&e.push('version name "'.concat(t,'" contains illegal characters (whitespace or "/")')),void T.warn(e.join(" "))}se(new r.uA("".concat(s,"-version"),(()=>({library:s,version:t})),"VERSION"))}const me="firebase-heartbeat-store";let ge=null;function ye(){return ge||(ge=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=indexedDB.open(e,t),o=y(a);return r&&a.addEventListener("upgradeneeded",(e=>{r(y(a.result),e.oldVersion,e.newVersion,y(a.transaction),e)})),n&&a.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),o.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),o}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(me)}catch(n){console.warn(n)}}}).catch((e=>{throw ce.create("idb-open",{originalErrorMessage:e.message})}))),ge}async function ve(e,t){try{const n=(await ye()).transaction(me,"readwrite"),r=n.objectStore(me);await r.put(t,be(e)),await n.done}catch(n){if(n instanceof s.g)T.warn(n.message);else{const e=ce.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});T.warn(e.message)}}}function be(e){return"".concat(e.name,"!").concat(e.options.appId)}class we{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new _e(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=xe();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return;return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}catch(n){T.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=xe(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),Se(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Se(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=(0,s.Uj)(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return T.warn(t),""}}}function xe(){return(new Date).toISOString().substring(0,10)}class _e{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,s.zW)()&&(0,s.eX)().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await ye()).transaction(me),n=await t.objectStore(me).get(be(e));return await t.done,n}catch(t){if(t instanceof s.g)T.warn(t.message);else{const e=ce.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});T.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ve(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return ve(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Se(e){return(0,s.Uj)(JSON.stringify({version:2,heartbeats:e})).length}var Ee;Ee="",se(new r.uA("platform-logger",(e=>new S(e)),"PRIVATE")),se(new r.uA("heartbeat",(e=>new we(e)),"PRIVATE")),pe(E,k,Ee),pe(E,k,"esm2017"),pe("fire-js","")},153:(e,t,n)=>{var r=n(43),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,s={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)a.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:s,_owner:o.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function v(){}function b(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var w=b.prototype=new v;w.constructor=b,m(w,y.prototype),w.isPureReactComponent=!0;var x=Array.isArray,_=Object.prototype.hasOwnProperty,S={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function k(e,t,r){var i,s={},a=null,o=null;if(null!=t)for(i in void 0!==t.ref&&(o=t.ref),void 0!==t.key&&(a=""+t.key),t)_.call(t,i)&&!E.hasOwnProperty(i)&&(s[i]=t[i]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===s[i]&&(s[i]=l[i]);return{$$typeof:n,type:e,key:a,ref:o,props:s,_owner:S.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var I=/\/+/g;function N(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function C(e,t,i,s,a){var o=typeof e;"undefined"!==o&&"boolean"!==o||(e=null);var l=!1;if(null===e)l=!0;else switch(o){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return a=a(l=e),e=""===s?"."+N(l,0):s,x(a)?(i="",null!=e&&(i=e.replace(I,"$&/")+"/"),C(a,t,i,"",(function(e){return e}))):null!=a&&(T(a)&&(a=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,i+(!a.key||l&&l.key===a.key?"":(""+a.key).replace(I,"$&/")+"/")+e)),t.push(a)),1;if(l=0,s=""===s?".":s+":",x(e))for(var c=0;c<e.length;c++){var u=s+N(o=e[c],c);l+=C(o,t,i,u,a)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(o=e.next()).done;)l+=C(o=o.value,t,i,u=s+N(o,c++),a);else if("object"===o)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function A(e,t,n){if(null==e)return e;var r=[],i=0;return C(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function j(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var D={current:null},P={transition:null},O={ReactCurrentDispatcher:D,ReactCurrentBatchConfig:P,ReactCurrentOwner:S};function R(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,n){A(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return A(e,(function(){t++})),t},toArray:function(e){return A(e,(function(e){return e}))||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=i,t.Profiler=a,t.PureComponent=b,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.act=R,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),s=e.key,a=e.ref,o=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,o=S.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)_.call(t,c)&&!E.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:s,ref:a,props:i,_owner:o}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:o,_context:e},e.Consumer=e},t.createElement=k,t.createFactory=function(e){var t=k.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:j}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=P.transition;P.transition={};try{e()}finally{P.transition=t}},t.unstable_act=R,t.useCallback=function(e,t){return D.current.useCallback(e,t)},t.useContext=function(e){return D.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return D.current.useDeferredValue(e)},t.useEffect=function(e,t){return D.current.useEffect(e,t)},t.useId=function(){return D.current.useId()},t.useImperativeHandle=function(e,t,n){return D.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return D.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return D.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return D.current.useMemo(e,t)},t.useReducer=function(e,t,n){return D.current.useReducer(e,t,n)},t.useRef=function(e){return D.current.useRef(e)},t.useState=function(e){return D.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return D.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return D.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,a=i>>>1;r<a;){var o=2*(r+1)-1,l=e[o],c=o+1,u=e[c];if(0>s(l,n))c<i&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[o]=n,r=o);else{if(!(c<i&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,p=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function w(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function x(e){if(g=!1,w(e),!m)if(null!==r(c))m=!0,P(_);else{var t=r(u);null!==t&&O(x,t.startTime-e)}}function _(e,n){m=!1,g&&(g=!1,v(T),T=-1),p=!0;var s=f;try{for(w(n),h=r(c);null!==h&&(!(h.expirationTime>n)||e&&!C());){var a=h.callback;if("function"===typeof a){h.callback=null,f=h.priorityLevel;var o=a(h.expirationTime<=n);n=t.unstable_now(),"function"===typeof o?h.callback=o:h===r(c)&&i(c),w(n)}else i(c);h=r(c)}if(null!==h)var l=!0;else{var d=r(u);null!==d&&O(x,d.startTime-n),l=!1}return l}finally{h=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,E=!1,k=null,T=-1,I=5,N=-1;function C(){return!(t.unstable_now()-N<I)}function A(){if(null!==k){var e=t.unstable_now();N=e;var n=!0;try{n=k(!0,e)}finally{n?S():(E=!1,k=null)}}else E=!1}if("function"===typeof b)S=function(){b(A)};else if("undefined"!==typeof MessageChannel){var j=new MessageChannel,D=j.port2;j.port1.onmessage=A,S=function(){D.postMessage(null)}}else S=function(){y(A,0)};function P(e){k=e,E||(E=!0,S())}function O(e,n){T=y((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,P(_))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,s){var a=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?a+s:a:s=a,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return e={id:d++,callback:i,priorityLevel:e,startTime:s,expirationTime:o=s+o,sortIndex:-1},s>a?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(g?(v(T),T=-1):g=!0,O(x,s-a))):(e.sortIndex=o,n(c,e),m||p||(m=!0,P(_))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},443:(e,t,n)=>{n.d(t,{$b:()=>i,Vy:()=>c});const r=[];var i;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(i||(i={}));const s={debug:i.DEBUG,verbose:i.VERBOSE,info:i.INFO,warn:i.WARN,error:i.ERROR,silent:i.SILENT},a=i.INFO,o={[i.DEBUG]:"log",[i.VERBOSE]:"log",[i.INFO]:"info",[i.WARN]:"warn",[i.ERROR]:"error"},l=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=o[t];if(!r)throw new Error("Attempted to log a message with an invalid logType (value: ".concat(t,")"));for(var i=arguments.length,s=new Array(i>2?i-2:0),a=2;a<i;a++)s[a-2]=arguments[a];console[r]("[".concat(n,"]  ").concat(e.name,":"),...s)};class c{constructor(e){this.name=e,this._logLevel=a,this._logHandler=l,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in i))throw new TypeError('Invalid value "'.concat(e,'" assigned to `logLevel`'));this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?s[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.DEBUG,...t),this._logHandler(this,i.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.VERBOSE,...t),this._logHandler(this,i.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.INFO,...t),this._logHandler(this,i.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.WARN,...t),this._logHandler(this,i.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,i.ERROR,...t),this._logHandler(this,i.ERROR,...t)}}},472:(e,t,n)=>{n.d(t,{Dc:()=>Q,gS:()=>sl,hq:()=>ml,rJ:()=>Ga,deleteField:()=>fl,LA:()=>Ja,doc:()=>qa,Os:()=>$a,getDoc:()=>tl,GG:()=>rl,aU:()=>Qa,GV:()=>gl,AB:()=>Go,aQ:()=>al,My:()=>Vo,P:()=>Mo,runTransaction:()=>hl,serverTimestamp:()=>pl,updateDoc:()=>il,_M:()=>Uo});var r,i,s=n(150),a=n(812),o=n(443),l=n(700),c="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},u={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],a=t+(s^n&(i^s))+r[0]+3614090360&4294967295;a=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(a<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|a>>>10))+((a=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|a>>>25))+((a=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|a>>>20))+((a=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|a>>>15))+((a=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|a>>>10))+((a=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|a>>>12))+((a=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|a>>>27))+((a=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|a>>>23))+((a=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|a>>>18))+((a=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|a>>>12))+((a=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|a>>>9))+((a=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|a>>>28))+((a=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|a>>>21))+((a=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|a>>>16))+((a=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|a>>>9))+((a=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|a>>>17))+((a=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|a>>>11))+((a=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|a>>>17))+((a=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|a>>>11))+((a=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|a>>>22))+((a=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|a>>>17))+((a=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|a>>>11))+((s=(t=n+((a=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|a>>>26))+((a=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|a>>>22))^((i=s+((a=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|a>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(a<<21&4294967295|a>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function s(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,s=this.h,a=0;a<t;){if(0==s)for(;a<=r;)n(this,e,a),a+=this.blockSize;if("string"===typeof e){for(;a<t;)if(i[s++]=e.charCodeAt(a++),s==this.blockSize){n(this,i),s=0;break}}else for(;a<t;)if(i[s++]=e[a++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var a={};function o(e){return-128<=e&&128>e?function(e,t){var n=a;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new s([0|e],0>e?-1:0)})):new s([0|e],0>e?-1:0)}function l(e){if(isNaN(e)||!isFinite(e))return c;if(0>e)return m(l(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new s(t,0)}var c=o(0),d=o(1),h=o(16777216);function f(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function p(e){return-1==e.h}function m(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new s(n,~e.h).add(d)}function g(e,t){return e.add(m(t))}function y(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function v(e,t){this.g=e,this.h=t}function b(e,t){if(f(t))throw Error("division by zero");if(f(e))return new v(c,c);if(p(e))return t=b(m(e),t),new v(m(t.g),m(t.h));if(p(t))return t=b(e,m(t)),new v(m(t.g),t.h);if(30<e.g.length){if(p(e)||p(t))throw Error("slowDivide_ only works with positive integers.");for(var n=d,r=t;0>=r.l(e);)n=w(n),r=w(r);var i=x(n,1),s=x(r,1);for(r=x(r,2),n=x(n,2);!f(r);){var a=s.add(r);0>=a.l(e)&&(i=i.add(n),s=a),r=x(r,1),n=x(n,1)}return t=g(e,i.j(t)),new v(i,t)}for(i=c;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),a=(s=l(n)).j(t);p(a)||0<a.l(e);)a=(s=l(n-=r)).j(t);f(s)&&(s=d),i=i.add(s),e=g(e,a)}return new v(i,e)}function w(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new s(n,e.h)}function x(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],a=0;a<r;a++)i[a]=0<t?e.i(a+n)>>>t|e.i(a+n+1)<<32-t:e.i(a+n);return new s(i,e.h)}(e=s.prototype).m=function(){if(p(this))return-m(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(f(this))return"0";if(p(this))return"-"+m(this).toString(e);for(var t=l(Math.pow(e,6)),n=this,r="";;){var i=b(n,t).g,s=((0<(n=g(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(f(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return p(e=g(this,e))?-1:f(e)?0:1},e.abs=function(){return p(this)?m(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var a=r+(65535&this.i(i))+(65535&e.i(i)),o=(a>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);r=o>>>16,a&=65535,o&=65535,n[i]=o<<16|a}return new s(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(f(this)||f(e))return c;if(p(this))return p(e)?m(this).j(m(e)):m(m(this).j(e));if(p(e))return m(this.j(m(e)));if(0>this.l(h)&&0>e.l(h))return l(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var a=this.i(r)>>>16,o=65535&this.i(r),u=e.i(i)>>>16,d=65535&e.i(i);n[2*r+2*i]+=o*d,y(n,2*r+2*i),n[2*r+2*i+1]+=a*d,y(n,2*r+2*i+1),n[2*r+2*i+1]+=o*u,y(n,2*r+2*i+1),n[2*r+2*i+2]+=a*u,y(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new s(n,0)},e.A=function(e){return b(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new s(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new s(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new s(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,i=u.Md5=t,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.A,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=l,s.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return m(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=l(Math.pow(n,8)),i=c,s=0;s<t.length;s+=8){var a=Math.min(8,t.length-s),o=parseInt(t.substring(s,s+a),n);8>a?(a=l(Math.pow(n,a)),i=i.j(a).add(l(o))):i=(i=i.j(r)).add(l(o))}return i},r=u.Integer=s}).apply("undefined"!==typeof c?c:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var d,h,f,p,m,g,y,v,b="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},w={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof b&&b];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var a=e[s];if(!(a in i))break e;i=i[a]}(r=r(s=i[e=e[e.length-1]]))!=s&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e,t){return t}))}}));var r=r||{},i=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function a(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function o(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function c(e,t,n){return(c=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?o:l).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function _(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function S(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function k(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(s(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function T(e){return/^[\s\xa0]*$/.test(e)}function I(){var e=i.navigator;return e&&(e=e.userAgent)?e:""}function N(e){return N[" "](e),e}N[" "]=function(){};var C=-1!=I().indexOf("Gecko")&&!(-1!=I().toLowerCase().indexOf("webkit")&&-1==I().indexOf("Edge"))&&!(-1!=I().indexOf("Trident")||-1!=I().indexOf("MSIE"))&&-1==I().indexOf("Edge");function A(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function j(e){const t={};for(const n in e)t[n]=e[n];return t}const D="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<D.length;t++)n=D[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function O(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function R(e){i.setTimeout((()=>{throw e}),0)}function M(){var e=V;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var L=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new U),(e=>e.reset()));class U{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let F,z=!1,V=new class{constructor(){this.h=this.g=null}add(e,t){const n=L.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},B=()=>{const e=i.Promise.resolve(void 0);F=()=>{e.then(G)}};var G=()=>{for(var e;e=M();){try{e.h.call(e.g)}catch(n){R(n)}var t=L;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}z=!1};function q(){this.s=this.s,this.C=this.C}function W(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}q.prototype.s=!1,q.prototype.ma=function(){this.s||(this.s=!0,this.N())},q.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},W.prototype.h=function(){this.defaultPrevented=!0};var H=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(n){}return e}();function K(e,t){if(W.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(C){e:{try{N(t.nodeName);var i=!0;break e}catch(s){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:Q[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&K.aa.h.call(this)}}_(K,W);var Q={2:"touch",3:"pen",4:"mouse"};K.prototype.h=function(){K.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var X="closure_listenable_"+(1e6*Math.random()|0),Y=0;function $(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++Y,this.da=this.fa=!1}function J(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function Z(e){this.src=e,this.g={},this.h=0}function ee(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Array.prototype.indexOf.call(i,t,void 0);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(J(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function te(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}Z.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var a=te(e,t,r,i);return-1<a?(t=e[a],n||(t.fa=!1)):((t=new $(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var ne="closure_lm_"+(1e6*Math.random()|0),re={};function ie(e,t,n,r,i){if(r&&r.once)return ae(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)ie(e,t[s],n,r,i);return null}return n=fe(n),e&&e[X]?e.K(t,n,a(r)?!!r.capture:!!r,i):se(e,t,n,!1,r,i)}function se(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=a(i)?!!i.capture:!!i,l=de(e);if(l||(e[ne]=l=new Z(e)),(n=l.add(t,n,r,o,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=ue;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)H||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(ce(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ae(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)ae(e,t[s],n,r,i);return null}return n=fe(n),e&&e[X]?e.L(t,n,a(r)?!!r.capture:!!r,i):se(e,t,n,!0,r,i)}function oe(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)oe(e,t[s],n,r,i);else r=a(r)?!!r.capture:!!r,n=fe(n),e&&e[X]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=te(s=e.g[t],n,r,i))&&(J(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=de(e))&&(t=e.g[t.toString()],e=-1,t&&(e=te(t,n,r,i)),(n=-1<e?t[e]:null)&&le(n))}function le(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[X])ee(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(ce(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=de(t))?(ee(n,e),0==n.h&&(n.src=null,t[ne]=null)):J(e)}}}function ce(e){return e in re?re[e]:re[e]="on"+e}function ue(e,t){if(e.da)e=!0;else{t=new K(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&le(e),e=n.call(r,t)}return e}function de(e){return(e=e[ne])instanceof Z?e:null}var he="__closure_events_fn_"+(1e9*Math.random()>>>0);function fe(e){return"function"===typeof e?e:(e[he]||(e[he]=function(t){return e.handleEvent(t)}),e[he])}function pe(){q.call(this),this.i=new Z(this),this.M=this,this.F=null}function me(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new W(t,e);else if(t instanceof W)t.target=t.target||e;else{var i=t;P(t=new W(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var a=t.g=n[s];i=ge(a,r,!0,t)&&i}if(i=ge(a=t.g=e,r,!0,t)&&i,i=ge(a,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=ge(a=t.g=n[s],r,!1,t)&&i}function ge(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var a=t[s];if(a&&!a.da&&a.capture==n){var o=a.listener,l=a.ha||a.src;a.fa&&ee(e.i,a),i=!1!==o.call(l,r)&&i}}return i&&!r.defaultPrevented}function ye(e,t,n){if("function"===typeof e)n&&(e=c(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function ve(e){e.g=ye((()=>{e.g=null,e.i&&(e.i=!1,ve(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}_(pe,q),pe.prototype[X]=!0,pe.prototype.removeEventListener=function(e,t,n,r){oe(this,e,t,n,r)},pe.prototype.N=function(){if(pe.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)J(n[r]);delete t.g[e],t.h--}}this.F=null},pe.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},pe.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class be extends q{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ve(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function we(e){q.call(this),this.h=e,this.g={}}_(we,q);var xe=[];function _e(e){A(e.g,(function(e,t){this.g.hasOwnProperty(t)&&le(e)}),e),e.g={}}we.prototype.N=function(){we.aa.N.call(this),_e(this)},we.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Se=i.JSON.stringify,Ee=i.JSON.parse,ke=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function Te(){}function Ie(e){return e.h||(e.h=e.i())}function Ne(){}Te.prototype.h=null;var Ce={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ae(){W.call(this,"d")}function je(){W.call(this,"c")}_(Ae,W),_(je,W);var De={},Pe=null;function Oe(){return Pe=Pe||new pe}function Re(e){W.call(this,De.La,e)}function Me(e){const t=Oe();me(t,new Re(t))}function Le(e,t){W.call(this,De.STAT_EVENT,e),this.stat=t}function Ue(e){const t=Oe();me(t,new Le(t,e))}function Fe(e,t){W.call(this,De.Ma,e),this.size=t}function ze(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout((function(){e()}),t)}function Ve(){this.g=!0}function Be(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var a=1;a<i.length;a++)i[a]=""}}}return Se(n)}catch(o){return t}}(e,n)+(r?" "+r:"")}))}De.La="serverreachability",_(Re,W),De.STAT_EVENT="statevent",_(Le,W),De.Ma="timingevent",_(Fe,W),Ve.prototype.xa=function(){this.g=!1},Ve.prototype.info=function(){};var Ge,qe={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},We={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function He(){}function Ke(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new we(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Qe}function Qe(){this.i=null,this.g="",this.h=!1}_(He,Te),He.prototype.g=function(){return new XMLHttpRequest},He.prototype.i=function(){return{}},Ge=new He;var Xe={},Ye={};function $e(e,t,n){e.L=1,e.v=St(vt(t)),e.m=n,e.P=!0,Je(e,null)}function Je(e,t){e.F=Date.now(),tt(e),e.A=vt(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),Lt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Qe,e.g=kn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new be(c(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(xe[0]=i.toString()),i=xe);for(var s=0;s<i.length;s++){var a=ie(n,i[s],r||t.handleEvent,!1,t.h||t);if(!a)break;t.g[a.key]=a}t=e.H?j(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Me(),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var a="",o=s.split("&"),l=0;l<o.length;l++){var c=o[l].split("=");if(1<c.length){var u=c[0];c=c[1];var d=u.split("_");a=2<=d.length&&"type"==d[1]?a+(u+"=")+c+"&":a+(u+"=redacted&")}}else a=null;else a=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+a}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function Ze(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function et(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Ye:(n=Number(t.substring(n,r)),isNaN(n)?Xe:(r+=1)+n>t.length?Ye:(t=t.slice(r,r+n),e.C=r+n,t))}function tt(e){e.S=Date.now()+e.I,nt(e,e.I)}function nt(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=ze(c(e.ba,e),t)}function rt(e){e.B&&(i.clearTimeout(e.B),e.B=null)}function it(e){0==e.j.G||e.J||wn(e.j,e)}function st(e){rt(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,_e(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function at(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||dt(n.h,e)))if(!e.K&&dt(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;bn(n),cn(n)}gn(n),Ue(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=ze(c(n.Za,n),6e3));if(1>=ut(n.h)&&n.ca){try{n.ca()}catch(u){}n.ca=void 0}}else _n(n,11)}else if((e.K||n.g==e)&&bn(n),!T(t))for(i=n.Da.g.parse(t),t=0;t<i.length;t++){let c=i[t];if(n.T=c[0],c=c[1],2==n.G)if("c"==c[0]){n.K=c[1],n.ia=c[2];const t=c[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const i=c[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const u=c[5];null!=u&&"number"===typeof u&&0<u&&(r=1.5*u,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const d=e.g;if(d){const e=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(ht(s,s.h),s.h=null))}if(r.D){const e=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,_t(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var a=e;if((r=n).qa=En(r,r.J?r.ia:null,r.W),a.K){ft(r.h,a);var o=a,l=r.L;l&&(o.I=l),o.B&&(rt(o),tt(o)),r.g=a}else mn(r);0<n.i.length&&dn(n)}else"stop"!=c[0]&&"close"!=c[0]||_n(n,7);else 3==n.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?_n(n,7):ln(n):"noop"!=c[0]&&n.l&&n.l.ta(c),n.v=0)}Me()}catch(u){}}Ke.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==rn(e)?t.j():this.Y(e)},Ke.prototype.Y=function(e){try{if(e==this.g)e:{const h=rn(this.g);var t=this.g.Ba();this.g.Z();if(!(3>h)&&(3!=h||this.g&&(this.h.h||this.g.oa()||sn(this.g)))){this.J||4!=h||7==t||Me(),rt(this);var n=this.g.Z();this.X=n;t:if(Ze(this)){var r=sn(this.g);e="";var s=r.length,a=4==rn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){st(this),it(this);var o="";break t}this.h.i=new i.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(a&&t==s-1)});r.length=0,this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.oa();if(this.o=200==n,function(e,t,n,r,i,s,a){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+a}))}(this.i,this.u,this.A,this.l,this.R,h,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,c=this.g;if((l=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(l)){var u=l;break t}}u=null}if(!(n=u)){this.o=!1,this.s=3,Ue(12),st(this),it(this);break e}Be(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,at(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<o.length;){if(e=et(this,o),e==Ye){4==h&&(this.s=4,Ue(14),n=!1),Be(this.i,this.l,null,"[Incomplete Response]");break}if(e==Xe){this.s=4,Ue(15),Be(this.i,this.l,o,"[Invalid Chunk]"),n=!1;break}Be(this.i,this.l,e,null),at(this,e)}if(Ze(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=h||0!=o.length||this.h.h||(this.s=1,Ue(16),n=!1),this.o=this.o&&n,n){if(0<o.length&&!this.W){this.W=!0;var d=this.j;d.g==this&&d.ba&&!d.M&&(d.j.info("Great, no buffering proxy detected. Bytes received: "+o.length),yn(d),d.M=!0,Ue(11))}}else Be(this.i,this.l,o,"[Invalid Chunked Response]"),st(this),it(this)}else Be(this.i,this.l,o,null),at(this,o);4==h&&st(this),this.o&&!this.J&&(4==h?wn(this.j,this):(this.o=!1,tt(this)))}else(function(e){const t={};e=(e.g&&2<=rn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(T(e[r]))continue;var n=O(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<o.indexOf("Unknown SID")?(this.s=3,Ue(12)):(this.s=0,Ue(13)),st(this),it(this)}}}catch(x){}},Ke.prototype.cancel=function(){this.J=!0,st(this)},Ke.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(Me(),Ue(17)),st(this),this.s=2,it(this)):nt(this,this.S-e)};var ot=class{constructor(e,t){this.g=e,this.map=t}};function lt(e){this.l=e||10,i.PerformanceNavigationTiming?e=0<(e=i.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ct(e){return!!e.h||!!e.g&&e.g.size>=e.j}function ut(e){return e.h?1:e.g?e.g.size:0}function dt(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function ht(e,t){e.g?e.g.add(t):e.h=t}function ft(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function pt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return S(e.i)}function mt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(s(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(s(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,a=0;a<i;a++)t.call(void 0,r[a],n&&n[a],e)}lt.prototype.cancel=function(){if(this.i=pt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var gt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yt(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof yt){this.h=e.h,bt(this,e.j),this.o=e.o,this.g=e.g,wt(this,e.s),this.l=e.l;var t=e.i,n=new Pt;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),xt(this,n),this.m=e.m}else e&&(t=String(e).match(gt))?(this.h=!1,bt(this,t[1]||"",!0),this.o=Et(t[2]||""),this.g=Et(t[3]||"",!0),wt(this,t[4]),this.l=Et(t[5]||"",!0),xt(this,t[6]||"",!0),this.m=Et(t[7]||"")):(this.h=!1,this.i=new Pt(null,this.h))}function vt(e){return new yt(e)}function bt(e,t,n){e.j=n?Et(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function wt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function xt(e,t,n){t instanceof Pt?(e.i=t,function(e,t){t&&!e.j&&(Ot(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(Rt(this,t),Lt(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=kt(t,jt)),e.i=new Pt(t,e.h))}function _t(e,t,n){e.i.set(t,n)}function St(e){return _t(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Et(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function kt(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,Tt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Tt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}yt.prototype.toString=function(){var e=[],t=this.j;t&&e.push(kt(t,Nt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(kt(t,Nt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(kt(n,"/"==n.charAt(0)?At:Ct,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",kt(n,Dt)),e.join("")};var It,Nt=/[#\/\?@]/g,Ct=/[#\?:]/g,At=/[#\?]/g,jt=/[#\?@]/g,Dt=/#/g;function Pt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function Ot(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Rt(e,t){Ot(e),t=Ut(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Mt(e,t){return Ot(e),t=Ut(e,t),e.g.has(t)}function Lt(e,t,n){Rt(e,t),0<n.length&&(e.i=null,e.g.set(Ut(e,t),S(n)),e.h+=n.length)}function Ut(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Ft(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(s){}}function zt(){this.g=new ke}function Vt(e,t,n){const r=n||"";try{mt(e,(function(e,n){let i=e;a(e)&&(i=Se(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function Bt(e){this.l=e.Ub||null,this.j=e.eb||!1}function Gt(e,t){pe.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function qt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Wt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Ht(e)}function Ht(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Kt(e){let t="";return A(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Qt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Kt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):_t(e,t,n))}function Xt(e){pe.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=Pt.prototype).add=function(e,t){Ot(this),this.i=null,e=Ut(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){Ot(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},e.na=function(){Ot(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},e.V=function(e){Ot(this);let t=[];if("string"===typeof e)Mt(this,e)&&(t=t.concat(this.g.get(Ut(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return Ot(this),this.i=null,Mt(this,e=Ut(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),a=this.V(r);for(r=0;r<a.length;r++){var i=s;""!==a[r]&&(i+="="+encodeURIComponent(String(a[r]))),e.push(i)}}return this.i=e.join("&")},_(Bt,Te),Bt.prototype.g=function(){return new Gt(this.l,this.j)},Bt.prototype.i=(It={},function(){return It}),_(Gt,pe),(e=Gt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Ht(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||i).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Wt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ht(this)),this.g&&(this.readyState=3,Ht(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;qt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Wt(this):Ht(this),3==this.readyState&&qt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Wt(this))},e.Qa=function(e){this.g&&(this.response=e,Wt(this))},e.ga=function(){this.g&&Wt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Gt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),_(Xt,pe);var Yt=/^https?$/i,$t=["POST","PUT"];function Jt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Zt(e),tn(e)}function Zt(e){e.A||(e.A=!0,me(e,"complete"),me(e,"error"))}function en(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=rn(e)||2!=e.Z()))if(e.u&&4==rn(e))ye(e.Ea,0,e);else if(me(e,"readystatechange"),4==rn(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var s;if(s=0===r){var a=String(e.D).match(gt)[1]||null;!a&&i.self&&i.self.location&&(a=i.self.location.protocol.slice(0,-1)),s=!Yt.test(a?a.toLowerCase():"")}n=s}if(n)me(e,"complete"),me(e,"success");else{e.m=6;try{var o=2<rn(e)?e.g.statusText:""}catch(l){o=""}e.l=o+" ["+e.Z()+"]",Zt(e)}}finally{tn(e)}}}function tn(e,t){if(e.g){nn(e);const r=e.g,i=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||me(e,"ready");try{r.onreadystatechange=i}catch(n){}}}function nn(e){e.I&&(i.clearTimeout(e.I),e.I=null)}function rn(e){return e.g?e.g.readyState:0}function sn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(E){return null}}function an(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function on(e){this.Aa=0,this.i=[],this.j=new Ve,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=an("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=an("baseRetryDelayMs",5e3,e),this.cb=an("retryDelaySeedMs",1e4,e),this.Wa=an("forwardChannelMaxRetries",2,e),this.wa=an("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new lt(e&&e.concurrentRequestLimit),this.Da=new zt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function ln(e){if(un(e),3==e.G){var t=e.U++,n=vt(e.I);if(_t(n,"SID",e.K),_t(n,"RID",t),_t(n,"TYPE","terminate"),fn(e,n),(t=new Ke(e,e.j,t)).L=2,t.v=St(vt(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&i.Image&&((new Image).src=t.v,n=!0),n||(t.g=kn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),tt(t)}Sn(e)}function cn(e){e.g&&(yn(e),e.g.cancel(),e.g=null)}function un(e){cn(e),e.u&&(i.clearTimeout(e.u),e.u=null),bn(e),e.h.cancel(),e.s&&("number"===typeof e.s&&i.clearTimeout(e.s),e.s=null)}function dn(e){if(!ct(e.h)&&!e.s){e.s=!0;var t=e.Ga;F||B(),z||(F(),z=!0),V.add(t,e),e.B=0}}function hn(e,t){var n;n=t?t.l:e.U++;const r=vt(e.I);_t(r,"SID",e.K),_t(r,"RID",n),_t(r,"AID",e.T),fn(e,r),e.m&&e.o&&Qt(r,e.m,e.o),n=new Ke(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=pn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),ht(e.h,n),$e(n,r,t)}function fn(e,t){e.H&&A(e.H,(function(e,n){_t(t,n,e)})),e.l&&mt({},(function(e,n){_t(t,n,e)}))}function pn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?c(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let a=0;a<n;a++){let n=i[a].g;const o=i[a].map;if(n-=t,0>n)t=Math.max(0,i[a].g-100),s=!1;else try{Vt(o,e,"req"+n+"_")}catch(x){r&&r(o)}}if(s){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function mn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;F||B(),z||(F(),z=!0),V.add(t,e),e.v=0}}function gn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=ze(c(e.Fa,e),xn(e,e.v)),e.v++,!0)}function yn(e){null!=e.A&&(i.clearTimeout(e.A),e.A=null)}function vn(e){e.g=new Ke(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=vt(e.qa);_t(t,"RID","rpc"),_t(t,"SID",e.K),_t(t,"AID",e.T),_t(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&_t(t,"TO",e.ja),_t(t,"TYPE","xmlhttp"),fn(e,t),e.m&&e.o&&Qt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=St(vt(t)),n.m=null,n.P=!0,Je(n,e)}function bn(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function wn(e,t){var n=null;if(e.g==t){bn(e),yn(e),e.g=null;var r=2}else{if(!dt(e.h,t))return;n=t.D,ft(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;me(r=Oe(),new Fe(r,n)),dn(e)}else mn(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==r&&function(e,t){return!(ut(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=ze(c(e.Ga,e,t),xn(e,e.B)),e.B++,!0))}(e,t)||2==r&&gn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:_n(e,5);break;case 4:_n(e,10);break;case 3:_n(e,6);break;default:_n(e,2)}}function xn(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function _n(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.fb,e),r=e.Xa;const t=!r;r=new yt(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||bt(r,"https"),St(r),t?function(e,t){const n=new Ve;if(i.Image){const r=new Image;r.onload=u(Ft,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(Ft,n,"TestLoadImage: error",!1,t,r),r.onabort=u(Ft,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(Ft,n,"TestLoadImage: timeout",!1,t,r),i.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ve;const n=new AbortController,r=setTimeout((()=>{n.abort(),Ft(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(r),e.ok?Ft(0,0,!0,t):Ft(0,0,!1,t)})).catch((()=>{clearTimeout(r),Ft(0,0,!1,t)}))}(r.toString(),n)}else Ue(2);e.G=0,e.l&&e.l.sa(t),Sn(e),un(e)}function Sn(e){if(e.G=0,e.ka=[],e.l){const t=pt(e.h);0==t.length&&0==e.i.length||(k(e.ka,t),k(e.ka,e.i),e.h.i.length=0,S(e.i),e.i.length=0),e.l.ra()}}function En(e,t,n){var r=n instanceof yt?vt(n):new yt(n);if(""!=r.g)t&&(r.g=t+"."+r.g),wt(r,r.s);else{var s=i.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var a=new yt(null);r&&bt(a,r),t&&(a.g=t),s&&wt(a,s),n&&(a.l=n),r=a}return n=e.D,t=e.ya,n&&t&&_t(r,n,t),_t(r,"VER",e.la),fn(e,r),r}function kn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Xt(new Bt({eb:n})):new Xt(e.pa)).Ha(e.J),t}function Tn(){}function In(){}function Nn(e,t){pe.call(this),this.g=new on(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!T(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!T(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new jn(this)}function Cn(e){Ae.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function An(){je.call(this),this.status=1}function jn(e){this.g=e}(e=Xt.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ge.g(),this.v=this.o?Ie(this.o):Ie(Ge),this.g.onreadystatechange=c(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(a){return void Jt(this,a)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),s=i.FormData&&e instanceof i.FormData,!(0<=Array.prototype.indexOf.call($t,t,void 0))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,o]of n)this.g.setRequestHeader(i,o);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{nn(this),this.u=!0,this.g.send(e),this.u=!1}catch(a){Jt(this,a)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,me(this,"complete"),me(this,"abort"),tn(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),tn(this,!0)),Xt.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?en(this):this.bb())},e.bb=function(){en(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<rn(this)?this.g.status:-1}catch(It){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(It){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Ee(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=on.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){Ue(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=En(this,null,this.W),dn(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new Ke(this,this.j,e);let s=this.o;if(this.S&&(s?(s=j(s),P(s,this.S)):s=this.S),null!==this.m||this.O||(i.H=s,s=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=pn(this,i,t),_t(n=vt(this.I),"RID",e),_t(n,"CVER",22),this.D&&_t(n,"X-HTTP-Session-Id",this.D),fn(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Kt(s)))+"&"+t:this.m&&Qt(n,this.m,s)),ht(this.h,i),this.Ua&&_t(n,"TYPE","init"),this.P?(_t(n,"$req",t),_t(n,"SID","null"),i.T=!0,$e(i,n,null)):$e(i,n,t),this.G=2}}else 3==this.G&&(e?hn(this,e):0==this.i.length||ct(this.h)||hn(this))},e.Fa=function(){if(this.u=null,vn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=ze(c(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ue(10),cn(this),vn(this))},e.Za=function(){null!=this.C&&(this.C=null,cn(this),gn(this),Ue(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),Ue(2)):(this.j.info("Failed to ping google.com"),Ue(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=Tn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},In.prototype.g=function(e,t){return new Nn(e,t)},_(Nn,pe),Nn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Nn.prototype.close=function(){ln(this.g)},Nn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=Se(e),e=n);t.i.push(new ot(t.Ya++,e)),3==t.G&&dn(t)},Nn.prototype.N=function(){this.g.l=null,delete this.j,ln(this.g),delete this.g,Nn.aa.N.call(this)},_(Cn,Ae),_(An,je),_(jn,Tn),jn.prototype.ua=function(){me(this.g,"a")},jn.prototype.ta=function(e){me(this.g,new Cn(e))},jn.prototype.sa=function(e){me(this.g,new An)},jn.prototype.ra=function(){me(this.g,"b")},In.prototype.createWebChannel=In.prototype.g,Nn.prototype.send=Nn.prototype.o,Nn.prototype.open=Nn.prototype.m,Nn.prototype.close=Nn.prototype.close,v=w.createWebChannelTransport=function(){return new In},y=w.getStatEventTarget=function(){return Oe()},g=w.Event=De,m=w.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},qe.NO_ERROR=0,qe.TIMEOUT=8,qe.HTTP_ERROR=6,p=w.ErrorCode=qe,We.COMPLETE="complete",f=w.EventType=We,Ne.EventType=Ce,Ce.OPEN="a",Ce.CLOSE="b",Ce.ERROR="c",Ce.MESSAGE="d",pe.prototype.listen=pe.prototype.K,h=w.WebChannel=Ne,w.FetchXmlHttpFactory=Bt,Xt.prototype.listenOnce=Xt.prototype.L,Xt.prototype.getLastError=Xt.prototype.Ka,Xt.prototype.getLastErrorCode=Xt.prototype.Ba,Xt.prototype.getStatus=Xt.prototype.Z,Xt.prototype.getResponseJson=Xt.prototype.Oa,Xt.prototype.getResponseText=Xt.prototype.oa,Xt.prototype.send=Xt.prototype.ea,Xt.prototype.setWithCredentials=Xt.prototype.Ha,d=w.XhrIo=Xt}).apply("undefined"!==typeof b?b:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const x="@firebase/firestore";class _{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}_.UNAUTHENTICATED=new _(null),_.GOOGLE_CREDENTIALS=new _("google-credentials-uid"),_.FIRST_PARTY=new _("first-party-uid"),_.MOCK_USER=new _("mock-user");let S="10.14.0";const E=new o.Vy("@firebase/firestore");function k(){return E.logLevel}function T(e){if(E.logLevel<=o.$b.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(C);E.debug("Firestore (".concat(S,"): ").concat(e),...i)}}function I(e){if(E.logLevel<=o.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(C);E.error("Firestore (".concat(S,"): ").concat(e),...i)}}function N(e){if(E.logLevel<=o.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(C);E.warn("Firestore (".concat(S,"): ").concat(e),...i)}}function C(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function A(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state";const t="FIRESTORE (".concat(S,") INTERNAL ASSERTION FAILED: ")+e;throw I(t),new Error(t)}function j(e,t){e||A()}function D(e,t){return e}const P={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class O extends l.g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>"".concat(this.name,": [code=").concat(this.code,"]: ").concat(this.message)}}class R{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class M{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization","Bearer ".concat(e))}}class L{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(_.UNAUTHENTICATED)))}shutdown(){}}class U{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class F{constructor(e){this.t=e,this.currentUser=_.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){j(void 0===this.o);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new R;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new R,e.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},a=e=>{T("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit((e=>a(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?a(e):(T("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new R)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(T("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(j("string"==typeof t.accessToken),new M(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return j(null===e||"string"==typeof e),new _(e)}}class z{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=_.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class V{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new z(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(_.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class B{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class G{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){j(void 0===this.o);const n=e=>{null!=e.error&&T("FirebaseAppCheckTokenProvider","Error getting App Check token; using placeholder token instead. Error: ".concat(e.error.message));const n=e.token!==this.R;return this.R=e.token,T("FirebaseAppCheckTokenProvider","Received ".concat(n?"new":"existing"," token.")),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{T("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):T("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(j("string"==typeof e.token),this.R=e.token,new B(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function q(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class W{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=q(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function H(e,t){return e<t?-1:e>t?1:0}function K(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}class Q{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new O(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new O(P.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new O(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new O(P.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Q.fromMillis(Date.now())}static fromDate(e){return Q.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Q(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?H(this.nanoseconds,e.nanoseconds):H(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class X{constructor(e){this.timestamp=e}static fromTimestamp(e){return new X(e)}static min(){return new X(new Q(0,0))}static max(){return new X(new Q(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Y{constructor(e,t,n){void 0===t?t=0:t>e.length&&A(),void 0===n?n=e.length-t:n>e.length-t&&A(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Y.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Y?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class $ extends Y{construct(e,t,n){return new $(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new O(P.INVALID_ARGUMENT,"Invalid segment (".concat(i,"). Paths must not contain // in them."));e.push(...i.split("/").filter((e=>e.length>0)))}return new $(e)}static emptyPath(){return new $([])}}const J=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Z extends Y{construct(e,t,n){return new Z(e,t,n)}static isValidIdentifier(e){return J.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Z.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Z(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new O(P.INVALID_ARGUMENT,"Invalid field path (".concat(e,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"));t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new O(P.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new O(P.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new O(P.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Z(t)}static emptyPath(){return new Z([])}}class ee{constructor(e){this.path=e}static fromPath(e){return new ee($.fromString(e))}static fromName(e){return new ee($.fromString(e).popFirst(5))}static empty(){return new ee($.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===$.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return $.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ee(new $(e.slice()))}}class te{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}te.UNKNOWN_ID=-1;function ne(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=X.fromTimestamp(1e9===r?new Q(n+1,0):new Q(n,r));return new ie(i,ee.empty(),t)}function re(e){return new ie(e.readTime,e.key,-1)}class ie{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new ie(X.min(),ee.empty(),-1)}static max(){return new ie(X.max(),ee.empty(),-1)}}function se(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=ee.comparator(e.documentKey,t.documentKey),0!==n?n:H(e.largestBatchId,t.largestBatchId))}const ae="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class oe{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function le(e){if(e.code!==P.FAILED_PRECONDITION||e.message!==ae)throw e;T("LocalStore","Unexpectedly lost primary lease")}class ce{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&A(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ce(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof ce?t:ce.resolve(t)}catch(e){return ce.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):ce.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):ce.reject(t)}static resolve(e){return new ce(((t,n)=>{t(e)}))}static reject(e){return new ce(((t,n)=>{n(e)}))}static waitFor(e){return new ce(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=ce.resolve(!1);for(const n of e)t=t.next((e=>e?ce.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new ce(((n,r)=>{const i=e.length,s=new Array(i);let a=0;for(let o=0;o<i;o++){const l=o;t(e[l]).next((e=>{s[l]=e,++a,a===i&&n(s)}),(e=>r(e)))}}))}static doWhile(e,t){return new ce(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}function ue(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function de(e){return"IndexedDbTransactionError"===e.name}class he{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function fe(e){return null==e}function pe(e){return 0===e&&1/e==-1/0}function me(e){return"number"==typeof e&&Number.isInteger(e)&&!pe(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}he.oe=-1;const ge=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],ye=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],ve=ye,be=[...ve,"indexConfiguration","indexState","indexEntries"];function we(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function xe(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function _e(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Se{constructor(e,t){this.comparator=e,this.root=t||ke.EMPTY}insert(e,t){return new Se(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ke.BLACK,null,null))}remove(e){return new Se(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ke.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push("".concat(t,":").concat(n)),!1))),"{".concat(e.join(", "),"}")}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ee(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ee(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ee(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ee(this.root,e,this.comparator,!0)}}class Ee{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ke{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:ke.RED,this.left=null!=r?r:ke.EMPTY,this.right=null!=i?i:ke.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new ke(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return ke.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return ke.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ke.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ke.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw A();if(this.right.isRed())throw A();const e=this.left.check();if(e!==this.right.check())throw A();return e+(this.isRed()?0:1)}}ke.EMPTY=null,ke.RED=!0,ke.BLACK=!1,ke.EMPTY=new class{constructor(){this.size=0}get key(){throw A()}get value(){throw A()}get color(){throw A()}get left(){throw A()}get right(){throw A()}copy(e,t,n,r,i){return this}insert(e,t,n){return new ke(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Te{constructor(e){this.comparator=e,this.data=new Se(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Ie(this.data.getIterator())}getIteratorFrom(e){return new Ie(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Te))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Te(this.comparator);return t.data=e,t}}class Ie{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ne{constructor(e){this.fields=e,e.sort(Z.comparator)}static empty(){return new Ne([])}unionWith(e){let t=new Te(Z.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Ne(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return K(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Ce extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Ae{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Ce("Invalid base64 string: "+e):e}}(e);return new Ae(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Ae(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return H(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ae.EMPTY_BYTE_STRING=new Ae("");const je=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function De(e){if(j(!!e),"string"==typeof e){let t=0;const n=je.exec(e);if(j(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Pe(e.seconds),nanos:Pe(e.nanos)}}function Pe(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Oe(e){return"string"==typeof e?Ae.fromBase64String(e):Ae.fromUint8Array(e)}function Re(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Me(e){const t=e.mapValue.fields.__previous_value__;return Re(t)?Me(t):t}function Le(e){const t=De(e.mapValue.fields.__local_write_time__.timestampValue);return new Q(t.seconds,t.nanos)}class Ue{constructor(e,t,n,r,i,s,a,o,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l}}class Fe{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Fe("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Fe&&e.projectId===this.projectId&&e.database===this.database}}const ze={mapValue:{fields:{__type__:{stringValue:"__max__"}}}};function Ve(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Re(e)?4:rt(e)?9007199254740991:tt(e)?10:11:A()}function Be(e,t){if(e===t)return!0;const n=Ve(e);if(n!==Ve(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Le(e).isEqual(Le(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=De(e.timestampValue),r=De(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Oe(e.bytesValue).isEqual(Oe(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Pe(e.geoPointValue.latitude)===Pe(t.geoPointValue.latitude)&&Pe(e.geoPointValue.longitude)===Pe(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Pe(e.integerValue)===Pe(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Pe(e.doubleValue),r=Pe(t.doubleValue);return n===r?pe(n)===pe(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return K(e.arrayValue.values||[],t.arrayValue.values||[],Be);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(we(n)!==we(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Be(n[i],r[i])))return!1;return!0}(e,t);default:return A()}}function Ge(e,t){return void 0!==(e.values||[]).find((e=>Be(e,t)))}function qe(e,t){if(e===t)return 0;const n=Ve(e),r=Ve(t);if(n!==r)return H(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return H(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Pe(e.integerValue||e.doubleValue),r=Pe(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return We(e.timestampValue,t.timestampValue);case 4:return We(Le(e),Le(t));case 5:return H(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Oe(e),r=Oe(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=H(n[i],r[i]);if(0!==e)return e}return H(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=H(Pe(e.latitude),Pe(t.latitude));return 0!==n?n:H(Pe(e.longitude),Pe(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return He(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,s;const a=e.fields||{},o=t.fields||{},l=null===(n=a.value)||void 0===n?void 0:n.arrayValue,c=null===(r=o.value)||void 0===r?void 0:r.arrayValue,u=H((null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0,(null===(s=null==c?void 0:c.values)||void 0===s?void 0:s.length)||0);return 0!==u?u:He(l,c)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===ze.mapValue&&t===ze.mapValue)return 0;if(e===ze.mapValue)return 1;if(t===ze.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let a=0;a<r.length&&a<s.length;++a){const e=H(r[a],s[a]);if(0!==e)return e;const t=qe(n[r[a]],i[s[a]]);if(0!==t)return t}return H(r.length,s.length)}(e.mapValue,t.mapValue);default:throw A()}}function We(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return H(e,t);const n=De(e),r=De(t),i=H(n.seconds,r.seconds);return 0!==i?i:H(n.nanos,r.nanos)}function He(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=qe(n[i],r[i]);if(e)return e}return H(n.length,r.length)}function Ke(e){return Qe(e)}function Qe(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=De(e);return"time(".concat(t.seconds,",").concat(t.nanos,")")}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Oe(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return ee.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return"geo(".concat(e.latitude,",").concat(e.longitude,")")}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Qe(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+="".concat(i,":").concat(Qe(e.fields[i]));return n+"}"}(e.mapValue):A()}function Xe(e,t){return{referenceValue:"projects/".concat(e.projectId,"/databases/").concat(e.database,"/documents/").concat(t.path.canonicalString())}}function Ye(e){return!!e&&"integerValue"in e}function $e(e){return!!e&&"arrayValue"in e}function Je(e){return!!e&&"nullValue"in e}function Ze(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function et(e){return!!e&&"mapValue"in e}function tt(e){var t,n;return"__vector__"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function nt(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return xe(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=nt(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=nt(e.arrayValue.values[n]);return t}return Object.assign({},e)}function rt(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}class it{constructor(e){this.value=e}static empty(){return new it({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!et(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=nt(t)}setAll(e){let t=Z.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=nt(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());et(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Be(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];et(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){xe(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new it(nt(this.value))}}function st(e){const t=[];return xe(e.fields,((e,n)=>{const r=new Z([e]);if(et(n)){const e=st(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new Ne(t)}class at{constructor(e,t,n,r,i,s,a){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=a}static newInvalidDocument(e){return new at(e,0,X.min(),X.min(),X.min(),it.empty(),0)}static newFoundDocument(e,t,n,r){return new at(e,1,t,X.min(),n,r,0)}static newNoDocument(e,t){return new at(e,2,t,X.min(),X.min(),it.empty(),0)}static newUnknownDocument(e,t){return new at(e,3,t,X.min(),X.min(),it.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(X.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=it.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=it.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=X.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof at&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new at(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return"Document(".concat(this.key,", ").concat(this.version,", ").concat(JSON.stringify(this.data.value),", {createTime: ").concat(this.createTime,"}), {documentType: ").concat(this.documentType,"}), {documentState: ").concat(this.documentState,"})")}}class ot{constructor(e,t){this.position=e,this.inclusive=t}}function lt(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],a=e.position[i];if(r=s.field.isKeyField()?ee.comparator(ee.fromName(a.referenceValue),n.key):qe(a,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function ct(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Be(e.position[n],t.position[n]))return!1;return!0}class ut{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function dt(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class ht{}class ft extends ht{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new xt(e,t,n):"array-contains"===t?new kt(e,n):"in"===t?new Tt(e,n):"not-in"===t?new It(e,n):"array-contains-any"===t?new Nt(e,n):new ft(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new _t(e,n):new St(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(qe(t,this.value)):null!==t&&Ve(this.value)===Ve(t)&&this.matchesComparison(qe(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return A()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class pt extends ht{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new pt(e,t)}matches(e){return mt(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function mt(e){return"and"===e.op}function gt(e){return yt(e)&&mt(e)}function yt(e){for(const t of e.filters)if(t instanceof pt)return!1;return!0}function vt(e){if(e instanceof ft)return e.field.canonicalString()+e.op.toString()+Ke(e.value);if(gt(e))return e.filters.map((e=>vt(e))).join(",");{const t=e.filters.map((e=>vt(e))).join(",");return"".concat(e.op,"(").concat(t,")")}}function bt(e,t){return e instanceof ft?function(e,t){return t instanceof ft&&e.op===t.op&&e.field.isEqual(t.field)&&Be(e.value,t.value)}(e,t):e instanceof pt?function(e,t){return t instanceof pt&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&bt(n,t.filters[r])),!0)}(e,t):void A()}function wt(e){return e instanceof ft?function(e){return"".concat(e.field.canonicalString()," ").concat(e.op," ").concat(Ke(e.value))}(e):e instanceof pt?function(e){return e.op.toString()+" {"+e.getFilters().map(wt).join(" ,")+"}"}(e):"Filter"}class xt extends ft{constructor(e,t,n){super(e,t,n),this.key=ee.fromName(n.referenceValue)}matches(e){const t=ee.comparator(e.key,this.key);return this.matchesComparison(t)}}class _t extends ft{constructor(e,t){super(e,"in",t),this.keys=Et("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class St extends ft{constructor(e,t){super(e,"not-in",t),this.keys=Et("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Et(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>ee.fromName(e.referenceValue)))}class kt extends ft{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return $e(t)&&Ge(t.arrayValue,this.value)}}class Tt extends ft{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Ge(this.value.arrayValue,t)}}class It extends ft{constructor(e,t){super(e,"not-in",t)}matches(e){if(Ge(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Ge(this.value.arrayValue,t)}}class Nt extends ft{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!$e(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>Ge(this.value.arrayValue,e)))}}class Ct{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=a,this.ue=null}}function At(e){return new Ct(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function jt(e){const t=D(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>vt(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),fe(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Ke(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Ke(e))).join(",")),t.ue=e}return t.ue}function Dt(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!dt(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!bt(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!ct(e.startAt,t.startAt)&&ct(e.endAt,t.endAt)}function Pt(e){return ee.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Ot{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=a,this.endAt=o,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function Rt(e,t,n,r,i,s,a,o){return new Ot(e,t,n,r,i,s,a,o)}function Mt(e){return new Ot(e)}function Lt(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Ut(e){return null!==e.collectionGroup}function Ft(e){const t=D(e);if(null===t.ce){t.ce=[];const e=new Set;for(const i of t.explicitOrderBy)t.ce.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Te(Z.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.ce.push(new ut(r,n))})),e.has(Z.keyField().canonicalString())||t.ce.push(new ut(Z.keyField(),n))}return t.ce}function zt(e){const t=D(e);return t.le||(t.le=Vt(t,Ft(e))),t.le}function Vt(e,t){if("F"===e.limitType)return At(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new ut(e.field,t)}));const n=e.endAt?new ot(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new ot(e.startAt.position,e.startAt.inclusive):null;return At(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function Bt(e,t){const n=e.filters.concat([t]);return new Ot(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Gt(e,t,n){return new Ot(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function qt(e,t){return Dt(zt(e),zt(t))&&e.limitType===t.limitType}function Wt(e){return"".concat(jt(zt(e)),"|lt:").concat(e.limitType)}function Ht(e){return"Query(target=".concat(function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: [".concat(e.filters.map((e=>wt(e))).join(", "),"]")),fe(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: [".concat(e.orderBy.map((e=>function(e){return"".concat(e.field.canonicalString()," (").concat(e.dir,")")}(e))).join(", "),"]")),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Ke(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Ke(e))).join(",")),"Target(".concat(t,")")}(zt(e)),"; limitType=").concat(e.limitType,")")}function Kt(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):ee.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of Ft(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=lt(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,Ft(e),t))&&!(e.endAt&&!function(e,t,n){const r=lt(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,Ft(e),t))}(e,t)}function Qt(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Xt(e){return(t,n)=>{let r=!1;for(const i of Ft(e)){const e=Yt(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Yt(e,t,n){const r=e.field.isKeyField()?ee.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?qe(r,i):A()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return A()}}class $t{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){xe(this.inner,((t,n)=>{for(const[r,i]of n)e(r,i)}))}isEmpty(){return _e(this.inner)}size(){return this.innerSize}}const Jt=new Se(ee.comparator);function Zt(){return Jt}const en=new Se(ee.comparator);function tn(){let e=en;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function nn(e){let t=en;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function rn(){return an()}function sn(){return an()}function an(){return new $t((e=>e.toString()),((e,t)=>e.isEqual(t)))}const on=new Se(ee.comparator),ln=new Te(ee.comparator);function cn(){let e=ln;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const un=new Te(H);function dn(){return un}function hn(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:pe(t)?"-0":t}}function fn(e){return{integerValue:""+e}}function pn(e,t){return me(t)?fn(t):hn(e,t)}class mn{constructor(){this._=void 0}}function gn(e,t,n){return e instanceof bn?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Re(t)&&(t=Me(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof wn?xn(e,t):e instanceof _n?Sn(e,t):function(e,t){const n=vn(e,t),r=kn(n)+kn(e.Pe);return Ye(n)&&Ye(e.Pe)?fn(r):hn(e.serializer,r)}(e,t)}function yn(e,t,n){return e instanceof wn?xn(e,t):e instanceof _n?Sn(e,t):n}function vn(e,t){return e instanceof En?function(e){return Ye(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class bn extends mn{}class wn extends mn{constructor(e){super(),this.elements=e}}function xn(e,t){const n=Tn(t);for(const r of e.elements)n.some((e=>Be(e,r)))||n.push(r);return{arrayValue:{values:n}}}class _n extends mn{constructor(e){super(),this.elements=e}}function Sn(e,t){let n=Tn(t);for(const r of e.elements)n=n.filter((e=>!Be(e,r)));return{arrayValue:{values:n}}}class En extends mn{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function kn(e){return Pe(e.integerValue||e.doubleValue)}function Tn(e){return $e(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class In{constructor(e,t){this.field=e,this.transform=t}}class Nn{constructor(e,t){this.version=e,this.transformResults=t}}class Cn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Cn}static exists(e){return new Cn(void 0,e)}static updateTime(e){return new Cn(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function An(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class jn{}function Dn(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Bn(e.key,Cn.none()):new Ln(e.key,e.data,Cn.none());{const n=e.data,r=it.empty();let i=new Te(Z.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Un(e.key,r,new Ne(i.toArray()),Cn.none())}}function Pn(e,t,n){e instanceof Ln?function(e,t,n){const r=e.value.clone(),i=zn(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Un?function(e,t,n){if(!An(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=zn(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Fn(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function On(e,t,n,r){return e instanceof Ln?function(e,t,n,r){if(!An(e.precondition,t))return n;const i=e.value.clone(),s=Vn(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Un?function(e,t,n,r){if(!An(e.precondition,t))return n;const i=Vn(e.fieldTransforms,r,t),s=t.data;return s.setAll(Fn(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return An(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Rn(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=vn(r.transform,e||null);null!=i&&(null===n&&(n=it.empty()),n.set(r.field,i))}return n||null}function Mn(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&K(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof wn&&t instanceof wn||e instanceof _n&&t instanceof _n?K(e.elements,t.elements,Be):e instanceof En&&t instanceof En?Be(e.Pe,t.Pe):e instanceof bn&&t instanceof bn}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Ln extends jn{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Un extends jn{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Fn(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function zn(e,t,n){const r=new Map;j(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],a=s.transform,o=t.data.field(s.field);r.set(s.field,yn(a,o,n[i]))}return r}function Vn(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,gn(e,s,t))}return r}class Bn extends jn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Gn extends jn{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class qn{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Pn(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=On(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=On(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=sn();return this.mutations.forEach((r=>{const i=e.get(r.key),s=i.overlayedDocument;let a=this.applyToLocalView(s,i.mutatedFields);a=t.has(r.key)?null:a;const o=Dn(s,a);null!==o&&n.set(r.key,o),s.isValidDocument()||s.convertToNoDocument(X.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),cn())}isEqual(e){return this.batchId===e.batchId&&K(this.mutations,e.mutations,((e,t)=>Mn(e,t)))&&K(this.baseMutations,e.baseMutations,((e,t)=>Mn(e,t)))}}class Wn{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){j(e.mutations.length===n.length);let r=on;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new Wn(e,t,n,r)}}class Hn{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return"Overlay{\n      largestBatchId: ".concat(this.largestBatchId,",\n      mutation: ").concat(this.mutation.toString(),"\n    }")}}class Kn{constructor(e,t){this.count=e,this.unchangedNames=t}}var Qn,Xn;function Yn(e){switch(e){default:return A();case P.CANCELLED:case P.UNKNOWN:case P.DEADLINE_EXCEEDED:case P.RESOURCE_EXHAUSTED:case P.INTERNAL:case P.UNAVAILABLE:case P.UNAUTHENTICATED:return!1;case P.INVALID_ARGUMENT:case P.NOT_FOUND:case P.ALREADY_EXISTS:case P.PERMISSION_DENIED:case P.FAILED_PRECONDITION:case P.ABORTED:case P.OUT_OF_RANGE:case P.UNIMPLEMENTED:case P.DATA_LOSS:return!0}}function $n(e){if(void 0===e)return I("GRPC error has no .code"),P.UNKNOWN;switch(e){case Qn.OK:return P.OK;case Qn.CANCELLED:return P.CANCELLED;case Qn.UNKNOWN:return P.UNKNOWN;case Qn.DEADLINE_EXCEEDED:return P.DEADLINE_EXCEEDED;case Qn.RESOURCE_EXHAUSTED:return P.RESOURCE_EXHAUSTED;case Qn.INTERNAL:return P.INTERNAL;case Qn.UNAVAILABLE:return P.UNAVAILABLE;case Qn.UNAUTHENTICATED:return P.UNAUTHENTICATED;case Qn.INVALID_ARGUMENT:return P.INVALID_ARGUMENT;case Qn.NOT_FOUND:return P.NOT_FOUND;case Qn.ALREADY_EXISTS:return P.ALREADY_EXISTS;case Qn.PERMISSION_DENIED:return P.PERMISSION_DENIED;case Qn.FAILED_PRECONDITION:return P.FAILED_PRECONDITION;case Qn.ABORTED:return P.ABORTED;case Qn.OUT_OF_RANGE:return P.OUT_OF_RANGE;case Qn.UNIMPLEMENTED:return P.UNIMPLEMENTED;case Qn.DATA_LOSS:return P.DATA_LOSS;default:return A()}}(Xn=Qn||(Qn={}))[Xn.OK=0]="OK",Xn[Xn.CANCELLED=1]="CANCELLED",Xn[Xn.UNKNOWN=2]="UNKNOWN",Xn[Xn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Xn[Xn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Xn[Xn.NOT_FOUND=5]="NOT_FOUND",Xn[Xn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Xn[Xn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Xn[Xn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Xn[Xn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Xn[Xn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Xn[Xn.ABORTED=10]="ABORTED",Xn[Xn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Xn[Xn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Xn[Xn.INTERNAL=13]="INTERNAL",Xn[Xn.UNAVAILABLE=14]="UNAVAILABLE",Xn[Xn.DATA_LOSS=15]="DATA_LOSS";let Jn=null;function Zn(){return new TextEncoder}const er=new r([4294967295,4294967295],0);function tr(e){const t=Zn().encode(e),n=new i;return n.update(t),new Uint8Array(n.digest())}function nr(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),s=t.getUint32(8,!0),a=t.getUint32(12,!0);return[new r([n,i],0),new r([s,a],0)]}class rr{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new ir("Invalid padding: ".concat(t));if(n<0)throw new ir("Invalid hash count: ".concat(n));if(e.length>0&&0===this.hashCount)throw new ir("Invalid hash count: ".concat(n));if(0===e.length&&0!==t)throw new ir("Invalid padding when bitmap length is 0: ".concat(t));this.Ie=8*e.length-t,this.Te=r.fromNumber(this.Ie)}Ee(e,t,n){let i=e.add(t.multiply(r.fromNumber(n)));return 1===i.compare(er)&&(i=new r([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=tr(e),[n,r]=nr(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);if(!this.de(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new rr(i,r,t);return n.forEach((e=>s.insert(e))),s}insert(e){if(0===this.Ie)return;const t=tr(e),[n,r]=nr(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class ir extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class sr{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,ar.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new sr(X.min(),r,new Se(H),Zt(),cn())}}class ar{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new ar(n,t,cn(),cn(),cn())}}class or{constructor(e,t,n,r){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=r}}class lr{constructor(e,t){this.targetId=e,this.me=t}}class cr{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ae.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class ur{constructor(){this.fe=0,this.ge=fr(),this.pe=Ae.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=cn(),t=cn(),n=cn();return this.ge.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:A()}})),new ar(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=fr()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,j(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class dr{constructor(e){this.Le=e,this.Be=new Map,this.ke=Zt(),this.qe=hr(),this.Qe=new Se(H)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,(t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:A()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((e,n)=>{this.ze(n)&&t(n)}))}He(e){const t=e.targetId,n=e.me.count,r=this.Je(t);if(r){const i=r.target;if(Pt(i))if(0===n){const e=new ee(i.path);this.Ue(t,e,at.newNoDocument(e,X.min()))}else j(1===n);else{const r=this.Ye(t);if(r!==n){const n=this.Ze(e),i=n?this.Xe(n,e,r):1;if(0!==i){this.je(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}null==Jn||Jn.et(function(e,t,n,r,i){var s,a,o,l,c,u;const d={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},h=t.unchangedNames;return h&&(d.bloomFilter={applied:0===i,hashCount:null!==(s=null==h?void 0:h.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(l=null===(o=null===(a=null==h?void 0:h.bits)||void 0===a?void 0:a.bitmap)||void 0===o?void 0:o.length)&&void 0!==l?l:0,padding:null!==(u=null===(c=null==h?void 0:h.bits)||void 0===c?void 0:c.padding)&&void 0!==u?u:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),d}(r,e.me,this.Le.tt(),n,i))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,a;try{s=Oe(n).toUint8Array()}catch(e){if(e instanceof Ce)return N("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{a=new rr(s,r,i)}catch(e){return N(e instanceof ir?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===a.Ie?null:a}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const i=this.Le.tt(),s="projects/".concat(i.projectId,"/databases/").concat(i.database,"/documents/").concat(n.path.canonicalString());e.mightContain(s)||(this.Ue(t,n,null),r++)})),r}rt(e){const t=new Map;this.Be.forEach(((n,r)=>{const i=this.Je(r);if(i){if(n.current&&Pt(i.target)){const t=new ee(i.target.path);null!==this.ke.get(t)||this.it(r,t)||this.Ue(r,t,at.newNoDocument(t,e))}n.be&&(t.set(r,n.ve()),n.Ce())}}));let n=cn();this.qe.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.ke.forEach(((t,n)=>n.setReadTime(e)));const r=new sr(e,t,this.Qe,this.ke,n);return this.ke=Zt(),this.qe=hr(),this.Qe=new Se(H),r}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new ur,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Te(H),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||T("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new ur),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.Ue(e,t,null)}))}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function hr(){return new Se(ee.comparator)}function fr(){return new Se(ee.comparator)}const pr={asc:"ASCENDING",desc:"DESCENDING"},mr={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},gr={and:"AND",or:"OR"};class yr{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function vr(e,t){return e.useProto3Json||fe(t)?t:{value:t}}function br(e,t){return e.useProto3Json?"".concat(new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),".").concat(("000000000"+t.nanoseconds).slice(-9),"Z"):{seconds:""+t.seconds,nanos:t.nanoseconds}}function wr(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function xr(e,t){return br(e,t.toTimestamp())}function _r(e){return j(!!e),X.fromTimestamp(function(e){const t=De(e);return new Q(t.seconds,t.nanos)}(e))}function Sr(e,t){return Er(e,t).canonicalString()}function Er(e,t){const n=function(e){return new $(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function kr(e){const t=$.fromString(e);return j(Wr(t)),t}function Tr(e,t){return Sr(e.databaseId,t.path)}function Ir(e,t){const n=kr(t);if(n.get(1)!==e.databaseId.projectId)throw new O(P.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new O(P.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new ee(jr(n))}function Nr(e,t){return Sr(e.databaseId,t)}function Cr(e){const t=kr(e);return 4===t.length?$.emptyPath():jr(t)}function Ar(e){return new $(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function jr(e){return j(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Dr(e,t,n){return{name:Tr(e,t),fields:n.value.mapValue.fields}}function Pr(e,t){let n;if(t instanceof Ln)n={update:Dr(e,t.key,t.value)};else if(t instanceof Bn)n={delete:Tr(e,t.key)};else if(t instanceof Un)n={update:Dr(e,t.key,t.data),updateMask:qr(t.fieldMask)};else{if(!(t instanceof Gn))return A();n={verify:Tr(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof bn)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof wn)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof _n)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof En)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw A()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:xr(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:A()}(e,t.precondition)),n}function Or(e,t){return{documents:[Nr(e,t.path)]}}function Rr(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Nr(e,i);const s=function(e){if(0!==e.length)return Gr(pt.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const a=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Vr(e.field),direction:Ur(e.dir)}}(e)))}(t.orderBy);a&&(n.structuredQuery.orderBy=a);const o=vr(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:i}}function Mr(e){let t=Cr(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){j(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Lr(e);return t instanceof pt&&gt(t)?t.getFilters():[t]}(n.where));let a=[];n.orderBy&&(a=function(e){return e.map((e=>function(e){return new ut(Br(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let o=null;n.limit&&(o=function(e){let t;return t="object"==typeof e?e.value:e,fe(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new ot(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new ot(n,t)}(n.endAt)),Rt(t,i,a,s,o,"F",l,c)}function Lr(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Br(e.unaryFilter.field);return ft.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Br(e.unaryFilter.field);return ft.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Br(e.unaryFilter.field);return ft.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Br(e.unaryFilter.field);return ft.create(i,"!=",{nullValue:"NULL_VALUE"});default:return A()}}(e):void 0!==e.fieldFilter?function(e){return ft.create(Br(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return A()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return pt.create(e.compositeFilter.filters.map((e=>Lr(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return A()}}(e.compositeFilter.op))}(e):A()}function Ur(e){return pr[e]}function Fr(e){return mr[e]}function zr(e){return gr[e]}function Vr(e){return{fieldPath:e.canonicalString()}}function Br(e){return Z.fromServerFormat(e.fieldPath)}function Gr(e){return e instanceof ft?function(e){if("=="===e.op){if(Ze(e.value))return{unaryFilter:{field:Vr(e.field),op:"IS_NAN"}};if(Je(e.value))return{unaryFilter:{field:Vr(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Ze(e.value))return{unaryFilter:{field:Vr(e.field),op:"IS_NOT_NAN"}};if(Je(e.value))return{unaryFilter:{field:Vr(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Vr(e.field),op:Fr(e.op),value:e.value}}}(e):e instanceof pt?function(e){const t=e.getFilters().map((e=>Gr(e)));return 1===t.length?t[0]:{compositeFilter:{op:zr(e.op),filters:t}}}(e):A()}function qr(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Wr(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Hr{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:X.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:X.min(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Ae.EMPTY_BYTE_STRING,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=a,this.expectedCount=o}withSequenceNumber(e){return new Hr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Hr(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Hr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Hr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Kr{constructor(e){this.ct=e}}function Qr(e){const t=Mr({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Gt(t,t.limit,"L"):t}class Xr{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Pe(e.integerValue));else if("doubleValue"in e){const n=Pe(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),pe(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),"string"==typeof n&&(n=De(n)),t.Rt("".concat(n.seconds||"")),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Oe(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?rt(e)?this.dt(t,Number.MAX_SAFE_INTEGER):tt(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):A()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const n=e.fields||{};this.dt(t,55);for(const r of Object.keys(n))this.Vt(r,t),this.Tt(n[r],t)}wt(e,t){var n,r;const i=e.fields||{};this.dt(t,53);const s="value",a=(null===(r=null===(n=i[s].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.dt(t,15),t.At(Pe(a)),this.Vt(s,t),this.Tt(i[s],t)}bt(e,t){const n=e.values||[];this.dt(t,50);for(const r of n)this.Tt(r,t)}yt(e,t){this.dt(t,37),ee.fromName(e).path.forEach((e=>{this.dt(t,60),this.Dt(e,t)}))}dt(e,t){e.At(t)}ft(e){e.At(2)}}Xr.vt=new Xr;class Yr{constructor(){this.un=new $r}addToCollectionParentIndex(e,t){return this.un.add(t),ce.resolve()}getCollectionParents(e,t){return ce.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return ce.resolve()}deleteFieldIndex(e,t){return ce.resolve()}deleteAllFieldIndexes(e){return ce.resolve()}createTargetIndexes(e,t){return ce.resolve()}getDocumentsMatchingTarget(e,t){return ce.resolve(null)}getIndexType(e,t){return ce.resolve(0)}getFieldIndexes(e,t){return ce.resolve([])}getNextCollectionGroupToUpdate(e){return ce.resolve(null)}getMinOffset(e,t){return ce.resolve(ie.min())}getMinOffsetFromCollectionGroup(e,t){return ce.resolve(ie.min())}updateCollectionGroup(e,t,n){return ce.resolve()}updateIndexEntries(e,t){return ce.resolve()}}class $r{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Te($.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Te($.comparator)).toArray()}}new Uint8Array(0);class Jr{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new Jr(e,Jr.DEFAULT_COLLECTION_PERCENTILE,Jr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Jr.DEFAULT_COLLECTION_PERCENTILE=10,Jr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Jr.DEFAULT=new Jr(41943040,Jr.DEFAULT_COLLECTION_PERCENTILE,Jr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Jr.DISABLED=new Jr(-1,0,0);class Zr{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Zr(0)}static kn(){return new Zr(-1)}}class ei{constructor(){this.changes=new $t((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,at.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?ce.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class ti{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class ni{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&On(n.mutation,e,Ne.empty(),Q.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,cn()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:cn();const r=rn();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=tn();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=rn();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,cn())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=Zt();const s=an(),a=an();return t.forEach(((e,t)=>{const a=n.get(t.key);r.has(t.key)&&(void 0===a||a.mutation instanceof Un)?i=i.insert(t.key,t):void 0!==a?(s.set(t.key,a.mutation.getFieldMask()),On(a.mutation,t,a.mutation.getFieldMask(),Q.now())):s.set(t.key,Ne.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return a.set(e,new ti(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),a)))}recalculateAndSaveOverlays(e,t){const n=an();let r=new Se(((e,t)=>e-t)),i=cn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let a=n.get(e)||Ne.empty();a=i.applyToLocalView(s,a),n.set(e,a);const o=(r.get(i.batchId)||cn()).add(e);r=r.insert(i.batchId,o)}))})).next((()=>{const s=[],a=r.getReverseIterator();for(;a.hasNext();){const r=a.getNext(),o=r.key,l=r.value,c=sn();l.forEach((e=>{if(!i.has(e)){const r=Dn(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,o,c))}return ce.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return ee.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Ut(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):ce.resolve(rn());let a=-1,o=i;return s.next((t=>ce.forEach(t,((t,n)=>(a<n.largestBatchId&&(a=n.largestBatchId),i.get(t)?ce.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{o=o.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,o,t,cn()))).next((e=>({batchId:a,changes:nn(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ee(t)).next((e=>{let t=tn();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=tn();return this.indexManager.getCollectionParents(e,i).next((a=>ce.forEach(a,(a=>{const o=function(e,t){return new Ot(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,a.child(i));return this.getDocumentsMatchingCollectionQuery(e,o,n,r).next((e=>{e.forEach(((e,t)=>{s=s.insert(e,t)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,at.newInvalidDocument(r)))}));let n=tn();return e.forEach(((e,r)=>{const s=i.get(e);void 0!==s&&On(s.mutation,r,Ne.empty(),Q.now()),Kt(t,r)&&(n=n.insert(e,r))})),n}))}}class ri{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return ce.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:_r(e.createTime)}}(t)),ce.resolve()}getNamedQuery(e,t){return ce.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(e){return{name:e.name,query:Qr(e.bundledQuery),readTime:_r(e.readTime)}}(t)),ce.resolve()}}class ii{constructor(){this.overlays=new Se(ee.comparator),this.Ir=new Map}getOverlay(e,t){return ce.resolve(this.overlays.get(t))}getOverlays(e,t){const n=rn();return ce.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.ht(e,t,r)})),ce.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Ir.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.Ir.delete(n)),ce.resolve()}getOverlaysForCollection(e,t,n){const r=rn(),i=t.length+1,s=new ee(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){const e=a.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return ce.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Se(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=rn(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const a=rn(),o=i.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach(((e,t)=>a.set(e,t))),!(a.size()>=r)););return ce.resolve(a)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Ir.get(r.largestBatchId).delete(n.key);this.Ir.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Hn(t,n));let i=this.Ir.get(t);void 0===i&&(i=cn(),this.Ir.set(t,i)),this.Ir.set(t,i.add(n.key))}}class si{constructor(){this.sessionToken=Ae.EMPTY_BYTE_STRING}getSessionToken(e){return ce.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ce.resolve()}}class ai{constructor(){this.Tr=new Te(oi.Er),this.dr=new Te(oi.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new oi(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Vr(new oi(e,t))}mr(e,t){e.forEach((e=>this.removeReference(e,t)))}gr(e){const t=new ee(new $([])),n=new oi(t,e),r=new oi(t,e+1),i=[];return this.dr.forEachInRange([n,r],(e=>{this.Vr(e),i.push(e.key)})),i}pr(){this.Tr.forEach((e=>this.Vr(e)))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new ee(new $([])),n=new oi(t,e),r=new oi(t,e+1);let i=cn();return this.dr.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new oi(e,0),n=this.Tr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class oi{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return ee.comparator(e.key,t.key)||H(e.wr,t.wr)}static Ar(e,t){return H(e.wr,t.wr)||ee.comparator(e.key,t.key)}}class li{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Te(oi.Er)}checkEmpty(e){return ce.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new qn(i,t,n,r);this.mutationQueue.push(s);for(const a of r)this.br=this.br.add(new oi(a.key,i)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return ce.resolve(s)}lookupMutationBatch(e,t){return ce.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.vr(n),i=r<0?0:r;return ce.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ce.resolve(0===this.mutationQueue.length?-1:this.Sr-1)}getAllMutationBatches(e){return ce.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new oi(t,0),r=new oi(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,r],(e=>{const t=this.Dr(e.wr);i.push(t)})),ce.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Te(H);return t.forEach((e=>{const t=new oi(e,0),r=new oi(e,Number.POSITIVE_INFINITY);this.br.forEachInRange([t,r],(e=>{n=n.add(e.wr)}))})),ce.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;ee.isDocumentKey(i)||(i=i.child(""));const s=new oi(new ee(i),0);let a=new Te(H);return this.br.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.wr)),!0)}),s),ce.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach((e=>{const n=this.Dr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){j(0===this.Fr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.br;return ce.forEach(t.mutations,(r=>{const i=new oi(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.br=n}))}On(e){}containsKey(e,t){const n=new oi(t,0),r=this.br.firstAfterOrEqual(n);return ce.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ce.resolve()}Fr(e,t){return this.vr(e)}vr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class ci{constructor(e){this.Mr=e,this.docs=new Se(ee.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ce.resolve(n?n.document.mutableCopy():at.newInvalidDocument(t))}getEntries(e,t){let n=Zt();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():at.newInvalidDocument(e))})),ce.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Zt();const s=t.path,a=new ee(s.child("")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){const{key:e,value:{document:a}}=o.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||se(re(a),n)<=0||(r.has(a.key)||Kt(t,a))&&(i=i.insert(a.key,a.mutableCopy()))}return ce.resolve(i)}getAllFromCollectionGroup(e,t,n,r){A()}Or(e,t){return ce.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new ui(this)}getSize(e){return ce.resolve(this.size)}}class ui extends ei{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(n)})),ce.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}class di{constructor(e){this.persistence=e,this.Nr=new $t((e=>jt(e)),Dt),this.lastRemoteSnapshotVersion=X.min(),this.highestTargetId=0,this.Lr=0,this.Br=new ai,this.targetCount=0,this.kr=Zr.Bn()}forEachTarget(e,t){return this.Nr.forEach(((e,n)=>t(n))),ce.resolve()}getLastRemoteSnapshotVersion(e){return ce.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ce.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),ce.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),ce.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Zr(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,ce.resolve()}updateTargetData(e,t){return this.Kn(t),ce.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,ce.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Nr.forEach(((s,a)=>{a.sequenceNumber<=t&&null===n.get(a.targetId)&&(this.Nr.delete(s),i.push(this.removeMatchingKeysForTargetId(e,a.targetId)),r++)})),ce.waitFor(i).next((()=>r))}getTargetCount(e){return ce.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return ce.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),ce.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),ce.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),ce.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return ce.resolve(n)}containsKey(e,t){return ce.resolve(this.Br.containsKey(t))}}class hi{constructor(e,t){this.qr={},this.overlays={},this.Qr=new he(0),this.Kr=!1,this.Kr=!0,this.$r=new si,this.referenceDelegate=e(this),this.Ur=new di(this),this.indexManager=new Yr,this.remoteDocumentCache=function(e){return new ci(e)}((e=>this.referenceDelegate.Wr(e))),this.serializer=new Kr(t),this.Gr=new ri(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new ii,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new li(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){T("MemoryPersistence","Starting transaction:",e);const r=new fi(this.Qr.next());return this.referenceDelegate.zr(),n(r).next((e=>this.referenceDelegate.jr(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Hr(e,t){return ce.or(Object.values(this.qr).map((n=>()=>n.containsKey(e,t))))}}class fi extends oe{constructor(e){super(),this.currentSequenceNumber=e}}class pi{constructor(e){this.persistence=e,this.Jr=new ai,this.Yr=null}static Zr(e){return new pi(e)}get Xr(){if(this.Yr)return this.Yr;throw A()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),ce.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),ce.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),ce.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach((e=>this.Xr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Xr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ce.forEach(this.Xr,(n=>{const r=ee.fromPath(n);return this.ei(e,r).next((e=>{e||t.removeEntry(r,X.min())}))})).next((()=>(this.Yr=null,t.apply(e))))}updateLimboDocument(e,t){return this.ei(e,t).next((e=>{e?this.Xr.delete(t.toString()):this.Xr.add(t.toString())}))}Wr(e){return 0}ei(e,t){return ce.or([()=>ce.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class mi{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=r}static Wi(e,t){let n=cn(),r=cn();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new mi(e,t.fromCache,n,r)}}class gi{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class yi{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=(0,l.nr)()?8:ue((0,l.ZQ)())>0?6:4}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.Yi(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.Zi(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const n=new gi;return this.Xi(e,t,n).next((r=>{if(i.result=r,this.zi)return this.es(e,t,n,r.size)}))})).next((()=>i.result))}es(e,t,n,r){return n.documentReadCount<this.ji?(k()<=o.$b.DEBUG&&T("QueryEngine","SDK will not create cache indexes for query:",Ht(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),ce.resolve()):(k()<=o.$b.DEBUG&&T("QueryEngine","Query:",Ht(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Hi*r?(k()<=o.$b.DEBUG&&T("QueryEngine","The SDK decides to create cache indexes for query:",Ht(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,zt(t))):ce.resolve())}Yi(e,t){if(Lt(t))return ce.resolve(null);let n=zt(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=Gt(t,null,"F"),n=zt(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=cn(...r);return this.Ji.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.ts(t,r);return this.ns(t,s,i,n.readTime)?this.Yi(e,Gt(t,null,"F")):this.rs(e,s,t,n)}))))})))))}Zi(e,t,n,r){return Lt(t)||r.isEqual(X.min())?ce.resolve(null):this.Ji.getDocuments(e,n).next((i=>{const s=this.ts(t,i);return this.ns(t,s,n,r)?ce.resolve(null):(k()<=o.$b.DEBUG&&T("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Ht(t)),this.rs(e,s,t,ne(r,-1)).next((e=>e)))}))}ts(e,t){let n=new Te(Xt(e));return t.forEach(((t,r)=>{Kt(e,r)&&(n=n.add(r))})),n}ns(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Xi(e,t,n){return k()<=o.$b.DEBUG&&T("QueryEngine","Using full collection scan to execute query:",Ht(t)),this.Ji.getDocumentsMatchingQuery(e,t,ie.min(),n)}rs(e,t,n,r){return this.Ji.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class vi{constructor(e,t,n,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new Se(H),this._s=new $t((e=>jt(e)),Dt),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ni(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.os)))}}function bi(e,t,n,r){return new vi(e,t,n,r)}async function wi(e,t){const n=D(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.ls(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],s=[];let a=cn();for(const e of r){i.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)a=a.add(t.key)}return n.localDocuments.getDocuments(e,a).next((e=>({hs:e,removedBatchIds:i,addedBatchIds:s})))}))}))}function xi(e){const t=D(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Ur.getLastRemoteSnapshotVersion(e)))}function _i(e,t,n){let r=cn(),i=cn();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=Zt();return n.forEach(((n,s)=>{const a=e.get(n);s.isFoundDocument()!==a.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(X.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!a.isValidDocument()||s.version.compareTo(a.version)>0||0===s.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):T("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",s.version)})),{Ps:r,Is:i}}))}function Si(e,t){const n=D(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function Ei(e,t){const n=D(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Ur.getTargetData(e,t).next((i=>i?(r=i,ce.resolve(r)):n.Ur.allocateTargetId(e).next((i=>(r=new Hr(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Ur.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.os.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.os=n.os.insert(e.targetId,e),n._s.set(t,e.targetId)),e}))}async function ki(e,t,n){const r=D(e),i=r.os.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!de(e))throw e;T("LocalStore","Failed to update sequence numbers for target ".concat(t,": ").concat(e))}r.os=r.os.remove(t),r._s.delete(i.target)}function Ti(e,t,n){const r=D(e);let i=X.min(),s=cn();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=D(e),i=r._s.get(n);return void 0!==i?ce.resolve(r.os.get(i)):r.Ur.getTargetData(t,n)}(r,e,zt(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.ss.getDocumentsMatchingQuery(e,t,n?i:X.min(),n?s:cn()))).next((e=>(Ii(r,Qt(t),e),{documents:e,Ts:s})))))}function Ii(e,t,n){let r=e.us.get(t)||X.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.us.set(t,r)}class Ni{constructor(){this.activeTargetIds=dn()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Ci{constructor(){this.so=new Ni,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Ni,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class Ai{_o(e){}shutdown(){}}class ji{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){T("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){T("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Di=null;function Pi(){return null===Di?Di=268435456+Math.round(2147483648*Math.random()):Di++,"0x"+Di.toString(16)}const Oi={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Ri{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}const Mi="WebChannelConnection";class Li extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Do=t+"://"+e.host,this.vo="projects/".concat(n,"/databases/").concat(r),this.Co="(default)"===this.databaseId.database?"project_id=".concat(n):"project_id=".concat(n,"&database_id=").concat(r)}get Fo(){return!1}Mo(e,t,n,r,i){const s=Pi(),a=this.xo(e,t.toUriEncodedString());T("RestConnection","Sending RPC '".concat(e,"' ").concat(s,":"),a,n);const o={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(o,r,i),this.No(e,a,o,n).then((t=>(T("RestConnection","Received RPC '".concat(e,"' ").concat(s,": "),t),t)),(t=>{throw N("RestConnection","RPC '".concat(e,"' ").concat(s," failed with error: "),t,"url: ",a,"request:",n),t}))}Lo(e,t,n,r,i,s){return this.Mo(e,t,n,r,i)}Oo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+S,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}xo(e,t){const n=Oi[e];return"".concat(this.Do,"/v1/").concat(t,":").concat(n)}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,r){const i=Pi();return new Promise(((s,a)=>{const o=new d;o.setWithCredentials(!0),o.listenOnce(f.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case p.NO_ERROR:const t=o.getResponseJson();T(Mi,"XHR for RPC '".concat(e,"' ").concat(i," received:"),JSON.stringify(t)),s(t);break;case p.TIMEOUT:T(Mi,"RPC '".concat(e,"' ").concat(i," timed out")),a(new O(P.DEADLINE_EXCEEDED,"Request time out"));break;case p.HTTP_ERROR:const n=o.getStatus();if(T(Mi,"RPC '".concat(e,"' ").concat(i," failed with status:"),n,"response text:",o.getResponseText()),n>0){let e=o.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(P).indexOf(t)>=0?t:P.UNKNOWN}(t.status);a(new O(e,t.message))}else a(new O(P.UNKNOWN,"Server responded with status "+o.getStatus()))}else a(new O(P.UNAVAILABLE,"Connection failed."));break;default:A()}}finally{T(Mi,"RPC '".concat(e,"' ").concat(i," completed."))}}));const l=JSON.stringify(r);T(Mi,"RPC '".concat(e,"' ").concat(i," sending request:"),r),o.send(t,"POST",l,n,15)}))}Bo(e,t,n){const r=Pi(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=v(),a=y(),o={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/".concat(this.databaseId.projectId,"/databases/").concat(this.databaseId.database)},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(o.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(o.useFetchStreams=!0),this.Oo(o.initMessageHeaders,t,n),o.encodeInitMessageHeaders=!0;const c=i.join("");T(Mi,"Creating RPC '".concat(e,"' stream ").concat(r,": ").concat(c),o);const u=s.createWebChannel(c,o);let d=!1,f=!1;const p=new Ri({Io:t=>{f?T(Mi,"Not sending because RPC '".concat(e,"' stream ").concat(r," is closed:"),t):(d||(T(Mi,"Opening RPC '".concat(e,"' stream ").concat(r," transport.")),u.open(),d=!0),T(Mi,"RPC '".concat(e,"' stream ").concat(r," sending:"),t),u.send(t))},To:()=>u.close()}),b=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return b(u,h.EventType.OPEN,(()=>{f||(T(Mi,"RPC '".concat(e,"' stream ").concat(r," transport opened.")),p.yo())})),b(u,h.EventType.CLOSE,(()=>{f||(f=!0,T(Mi,"RPC '".concat(e,"' stream ").concat(r," transport closed")),p.So())})),b(u,h.EventType.ERROR,(t=>{f||(f=!0,N(Mi,"RPC '".concat(e,"' stream ").concat(r," transport errored:"),t),p.So(new O(P.UNAVAILABLE,"The operation could not be completed")))})),b(u,h.EventType.MESSAGE,(t=>{var n;if(!f){const i=t.data[0];j(!!i);const s=i,a=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(a){T(Mi,"RPC '".concat(e,"' stream ").concat(r," received error:"),a);const t=a.status;let n=function(e){const t=Qn[e];if(void 0!==t)return $n(t)}(t),i=a.message;void 0===n&&(n=P.INTERNAL,i="Unknown error status: "+t+" with message "+a.message),f=!0,p.So(new O(n,i)),u.close()}else T(Mi,"RPC '".concat(e,"' stream ").concat(r," received:"),i),p.bo(i)}})),b(a,g.STAT_EVENT,(t=>{t.stat===m.PROXY?T(Mi,"RPC '".concat(e,"' stream ").concat(r," detected buffering proxy")):t.stat===m.NOPROXY&&T(Mi,"RPC '".concat(e,"' stream ").concat(r," detected no buffering proxy"))})),setTimeout((()=>{p.wo()}),0),p}}function Ui(){return"undefined"!=typeof document?document:null}function Fi(e){return new yr(e,!0)}class zi{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ui=e,this.timerId=t,this.ko=n,this.qo=r,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-n);r>0&&T("ExponentialBackoff","Backing off for ".concat(r," ms (base delay: ").concat(this.Ko," ms, delay with jitter: ").concat(t," ms, last attempt: ").concat(n," ms ago)")),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,(()=>(this.Uo=Date.now(),e()))),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){null!==this.$o&&(this.$o.skipDelay(),this.$o=null)}cancel(){null!==this.$o&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}class Vi{constructor(e,t,n,r,i,s,a,o){this.ui=e,this.Ho=n,this.Jo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new zi(e,t)}n_(){return 1===this.state||5===this.state||this.r_()}r_(){return 2===this.state||3===this.state}start(){this.e_=0,4!==this.state?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&null===this.Zo&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,(()=>this.__())))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,4!==e?this.t_.reset():t&&t.code===P.RESOURCE_EXHAUSTED?(I(t.toString()),I("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===P.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,r]=e;this.Yo===t&&this.P_(n,r)}),(t=>{e((()=>{const e=new O(P.UNKNOWN,"Fetching auth token failed: "+t.message);return this.I_(e)}))}))}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo((()=>{n((()=>this.listener.Eo()))})),this.stream.Ro((()=>{n((()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,(()=>(this.r_()&&(this.state=3),Promise.resolve()))),this.listener.Ro())))})),this.stream.mo((e=>{n((()=>this.I_(e)))})),this.stream.onMessage((e=>{n((()=>1==++this.e_?this.E_(e):this.onNext(e)))}))}i_(){this.state=5,this.t_.Go((async()=>{this.state=0,this.start()}))}I_(e){return T("PersistentStream","close with error: ".concat(e)),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget((()=>this.Yo===e?t():(T("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Bi extends Vi{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:A()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(j(void 0===t||"string"==typeof t),Ae.fromBase64String(t||"")):(j(void 0===t||t instanceof Buffer||t instanceof Uint8Array),Ae.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,o=a&&function(e){const t=void 0===e.code?P.UNKNOWN:$n(e.code);return new O(t,e.message||"")}(a);n=new cr(r,i,s,o||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ir(e,r.document.name),s=_r(r.document.updateTime),a=r.document.createTime?_r(r.document.createTime):X.min(),o=new it({mapValue:{fields:r.document.fields}}),l=at.newFoundDocument(i,s,a,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new or(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Ir(e,r.document),s=r.readTime?_r(r.readTime):X.min(),a=at.newNoDocument(i,s),o=r.removedTargetIds||[];n=new or([],o,a.key,a)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Ir(e,r.document),s=r.removedTargetIds||[];n=new or([],s,i,null)}else{if(!("filter"in t))return A();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new Kn(r,i),a=e.targetId;n=new lr(a,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return X.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?X.min():t.readTime?_r(t.readTime):X.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=Ar(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Pt(r)?{documents:Or(e,r)}:{query:Rr(e,r)._t},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=wr(e,t.resumeToken);const r=vr(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(X.min())>0){n.readTime=br(e,t.snapshotVersion.toTimestamp());const r=vr(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return A()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=Ar(this.serializer),t.removeTarget=e,this.a_(t)}}class Gi extends Vi{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return j(!!e.streamToken),this.lastStreamToken=e.streamToken,j(!e.writeResults||0===e.writeResults.length),this.listener.f_()}onNext(e){j(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=function(e,t){return e&&e.length>0?(j(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?_r(e.updateTime):_r(t);return n.isEqual(X.min())&&(n=_r(t)),new Nn(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=_r(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=Ar(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Pr(this.serializer,e)))};this.a_(t)}}class qi extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new O(P.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[s,a]=i;return this.connection.Mo(e,Er(t,n),r,s,a)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new O(P.UNKNOWN,e.toString())}))}Lo(e,t,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((s=>{let[a,o]=s;return this.connection.Lo(e,Er(t,n),r,a,o,i)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===P.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new O(P.UNKNOWN,e.toString())}))}terminate(){this.y_=!0,this.connection.terminate()}}class Wi{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){0===this.S_&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve()))))}M_(e){"Online"===this.state?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_("Connection failed 1 times. Most recent error: ".concat(e.toString())),this.C_("Offline")))}set(e){this.x_(),this.S_=0,"Online"===e&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t="Could not reach Cloud Firestore backend. ".concat(e,"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.");this.D_?(I(t),this.D_=!1):T("OnlineStateTracker",t)}x_(){null!==this.b_&&(this.b_.cancel(),this.b_=null)}}class Hi{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o((e=>{n.enqueueAndForget((async()=>{ts(this)&&(T("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=D(e);t.L_.add(4),await Qi(t),t.q_.set("Unknown"),t.L_.delete(4),await Ki(t)}(this))}))})),this.q_=new Wi(n,r)}}async function Ki(e){if(ts(e))for(const t of e.B_)await t(!0)}async function Qi(e){for(const t of e.B_)await t(!1)}function Xi(e,t){const n=D(e);n.N_.has(t.targetId)||(n.N_.set(t.targetId,t),es(n)?Zi(n):ws(n).r_()&&$i(n,t))}function Yi(e,t){const n=D(e),r=ws(n);n.N_.delete(t),r.r_()&&Ji(n,t),0===n.N_.size&&(r.r_()?r.o_():ts(n)&&n.q_.set("Unknown"))}function $i(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(X.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}ws(e).A_(t)}function Ji(e,t){e.Q_.xe(t),ws(e).R_(t)}function Zi(e){e.Q_=new dr({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),ws(e).start(),e.q_.v_()}function es(e){return ts(e)&&!ws(e).n_()&&e.N_.size>0}function ts(e){return 0===D(e).L_.size}function ns(e){e.Q_=void 0}async function rs(e){e.q_.set("Online")}async function is(e){e.N_.forEach(((t,n)=>{$i(e,t)}))}async function ss(e,t){ns(e),es(e)?(e.q_.M_(t),Zi(e)):e.q_.set("Unknown")}async function as(e,t,n){if(e.q_.set("Online"),t instanceof cr&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.N_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.N_.delete(r),e.Q_.removeTarget(r))}(e,t)}catch(n){T("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await os(e,n)}else if(t instanceof or?e.Q_.Ke(t):t instanceof lr?e.Q_.He(t):e.Q_.We(t),!n.isEqual(X.min()))try{const t=await xi(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Q_.rt(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.N_.get(r);i&&e.N_.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.N_.get(t);if(!r)return;e.N_.set(t,r.withResumeToken(Ae.EMPTY_BYTE_STRING,r.snapshotVersion)),Ji(e,t);const i=new Hr(r.target,t,n,r.sequenceNumber);$i(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){T("RemoteStore","Failed to raise snapshot:",t),await os(e,t)}}async function os(e,t,n){if(!de(t))throw t;e.L_.add(1),await Qi(e),e.q_.set("Offline"),n||(n=()=>xi(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{T("RemoteStore","Retrying IndexedDB access"),await n(),e.L_.delete(1),await Ki(e)}))}function ls(e,t){return t().catch((n=>os(e,n,t)))}async function cs(e){const t=D(e),n=xs(t);let r=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;us(t);)try{const e=await Si(t.localStore,r);if(null===e){0===t.O_.length&&n.o_();break}r=e.batchId,ds(t,e)}catch(e){await os(t,e)}hs(t)&&fs(t)}function us(e){return ts(e)&&e.O_.length<10}function ds(e,t){e.O_.push(t);const n=xs(e);n.r_()&&n.V_&&n.m_(t.mutations)}function hs(e){return ts(e)&&!xs(e).n_()&&e.O_.length>0}function fs(e){xs(e).start()}async function ps(e){xs(e).p_()}async function ms(e){const t=xs(e);for(const n of e.O_)t.m_(n.mutations)}async function gs(e,t,n){const r=e.O_.shift(),i=Wn.from(r,t,n);await ls(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await cs(e)}async function ys(e,t){t&&xs(e).V_&&await async function(e,t){if(function(e){return Yn(e)&&e!==P.ABORTED}(t.code)){const n=e.O_.shift();xs(e).s_(),await ls(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await cs(e)}}(e,t),hs(e)&&fs(e)}async function vs(e,t){const n=D(e);n.asyncQueue.verifyOperationInProgress(),T("RemoteStore","RemoteStore received new credentials");const r=ts(n);n.L_.add(3),await Qi(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.L_.delete(3),await Ki(n)}async function bs(e,t){const n=D(e);t?(n.L_.delete(2),await Ki(n)):t||(n.L_.add(2),await Qi(n),n.q_.set("Unknown"))}function ws(e){return e.K_||(e.K_=function(e,t,n){const r=D(e);return r.w_(),new Bi(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:rs.bind(null,e),Ro:is.bind(null,e),mo:ss.bind(null,e),d_:as.bind(null,e)}),e.B_.push((async t=>{t?(e.K_.s_(),es(e)?Zi(e):e.q_.set("Unknown")):(await e.K_.stop(),ns(e))}))),e.K_}function xs(e){return e.U_||(e.U_=function(e,t,n){const r=D(e);return r.w_(),new Gi(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:ps.bind(null,e),mo:ys.bind(null,e),f_:ms.bind(null,e),g_:gs.bind(null,e)}),e.B_.push((async t=>{t?(e.U_.s_(),await cs(e)):(await e.U_.stop(),e.O_.length>0&&(T("RemoteStore","Stopping write stream with ".concat(e.O_.length," pending writes")),e.O_=[]))}))),e.U_}class _s{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new R,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,a=new _s(e,t,s,r,i);return a.start(n),a}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new O(P.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ss(e,t){if(I("AsyncQueue","".concat(t,": ").concat(e)),de(e))return new O(P.UNAVAILABLE,"".concat(t,": ").concat(e));throw e}class Es{constructor(e){this.comparator=e?(t,n)=>e(t,n)||ee.comparator(t.key,n.key):(e,t)=>ee.comparator(e.key,t.key),this.keyedMap=tn(),this.sortedSet=new Se(this.comparator)}static emptySet(e){return new Es(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Es))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Es;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class ks{constructor(){this.W_=new Se(ee.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?0!==e.type&&3===n.type?this.W_=this.W_.insert(t,e):3===e.type&&1!==n.type?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.W_=this.W_.remove(t):1===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):A():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Ts{constructor(e,t,n,r,i,s,a,o,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=a,this.excludesMetadataChanges=o,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach((e=>{s.push({type:0,doc:e})})),new Ts(e,t,Es.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&qt(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class Is{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some((e=>e.J_()))}}class Ns{constructor(){this.queries=Cs(),this.onlineState="Unknown",this.Y_=new Set}terminate(){!function(e,t){const n=D(e),r=n.queries;n.queries=Cs(),r.forEach(((e,n)=>{for(const r of n.j_)r.onError(t)}))}(this,new O(P.ABORTED,"Firestore shutting down"))}}function Cs(){return new $t((e=>Wt(e)),qt)}async function As(e,t){const n=D(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.H_()&&t.J_()&&(r=2):(s=new Is,r=t.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=Ss(e,"Initialization of query '".concat(Ht(t.query),"' failed"));return void t.onError(n)}n.queries.set(i,s),s.j_.push(t),t.Z_(n.onlineState),s.z_&&t.X_(s.z_)&&Os(n)}async function js(e,t){const n=D(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.j_.indexOf(t);e>=0&&(s.j_.splice(e,1),0===s.j_.length?i=t.J_()?0:1:!s.H_()&&t.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Ds(e,t){const n=D(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.j_)e.X_(i)&&(r=!0);t.z_=i}}r&&Os(n)}function Ps(e,t,n){const r=D(e),i=r.queries.get(t);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(t)}function Os(e){e.Y_.forEach((e=>{e.next()}))}var Rs,Ms;(Ms=Rs||(Rs={})).ea="default",Ms.Cache="cache";class Ls{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Ts(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache)return!0;if(!this.J_())return!0;const n="Offline"!==t;return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}oa(e){e=Ts.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Rs.Cache}}class Us{constructor(e){this.key=e}}class Fs{constructor(e){this.key=e}}class zs{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=cn(),this.mutatedKeys=cn(),this.Aa=Xt(e),this.Ra=new Es(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new ks,r=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,a=!1;const o="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const c=r.get(e),u=Kt(this.query,t)?t:null,d=!!c&&this.mutatedKeys.has(c.key),h=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?d!==h&&(n.track({type:3,doc:u}),f=!0):this.ga(c,u)||(n.track({type:2,doc:u}),f=!0,(o&&this.Aa(u,o)>0||l&&this.Aa(u,l)<0)&&(a=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(o||l)&&(a=!0)),f&&(u?(s=s.add(u),i=h?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Ra:s,fa:n,ns:a,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const s=e.fa.G_();s.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return A()}};return n(e)-n(t)}(e.type,t.type)||this.Aa(e.doc,t.doc))),this.pa(n),r=null!=r&&r;const a=t&&!r?this.ya():[],o=0===this.da.size&&this.current&&!r?1:0,l=o!==this.Ea;return this.Ea=o,0!==s.length||l?{snapshot:new Ts(this.query,e.Ra,i,s,e.mutatedKeys,0===o,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new ks,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach((e=>this.Ta=this.Ta.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Ta=this.Ta.delete(e))),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=cn(),this.Ra.forEach((e=>{this.Sa(e.key)&&(this.da=this.da.add(e.key))}));const t=[];return e.forEach((e=>{this.da.has(e)||t.push(new Fs(e))})),this.da.forEach((n=>{e.has(n)||t.push(new Us(n))})),t}ba(e){this.Ta=e.Ts,this.da=cn();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Ts.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,0===this.Ea,this.hasCachedResults)}}class Vs{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Bs{constructor(e){this.key=e,this.va=!1}}class Gs{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new $t((e=>Wt(e)),qt),this.Ma=new Map,this.xa=new Set,this.Oa=new Se(ee.comparator),this.Na=new Map,this.La=new ai,this.Ba={},this.ka=new Map,this.qa=Zr.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return!0===this.Qa}}async function qs(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=da(e);let i;const s=r.Fa.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await Hs(r,t,n,!0),i}async function Ws(e,t){const n=da(e);await Hs(n,t,!0,!1)}async function Hs(e,t,n,r){const i=await Ei(e.localStore,zt(t)),s=i.targetId,a=e.sharedClientState.addLocalQueryTarget(s,n);let o;return r&&(o=await Ks(e,t,s,"current"===a,i.resumeToken)),e.isPrimaryClient&&n&&Xi(e.remoteStore,i),o}async function Ks(e,t,n,r,i){e.Ka=(t,n,r)=>async function(e,t,n,r){let i=t.view.ma(n);i.ns&&(i=await Ti(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.ma(n,i)})));const s=r&&r.targetChanges.get(t.targetId),a=r&&null!=r.targetMismatches.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s,a);return sa(e,t.targetId,o.wa),o.snapshot}(e,t,n,r);const s=await Ti(e.localStore,t,!0),a=new zs(t,s.Ts),o=a.ma(s.documents),l=ar.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=a.applyChanges(o,e.isPrimaryClient,l);sa(e,n,c.wa);const u=new Vs(t,n,a);return e.Fa.set(t,u),e.Ma.has(n)?e.Ma.get(n).push(t):e.Ma.set(n,[t]),c.snapshot}async function Qs(e,t,n){const r=D(e),i=r.Fa.get(t),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter((e=>!qt(e,t)))),void r.Fa.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await ki(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Yi(r.remoteStore,i.targetId),ra(r,i.targetId)})).catch(le)):(ra(r,i.targetId),await ki(r.localStore,i.targetId,!0))}async function Xs(e,t){const n=D(e),r=n.Fa.get(t),i=n.Ma.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Yi(n.remoteStore,r.targetId))}async function Ys(e,t){const n=D(e);try{const e=await function(e,t){const n=D(e),r=t.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const a=[];t.targetChanges.forEach(((s,o)=>{const l=i.get(o);if(!l)return;a.push(n.Ur.removeMatchingKeys(e,s.removedDocuments,o).next((()=>n.Ur.addMatchingKeys(e,s.addedDocuments,o))));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(o)?c=c.withResumeToken(Ae.EMPTY_BYTE_STRING,X.min()).withLastLimboFreeSnapshotVersion(X.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(o,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,c,s)&&a.push(n.Ur.updateTargetData(e,c))}));let o=Zt(),l=cn();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),a.push(_i(e,s,t.documentUpdates).next((e=>{o=e.Ps,l=e.Is}))),!r.isEqual(X.min())){const t=n.Ur.getLastRemoteSnapshotVersion(e).next((t=>n.Ur.setTargetsMetadata(e,e.currentSequenceNumber,r)));a.push(t)}return ce.waitFor(a).next((()=>s.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,o,l))).next((()=>o))})).then((e=>(n.os=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Na.get(t);r&&(j(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.va=!0:e.modifiedDocuments.size>0?j(r.va):e.removedDocuments.size>0&&(j(r.va),r.va=!1))})),await la(n,e,t)}catch(e){await le(e)}}function $s(e,t,n){const r=D(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Fa.forEach(((n,r)=>{const i=r.view.Z_(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=D(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const i of n.j_)i.Z_(t)&&(r=!0)})),r&&Os(n)}(r.eventManager,t),e.length&&r.Ca.d_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Js(e,t,n){const r=D(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Na.get(t),s=i&&i.key;if(s){let e=new Se(ee.comparator);e=e.insert(s,at.newNoDocument(s,X.min()));const n=cn().add(s),i=new sr(X.min(),new Map,new Se(H),e,n);await Ys(r,i),r.Oa=r.Oa.remove(s),r.Na.delete(t),oa(r)}else await ki(r.localStore,t,!1).then((()=>ra(r,t,n))).catch(le)}async function Zs(e,t){const n=D(e),r=t.batch.batchId;try{const e=await function(e,t){const n=D(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let a=ce.resolve();return s.forEach((e=>{a=a.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);j(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),a.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=cn();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);na(n,r,null),ta(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await la(n,e)}catch(e){await le(e)}}async function ea(e,t,n){const r=D(e);try{const e=await function(e,t){const n=D(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(j(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);na(r,t,n),ta(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await la(r,e)}catch(n){await le(n)}}function ta(e,t){(e.ka.get(t)||[]).forEach((e=>{e.resolve()})),e.ka.delete(t)}function na(e,t,n){const r=D(e);let i=r.Ba[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Ba[r.currentUser.toKey()]=i}}function ra(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Ma.get(t))e.Fa.delete(r),n&&e.Ca.$a(r,n);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach((t=>{e.La.containsKey(t)||ia(e,t)}))}function ia(e,t){e.xa.delete(t.path.canonicalString());const n=e.Oa.get(t);null!==n&&(Yi(e.remoteStore,n),e.Oa=e.Oa.remove(t),e.Na.delete(n),oa(e))}function sa(e,t,n){for(const r of n)r instanceof Us?(e.La.addReference(r.key,t),aa(e,r)):r instanceof Fs?(T("SyncEngine","Document no longer in limbo: "+r.key),e.La.removeReference(r.key,t),e.La.containsKey(r.key)||ia(e,r.key)):A()}function aa(e,t){const n=t.key,r=n.path.canonicalString();e.Oa.get(n)||e.xa.has(r)||(T("SyncEngine","New document in limbo: "+n),e.xa.add(r),oa(e))}function oa(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const n=new ee($.fromString(t)),r=e.qa.next();e.Na.set(r,new Bs(n)),e.Oa=e.Oa.insert(n,r),Xi(e.remoteStore,new Hr(zt(Mt(n.path)),r,"TargetPurposeLimboResolution",he.oe))}}async function la(e,t,n){const r=D(e),i=[],s=[],a=[];r.Fa.isEmpty()||(r.Fa.forEach(((e,o)=>{a.push(r.Ka(o,t,n).then((e=>{var t;if((e||n)&&r.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(o.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(o.targetId,i?"current":"not-current")}if(e){i.push(e);const t=mi.Wi(o.targetId,e);s.push(t)}})))})),await Promise.all(a),r.Ca.d_(i),await async function(e,t){const n=D(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>ce.forEach(t,(t=>ce.forEach(t.$i,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>ce.forEach(t.Ui,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!de(e))throw e;T("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.os.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.os=n.os.insert(e,i)}}}(r.localStore,s))}async function ca(e,t){const n=D(e);if(!n.currentUser.isEqual(t)){T("SyncEngine","User change. New user:",t.toKey());const e=await wi(n.localStore,t);n.currentUser=t,function(e,t){e.ka.forEach((e=>{e.forEach((e=>{e.reject(new O(P.CANCELLED,t))}))})),e.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await la(n,e.hs)}}function ua(e,t){const n=D(e),r=n.Na.get(t);if(r&&r.va)return cn().add(r.key);{let e=cn();const r=n.Ma.get(t);if(!r)return e;for(const t of r){const r=n.Fa.get(t);e=e.unionWith(r.view.Va)}return e}}function da(e){const t=D(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Ys.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=ua.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Js.bind(null,t),t.Ca.d_=Ds.bind(null,t.eventManager),t.Ca.$a=Ps.bind(null,t.eventManager),t}function ha(e){const t=D(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Zs.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=ea.bind(null,t),t}class fa{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Fi(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return bi(this.persistence,new yi,e.initialUser,this.serializer)}Ga(e){return new hi(pi.Zr,this.serializer)}Wa(e){return new Ci}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}fa.provider={build:()=>new fa};class pa{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>$s(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=ca.bind(null,this.syncEngine),await bs(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Ns}createDatastore(e){const t=Fi(e.databaseInfo.databaseId),n=function(e){return new Li(e)}(e.databaseInfo);return function(e,t,n,r){return new qi(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new Hi(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>$s(this.syncEngine,e,0)),ji.D()?new ji:new Ai)}createSyncEngine(e,t){return function(e,t,n,r,i,s,a){const o=new Gs(e,t,n,r,i,s);return a&&(o.Qa=!0),o}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=D(e);T("RemoteStore","RemoteStore shutting down."),t.L_.add(5),await Qi(t),t.k_.shutdown(),t.q_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}pa.provider={build:()=>new pa};class ma{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):I("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class ga{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new O(P.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(e,t){const n=D(e),r={documents:t.map((e=>Tr(n.serializer,e)))},i=await n.Lo("BatchGetDocuments",n.serializer.databaseId,$.emptyPath(),r,t.length),s=new Map;i.forEach((e=>{const t=function(e,t){return"found"in t?function(e,t){j(!!t.found),t.found.name,t.found.updateTime;const n=Ir(e,t.found.name),r=_r(t.found.updateTime),i=t.found.createTime?_r(t.found.createTime):X.min(),s=new it({mapValue:{fields:t.found.fields}});return at.newFoundDocument(n,r,i,s)}(e,t):"missing"in t?function(e,t){j(!!t.missing),j(!!t.readTime);const n=Ir(e,t.missing),r=_r(t.readTime);return at.newNoDocument(n,r)}(e,t):A()}(n.serializer,e);s.set(t.key.toString(),t)}));const a=[];return t.forEach((e=>{const t=s.get(e.toString());j(!!t),a.push(t)})),a}(this.datastore,e);return t.forEach((e=>this.recordVersion(e))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new Bn(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((e,t)=>{const n=ee.fromPath(t);this.mutations.push(new Gn(n,this.precondition(n)))})),await async function(e,t){const n=D(e),r={writes:t.map((e=>Pr(n.serializer,e)))};await n.Mo("Commit",n.serializer.databaseId,$.emptyPath(),r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw A();t=X.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new O(P.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(X.min())?Cn.exists(!1):Cn.updateTime(t):Cn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(X.min()))throw new O(P.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Cn.updateTime(t)}return Cn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class ya{constructor(e,t,n,r,i){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=i,this._u=n.maxAttempts,this.t_=new zi(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go((async()=>{const e=new ga(this.datastore),t=this.cu(e);t&&t.then((t=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(t)})).catch((e=>{this.lu(e)}))))})).catch((e=>{this.lu(e)}))}))}cu(e){try{const t=this.updateFunction(e);return!fe(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget((()=>(this.uu(),Promise.resolve())))):this.deferred.reject(e)}hu(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!Yn(t)}return!1}}class va{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=_.UNAUTHENTICATED,this.clientId=W.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async e=>{T("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(T("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new R;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Ss(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function ba(e,t){e.asyncQueue.verifyOperationInProgress(),T("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await wi(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function wa(e,t){e.asyncQueue.verifyOperationInProgress();const n=await xa(e);T("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>vs(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>vs(t.remoteStore,n))),e._onlineComponents=t}async function xa(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){T("FirestoreClient","Using user provided OfflineComponentProvider");try{await ba(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===P.FAILED_PRECONDITION||e.code===P.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;N("Error using user provided cache. Falling back to memory cache: "+n),await ba(e,new fa)}}else T("FirestoreClient","Using default OfflineComponentProvider"),await ba(e,new fa);return e._offlineComponents}async function _a(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(T("FirestoreClient","Using user provided OnlineComponentProvider"),await wa(e,e._uninitializedComponentsProvider._online)):(T("FirestoreClient","Using default OnlineComponentProvider"),await wa(e,new pa))),e._onlineComponents}function Sa(e){return xa(e).then((e=>e.persistence))}function Ea(e){return _a(e).then((e=>e.remoteStore))}function ka(e){return _a(e).then((e=>e.syncEngine))}function Ta(e){return _a(e).then((e=>e.datastore))}async function Ia(e){const t=await _a(e),n=t.eventManager;return n.onListen=qs.bind(null,t.syncEngine),n.onUnlisten=Qs.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Ws.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Xs.bind(null,t.syncEngine),n}function Na(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new R;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new ma({next:o=>{s.Za(),t.enqueueAndForget((()=>js(e,a)));const l=o.docs.has(n);!l&&o.fromCache?i.reject(new O(P.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&o.fromCache&&r&&"server"===r.source?i.reject(new O(P.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:e=>i.reject(e)}),a=new Ls(Mt(n.path),s,{includeMetadataChanges:!0,_a:!0});return As(e,a)}(await Ia(e),e.asyncQueue,t,n,r))),r.promise}function Ca(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new R;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new ma({next:n=>{s.Za(),t.enqueueAndForget((()=>js(e,a))),n.fromCache&&"server"===r.source?i.reject(new O(P.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),a=new Ls(n,s,{includeMetadataChanges:!0,_a:!0});return As(e,a)}(await Ia(e),e.asyncQueue,t,n,r))),r.promise}function Aa(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const ja=new Map;function Da(e,t,n){if(!n)throw new O(P.INVALID_ARGUMENT,"Function ".concat(e,"() cannot be called with an empty ").concat(t,"."))}function Pa(e){if(!ee.isDocumentKey(e))throw new O(P.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but ".concat(e," has ").concat(e.length,"."))}function Oa(e){if(ee.isDocumentKey(e))throw new O(P.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but ".concat(e," has ").concat(e.length,"."))}function Ra(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e="".concat(e.substring(0,20),"...")),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?"a custom ".concat(t," object"):"an object"}}return"function"==typeof e?"a function":A()}function Ma(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new O(P.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ra(e);throw new O(P.INVALID_ARGUMENT,"Expected type '".concat(t.name,"', but it was: ").concat(n))}}return e}function La(e,t){if(t<=0)throw new O(P.INVALID_ARGUMENT,"Function ".concat(e,"() requires a positive number, but it was: ").concat(t,"."))}class Ua{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new O(P.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new O(P.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new O(P.INVALID_ARGUMENT,"".concat(e," and ").concat(n," cannot be used together."))})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Aa(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new O(P.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (must not be NaN)"));if(e.timeoutSeconds<5)throw new O(P.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (minimum allowed value is 5)"));if(e.timeoutSeconds>30)throw new O(P.INVALID_ARGUMENT,"invalid long polling timeout: ".concat(e.timeoutSeconds," (maximum allowed value is 30)"))}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Fa{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Ua({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new O(P.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new O(P.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Ua(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new L;switch(e.type){case"firstParty":return new V(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new O(P.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=ja.get(e);t&&(T("ComponentProvider","Removing Datastore"),ja.delete(e),t.terminate())}(this),Promise.resolve()}}class za{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new za(this.firestore,e,this._query)}}class Va{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ba(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Va(this.firestore,e,this._key)}}class Ba extends za{constructor(e,t,n){super(e,t,Mt(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Va(this.firestore,null,new ee(e))}withConverter(e){return new Ba(this.firestore,e,this._path)}}function Ga(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=(0,l.Ku)(e),Da("collection","path",t),e instanceof Fa){const n=$.fromString(t,...r);return Oa(n),new Ba(e,null,n)}{if(!(e instanceof Va||e instanceof Ba))throw new O(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child($.fromString(t,...r));return Oa(n),new Ba(e.firestore,null,n)}}function qa(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=(0,l.Ku)(e),1===arguments.length&&(t=W.newId()),Da("doc","path",t),e instanceof Fa){const n=$.fromString(t,...r);return Pa(n),new Va(e,null,new ee(n))}{if(!(e instanceof Va||e instanceof Ba))throw new O(P.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child($.fromString(t,...r));return Pa(n),new Va(e.firestore,e instanceof Ba?e.converter:null,new ee(n))}}class Wa{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new zi(this,"async_queue_retry"),this.Vu=()=>{const e=Ui();e&&T("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()},this.mu=e;const t=Ui();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Ui();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise((()=>{}));const t=new R;return this.gu((()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Pu.push(e),this.pu())))}async pu(){if(0!==this.Pu.length){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!de(e))throw e;T("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go((()=>this.pu()))}}gu(e){const t=this.mu.then((()=>(this.du=!0,e().catch((e=>{this.Eu=e,this.du=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw I("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.du=!1,e))))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const r=_s.createAndSchedule(this,e,t,n,(e=>this.yu(e)));return this.Tu.push(r),r}fu(){this.Eu&&A()}verifyOperationInProgress(){}async wu(){let e;do{e=this.mu,await e}while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then((()=>{this.Tu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.Tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.wu()}))}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function Ha(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class Ka extends Fa{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Wa,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Wa(e),this._firestoreClient=void 0,await e}}}function Qa(e,t){const n="object"==typeof e?e:(0,s.Sx)(),r="string"==typeof e?e:t||"(default)",i=(0,s.j6)(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const e=(0,l.yU)("firestore");e&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const s=(e=Ma(e,Fa))._getSettings(),a="".concat(t,":").concat(n);if("firestore.googleapis.com"!==s.host&&s.host!==a&&N("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:a,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=_.MOCK_USER;else{t=(0,l.Fy)(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new O(P.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new _(s)}e._authCredentials=new U(new M(t,n))}}(i,...e)}return i}function Xa(e){if(e._terminated)throw new O(P.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Ya(e),e._firestoreClient}function Ya(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new Ue(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Aa(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new va(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}function $a(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await Sa(e),n=await Ea(e);return t.setNetworkEnabled(!0),function(e){const t=D(e);return t.L_.delete(0),Ki(t)}(n)}))}(Xa(e=Ma(e,Ka)))}function Ja(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await Sa(e),n=await Ea(e);return t.setNetworkEnabled(!1),async function(e){const t=D(e);t.L_.add(0),await Qi(t),t.q_.set("Offline")}(n)}))}(Xa(e=Ma(e,Ka)))}class Za{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Za(Ae.fromBase64String(e))}catch(e){throw new O(P.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Za(Ae.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class eo{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new O(P.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Z(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class to{constructor(e){this._methodName=e}}class no{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new O(P.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new O(P.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return H(this._lat,e._lat)||H(this._long,e._long)}}class ro{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const io=/^__.*__$/;class so{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Un(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ln(e,this.data,t,this.fieldTransforms)}}class ao{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Un(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function oo(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw A()}}class lo{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new lo(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.Ou(e),r}Nu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return No(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(0===e.length)throw this.Bu("Document fields must not be empty");if(oo(this.Cu)&&io.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class co{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Fi(e)}Qu(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new lo({Cu:e,methodName:t,qu:n,path:Z.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function uo(e){const t=e._freezeSettings(),n=Fi(e._databaseId);return new co(e._databaseId,!!t.ignoreUndefinedProperties,n)}function ho(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const a=e.Qu(s.merge||s.mergeFields?2:0,t,n,i);Eo("Data must be an object, but it was:",a,r);const o=_o(r,a);let l,c;if(s.merge)l=new Ne(a.fieldMask),c=a.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=ko(t,r,n);if(!a.contains(i))throw new O(P.INVALID_ARGUMENT,"Field '".concat(i,"' is specified in your field mask but missing from your input data."));Co(e,i)||e.push(i)}l=new Ne(e),c=a.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,c=a.fieldTransforms;return new so(new it(o),l,c)}class fo extends to{_toFieldTransform(e){if(2!==e.Cu)throw 1===e.Cu?e.Bu("".concat(this._methodName,"() can only appear at the top level of your update data")):e.Bu("".concat(this._methodName,"() cannot be used with set() unless you pass {merge:true}"));return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof fo}}function po(e,t,n){return new lo({Cu:3,qu:t.settings.qu,methodName:e._methodName,xu:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class mo extends to{_toFieldTransform(e){return new In(e.path,new bn)}isEqual(e){return e instanceof mo}}class go extends to{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=po(this,e,!0),n=this.Ku.map((e=>xo(e,t))),r=new wn(n);return new In(e.path,r)}isEqual(e){return e instanceof go&&(0,l.bD)(this.Ku,e.Ku)}}class yo extends to{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new En(e.serializer,pn(e.serializer,this.$u));return new In(e.path,t)}isEqual(e){return e instanceof yo&&this.$u===e.$u}}function vo(e,t,n,r){const i=e.Qu(1,t,n);Eo("Data must be an object, but it was:",i,r);const s=[],a=it.empty();xe(r,((e,r)=>{const o=Io(t,e,n);r=(0,l.Ku)(r);const c=i.Nu(o);if(r instanceof fo)s.push(o);else{const e=xo(r,c);null!=e&&(s.push(o),a.set(o,e))}}));const o=new Ne(s);return new ao(a,o,i.fieldTransforms)}function bo(e,t,n,r,i,s){const a=e.Qu(1,t,n),o=[ko(t,r,n)],c=[i];if(s.length%2!=0)throw new O(P.INVALID_ARGUMENT,"Function ".concat(t,"() needs to be called with an even number of arguments that alternate between field names and values."));for(let l=0;l<s.length;l+=2)o.push(ko(t,s[l])),c.push(s[l+1]);const u=[],d=it.empty();for(let f=o.length-1;f>=0;--f)if(!Co(u,o[f])){const e=o[f];let t=c[f];t=(0,l.Ku)(t);const n=a.Nu(e);if(t instanceof fo)u.push(e);else{const r=xo(t,n);null!=r&&(u.push(e),d.set(e,r))}}const h=new Ne(u);return new ao(d,h,a.fieldTransforms)}function wo(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return xo(n,e.Qu(r?4:3,t))}function xo(e,t){if(So(e=(0,l.Ku)(e)))return Eo("Unsupported field value:",t,e),_o(e,t);if(e instanceof to)return function(e,t){if(!oo(t.Cu))throw t.Bu("".concat(e._methodName,"() can only be used with update() and set()"));if(!t.path)throw t.Bu("".concat(e._methodName,"() is not currently supported inside arrays"));const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&4!==t.Cu)throw t.Bu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=xo(i,t.Lu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=(0,l.Ku)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return pn(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Q.fromDate(e);return{timestampValue:br(t.serializer,n)}}if(e instanceof Q){const n=new Q(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:br(t.serializer,n)}}if(e instanceof no)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Za)return{bytesValue:wr(t.serializer,e._byteString)};if(e instanceof Va){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Bu("Document reference is for database ".concat(r.projectId,"/").concat(r.database," but should be for database ").concat(n.projectId,"/").concat(n.database));return{referenceValue:Sr(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof ro)return function(e,t){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw t.Bu("VectorValues must only contain numeric values.");return hn(t.serializer,e)}))}}}}}}(e,t);throw t.Bu("Unsupported field value: ".concat(Ra(e)))}(e,t)}function _o(e,t){const n={};return _e(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):xe(e,((e,r)=>{const i=xo(r,t.Mu(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function So(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Q||e instanceof no||e instanceof Za||e instanceof Va||e instanceof to||e instanceof ro)}function Eo(e,t,n){if(!So(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=Ra(n);throw"an object"===r?t.Bu(e+" a custom object"):t.Bu(e+" "+r)}}function ko(e,t,n){if((t=(0,l.Ku)(t))instanceof eo)return t._internalPath;if("string"==typeof t)return Io(e,t);throw No("Field path arguments must be of type string or ",e,!1,void 0,n)}const To=new RegExp("[~\\*/\\[\\]]");function Io(e,t,n){if(t.search(To)>=0)throw No("Invalid field path (".concat(t,"). Paths must not contain '~', '*', '/', '[', or ']'"),e,!1,void 0,n);try{return new eo(...t.split("."))._internalPath}catch(r){throw No("Invalid field path (".concat(t,"). Paths must not be empty, begin with '.', end with '.', or contain '..'"),e,!1,void 0,n)}}function No(e,t,n,r,i){const s=r&&!r.isEmpty(),a=void 0!==i;let o="Function ".concat(t,"() called with invalid data");n&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=" in field ".concat(r)),a&&(l+=" in document ".concat(i)),l+=")"),new O(P.INVALID_ARGUMENT,o+e+l)}function Co(e,t){return e.some((e=>e.isEqual(t)))}class Ao{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Va(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new jo(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Do("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class jo extends Ao{data(){return super.data()}}function Do(e,t){return"string"==typeof t?Io(e,t):t instanceof eo?t._internalPath:t._delegate._internalPath}function Po(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new O(P.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Oo{}class Ro extends Oo{}function Mo(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t instanceof Oo&&n.push(t),n=n.concat(i),function(e){const t=e.filter((e=>e instanceof Fo)).length,n=e.filter((e=>e instanceof Lo)).length;if(t>1||t>0&&n>0)throw new O(P.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const a of n)e=a._apply(e);return e}class Lo extends Ro{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Lo(e,t,n)}_apply(e){const t=this._parse(e);return Ho(e._query,t),new za(e.firestore,e.converter,Bt(e._query,t))}_parse(e){const t=uo(e.firestore),n=function(e,t,n,r,i,s,a){let o;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new O(P.INVALID_ARGUMENT,"Invalid Query. You can't perform '".concat(s,"' queries on documentId()."));if("in"===s||"not-in"===s){Wo(a,s);const t=[];for(const n of a)t.push(qo(r,e,n));o={arrayValue:{values:t}}}else o=qo(r,e,a)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Wo(a,s),o=wo(n,t,a,"in"===s||"not-in"===s);return ft.create(i,s,o)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function Uo(e,t,n){const r=t,i=Do("where",e);return Lo._create(i,r,n)}class Fo extends Oo{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Fo(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:pt.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)Ho(n,i),n=Bt(n,i)}(e._query,t),new za(e.firestore,e.converter,Bt(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class zo extends Ro{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new zo(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new O(P.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new O(P.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ut(t,n)}(e._query,this._field,this._direction);return new za(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Ot(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function Vo(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=Do("orderBy",e);return zo._create(n,t)}class Bo extends Ro{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Bo(e,t,n)}_apply(e){return new za(e.firestore,e.converter,Gt(e._query,this._limit,this._limitType))}}function Go(e){return La("limit",e),Bo._create("limit",e,"F")}function qo(e,t,n){if("string"==typeof(n=(0,l.Ku)(n))){if(""===n)throw new O(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Ut(t)&&-1!==n.indexOf("/"))throw new O(P.INVALID_ARGUMENT,"Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '".concat(n,"' contains a '/' character."));const r=t.path.child($.fromString(n));if(!ee.isDocumentKey(r))throw new O(P.INVALID_ARGUMENT,"Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '".concat(r,"' is not because it has an odd number of segments (").concat(r.length,")."));return Xe(e,new ee(r))}if(n instanceof Va)return Xe(e,n._key);throw new O(P.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ".concat(Ra(n),"."))}function Wo(e,t){if(!Array.isArray(e)||0===e.length)throw new O(P.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '".concat(t.toString(),"' filters."))}function Ho(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new O(P.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '".concat(t.op.toString(),"' filter.")):new O(P.INVALID_ARGUMENT,"Invalid query. You cannot use '".concat(t.op.toString(),"' filters with '").concat(n.toString(),"' filters."))}class Ko{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(Ve(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Pe(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Oe(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw A()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return xe(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertVectorValue(e){var t,n,r;const i=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t.value.arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map((e=>Pe(e.doubleValue)));return new ro(i)}convertGeoPoint(e){return new no(Pe(e.latitude),Pe(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Me(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Le(e));default:return null}}convertTimestamp(e){const t=De(e);return new Q(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=$.fromString(e);j(Wr(n));const r=new Fe(n.get(1),n.get(3)),i=new ee(n.popFirst(5));return r.isEqual(t)||I("Document ".concat(i," contains a document reference within a different database (").concat(r.projectId,"/").concat(r.database,") which is not supported. It will be treated as a reference in the current database (").concat(t.projectId,"/").concat(t.database,") instead.")),i}}function Qo(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Xo extends Ko{constructor(e){super(),this.firestore=e}convertBytes(e){return new Za(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Va(this.firestore,null,t)}}class Yo{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class $o extends Ao{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Jo(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(Do("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Jo extends $o{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Zo{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Yo(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Jo(this._firestore,this._userDataWriter,n.key,n,new Yo(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new O(P.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new Jo(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Yo(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new Jo(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Yo(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:el(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function el(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return A()}}function tl(e){e=Ma(e,Va);const t=Ma(e.firestore,Ka);return Na(Xa(t),e._key).then((n=>ll(t,e,n)))}class nl extends Ko{constructor(e){super(),this.firestore=e}convertBytes(e){return new Za(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Va(this.firestore,null,t)}}function rl(e){e=Ma(e,za);const t=Ma(e.firestore,Ka),n=Xa(t),r=new nl(t);return Po(e._query),Ca(n,e._query).then((n=>new Zo(t,r,e,n)))}function il(e,t,n){e=Ma(e,Va);const r=Ma(e.firestore,Ka),i=uo(r);let s;for(var a=arguments.length,o=new Array(a>3?a-3:0),c=3;c<a;c++)o[c-3]=arguments[c];return s="string"==typeof(t=(0,l.Ku)(t))||t instanceof eo?bo(i,"updateDoc",e._key,t,n,o):vo(i,"updateDoc",e._key,t),ol(r,[s.toMutation(e._key,Cn.exists(!0))])}function sl(e,t){const n=Ma(e.firestore,Ka),r=qa(e),i=Qo(e.converter,t);return ol(n,[ho(uo(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Cn.exists(!1))]).then((()=>r))}function al(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,s,a;e=(0,l.Ku)(e);let o={includeMetadataChanges:!1,source:"default"},c=0;"object"!=typeof n[c]||Ha(n[c])||(o=n[c],c++);const u={includeMetadataChanges:o.includeMetadataChanges,source:o.source};if(Ha(n[c])){const e=n[c];n[c]=null===(i=e.next)||void 0===i?void 0:i.bind(e),n[c+1]=null===(s=e.error)||void 0===s?void 0:s.bind(e),n[c+2]=null===(a=e.complete)||void 0===a?void 0:a.bind(e)}let d,h,f;if(e instanceof Va)h=Ma(e.firestore,Ka),f=Mt(e._key.path),d={next:t=>{n[c]&&n[c](ll(h,e,t))},error:n[c+1],complete:n[c+2]};else{const t=Ma(e,za);h=Ma(t.firestore,Ka),f=t._query;const r=new nl(h);d={next:e=>{n[c]&&n[c](new Zo(h,r,t,e))},error:n[c+1],complete:n[c+2]},Po(e._query)}return function(e,t,n,r){const i=new ma(r),s=new Ls(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>As(await Ia(e),s))),()=>{i.Za(),e.asyncQueue.enqueueAndForget((async()=>js(await Ia(e),s)))}}(Xa(h),f,u,d)}function ol(e,t){return function(e,t){const n=new R;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=ha(e);try{const e=await function(e,t){const n=D(e),r=Q.now(),i=t.reduce(((e,t)=>e.add(t.key)),cn());let s,a;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let o=Zt(),l=cn();return n.cs.getEntries(e,i).next((e=>{o=e,o.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,o))).next((i=>{s=i;const a=[];for(const e of t){const t=Rn(e,s.get(e.key).overlayedDocument);null!=t&&a.push(new Un(e.key,t,st(t.value.mapValue),Cn.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,a,t)})).next((t=>{a=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:a.batchId,changes:nn(s)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Ba[e.currentUser.toKey()];r||(r=new Se(H)),r=r.insert(t,n),e.Ba[e.currentUser.toKey()]=r}(r,e.batchId,n),await la(r,e.changes),await cs(r.remoteStore)}catch(e){const t=Ss(e,"Failed to persist write");n.reject(t)}}(await ka(e),t,n))),n.promise}(Xa(e),t)}function ll(e,t,n){const r=n.docs.get(t._key),i=new nl(e);return new $o(e,i,t._key,r,new Yo(n.hasPendingWrites,n.fromCache),t.converter)}const cl={maxAttempts:5};function ul(e,t){if((e=(0,l.Ku)(e)).firestore!==t)throw new O(P.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class dl extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=uo(e)}get(e){const t=ul(e,this._firestore),n=new Xo(this._firestore);return this._transaction.lookup([t._key]).then((e=>{if(!e||1!==e.length)return A();const r=e[0];if(r.isFoundDocument())return new Ao(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new Ao(this._firestore,n,t._key,null,t.converter);throw A()}))}set(e,t,n){const r=ul(e,this._firestore),i=Qo(r.converter,t,n),s=ho(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n){const r=ul(e,this._firestore);let i;for(var s=arguments.length,a=new Array(s>3?s-3:0),o=3;o<s;o++)a[o-3]=arguments[o];return i="string"==typeof(t=(0,l.Ku)(t))||t instanceof eo?bo(this._dataReader,"Transaction.update",r._key,t,n,a):vo(this._dataReader,"Transaction.update",r._key,t),this._transaction.update(r._key,i),this}delete(e){const t=ul(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=ul(e,this._firestore),n=new nl(this._firestore);return super.get(e).then((e=>new $o(this._firestore,n,t._key,e._document,new Yo(!1,!1),t.converter)))}}function hl(e,t,n){e=Ma(e,Ka);const r=Object.assign(Object.assign({},cl),n);return function(e){if(e.maxAttempts<1)throw new O(P.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){const r=new R;return e.asyncQueue.enqueueAndForget((async()=>{const i=await Ta(e);new ya(e.asyncQueue,i,n,t,r).au()})),r.promise}(Xa(e),(n=>t(new dl(e,n))),r)}function fl(){return new fo("deleteField")}function pl(){return new mo("serverTimestamp")}function ml(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new go("arrayUnion",t)}function gl(e){return new yo("increment",e)}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){S=e}(s.MF),(0,s.om)(new a.uA("firestore",((e,n)=>{let{instanceIdentifier:r,options:i}=n;const s=e.getProvider("app").getImmediate(),a=new Ka(new F(e.getProvider("auth-internal")),new G(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new O(P.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Fe(e.options.projectId,t)}(s,r),s);return i=Object.assign({useFetchStreams:t},i),a._setSettings(i),a}),"PUBLIC").setMultipleInstances(!0)),(0,s.KO)(x,"4.7.3",e),(0,s.KO)(x,"4.7.3","esm2017")}()},555:(e,t,n)=>{function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function i(e){var t=function(e,t){if("object"!=r(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==r(t)?t:t+""}function s(e,t,n){return(t=i(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n.d(t,{A:()=>o})},579:(e,t,n)=>{e.exports=n(153)},700:(e,t,n)=>{n.d(t,{Am:()=>j,FA:()=>T,Fy:()=>m,I9:()=>D,Im:()=>N,Ku:()=>L,T9:()=>h,Tj:()=>u,Uj:()=>a,XA:()=>f,ZQ:()=>g,bD:()=>C,c1:()=>v,cY:()=>p,eX:()=>E,g:()=>k,hp:()=>P,jZ:()=>y,lT:()=>x,lV:()=>w,nr:()=>_,sr:()=>b,tD:()=>O,u:()=>o,yU:()=>d,zW:()=>S});const r=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},i={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,a=s?e[i+1]:0,o=i+2<e.length,l=o?e[i+2]:0,c=t>>2,u=(3&t)<<4|a>>4;let d=(15&a)<<2|l>>6,h=63&l;o||(h=64,s||(d=64)),r.push(n[c],n[u],n[d],n[h])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(r(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],a=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&a)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0;++i;const o=i<e.length?n[e.charAt(i)]:64;++i;const l=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==a||null==o||null==l)throw new s;const c=t<<2|a>>4;if(r.push(c),64!==o){const e=a<<4&240|o>>2;if(r.push(e),64!==l){const e=o<<6&192|l;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class s extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const a=function(e){return function(e){const t=r(e);return i.encodeByteArray(t,!0)}(e).replace(/\./g,"")},o=function(e){try{return i.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};const l=()=>function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,c=()=>{try{return l()||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&o(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info("Unable to get __FIREBASE_DEFAULTS__ due to: ".concat(e))}},u=e=>{var t,n;return null===(n=null===(t=c())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},d=e=>{const t=u(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error("Invalid host ".concat(t," with no separate hostname and port!"));const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},h=()=>{var e;return null===(e=c())||void 0===e?void 0:e.config},f=e=>{var t;return null===(t=c())||void 0===t?void 0:t["_".concat(e)]};class p{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function m(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:"https://securetoken.google.com/".concat(n),aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[a(JSON.stringify({alg:"none",type:"JWT"})),a(JSON.stringify(s)),""].join(".")}function g(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function y(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(g())}function v(){return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function b(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function w(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function x(){const e=g();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function _(){return!function(){var e;const t=null===(e=c())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function S(){try{return"object"===typeof indexedDB}catch(e){return!1}}function E(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}}))}class k extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,k.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,T.prototype.create)}}class T{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n="".concat(this.service,"/").concat(e),r=this.errors[e],i=r?function(e,t){return e.replace(I,((e,n)=>{const r=t[n];return null!=r?String(r):"<".concat(n,"?>")}))}(r,t):"Error",s="".concat(this.serviceName,": ").concat(i," (").concat(n,").");return new k(n,s,t)}}const I=/\{\$([^}]+)}/g;function N(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function C(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(A(n)&&A(s)){if(!C(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function A(e){return null!==e&&"object"===typeof e}function j(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function D(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function P(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function O(e,t){const n=new R(e,t);return n.subscribe.bind(n)}class R{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=M),void 0===r.error&&(r.error=M),void 0===r.complete&&(r.complete=M);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function M(){}function L(e){return e&&e._delegate?e._delegate:e}},730:(e,t,n)=>{var r=n(43),i=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,o={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(o[e]=t,e=0;e<t.length;e++)a.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),d=Object.prototype.hasOwnProperty,h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,r,i,s,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!d.call(p,e)||!d.call(f,e)&&(h.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var w=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),_=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),k=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),I=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),D=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var P=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function R(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var M,L=Object.assign;function U(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var F=!1;function z(e,t){if(!e||F)return"";F=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),s=r.stack.split("\n"),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(1!==a||1!==o)do{if(a--,0>--o||i[a]!==s[o]){var l="\n"+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=a&&0<=o);break}}}finally{F=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?U(e):""}function V(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case _:return"Portal";case k:return"Profiler";case E:return"StrictMode";case C:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case I:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case N:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case j:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case D:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function G(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function W(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=W(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=W(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function Q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function X(e,t){var n=t.checked;return L({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Y(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=q(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function $(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function J(e,t){$(e,t);var n=q(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&Q(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+q(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return L({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:q(n)}}function se(e,t){var n=q(t.value),r=q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function oe(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?oe(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,de=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ue(e,t)}))}:ue);function he(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ye=L({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var we=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var _e=null,Se=null,Ee=null;function ke(e){if(e=bi(e)){if("function"!==typeof _e)throw Error(s(280));var t=e.stateNode;t&&(t=xi(t),_e(e.stateNode,e.type,t))}}function Te(e){Se?Ee?Ee.push(e):Ee=[e]:Se=e}function Ie(){if(Se){var e=Se,t=Ee;if(Ee=Se=null,ke(e),t)for(e=0;e<t.length;e++)ke(t[e])}}function Ne(e,t){return e(t)}function Ce(){}var Ae=!1;function je(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return Ne(e,t,n)}finally{Ae=!1,(null!==Se||null!==Ee)&&(Ce(),Ie())}}function De(e,t){var n=e.stateNode;if(null===n)return null;var r=xi(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Pe=!1;if(u)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){Pe=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(ue){Pe=!1}function Re(e,t,n,r,i,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Me=!1,Le=null,Ue=!1,Fe=null,ze={onError:function(e){Me=!0,Le=e}};function Ve(e,t,n,r,i,s,a,o,l){Me=!1,Le=null,Re.apply(ze,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Ge(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(Be(e)!==e)throw Error(s(188))}function We(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(r=i.return)){n=r;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===n)return qe(i),e;if(a===r)return qe(i),t;a=a.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=a;else{for(var o=!1,l=i.child;l;){if(l===n){o=!0,n=i,r=a;break}if(l===r){o=!0,r=i,n=a;break}l=l.sibling}if(!o){for(l=a.child;l;){if(l===n){o=!0,n=a,r=i;break}if(l===r){o=!0,r=a,n=i;break}l=l.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Ke=i.unstable_scheduleCallback,Qe=i.unstable_cancelCallback,Xe=i.unstable_shouldYield,Ye=i.unstable_requestPaint,$e=i.unstable_now,Je=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,st=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(ot(e)/lt|0)|0},ot=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function dt(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ht(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,a=268435455&n;if(0!==a){var o=a&~i;0!==o?r=dt(o):0!==(s&=a)&&(r=dt(s))}else 0!==(a=n&~i)?r=dt(a):0!==s&&(r=dt(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-at(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-at(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var bt=0;function wt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,_t,St,Et,kt,Tt=!1,It=[],Nt=null,Ct=null,At=null,jt=new Map,Dt=new Map,Pt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Rt(e,t){switch(e){case"focusin":case"focusout":Nt=null;break;case"dragenter":case"dragleave":Ct=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":jt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Dt.delete(t.pointerId)}}function Mt(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=bi(t))&&_t(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Lt(e){var t=vi(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Ge(n)))return e.blockedOn=t,void kt(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=bi(n))&&_t(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);we=r,n.target.dispatchEvent(r),we=null,t.shift()}return!0}function Ft(e,t,n){Ut(e)&&n.delete(t)}function zt(){Tt=!1,null!==Nt&&Ut(Nt)&&(Nt=null),null!==Ct&&Ut(Ct)&&(Ct=null),null!==At&&Ut(At)&&(At=null),jt.forEach(Ft),Dt.forEach(Ft)}function Vt(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,zt)))}function Bt(e){function t(t){return Vt(t,e)}if(0<It.length){Vt(It[0],e);for(var n=1;n<It.length;n++){var r=It[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==Nt&&Vt(Nt,e),null!==Ct&&Vt(Ct,e),null!==At&&Vt(At,e),jt.forEach(t),Dt.forEach(t),n=0;n<Pt.length;n++)(r=Pt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Pt.length&&null===(n=Pt[0]).blockedOn;)Lt(n),null===n.blockedOn&&Pt.shift()}var Gt=w.ReactCurrentBatchConfig,qt=!0;function Wt(e,t,n,r){var i=bt,s=Gt.transition;Gt.transition=null;try{bt=1,Kt(e,t,n,r)}finally{bt=i,Gt.transition=s}}function Ht(e,t,n,r){var i=bt,s=Gt.transition;Gt.transition=null;try{bt=4,Kt(e,t,n,r)}finally{bt=i,Gt.transition=s}}function Kt(e,t,n,r){if(qt){var i=Xt(e,t,n,r);if(null===i)qr(e,t,r,Qt,n),Rt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return Nt=Mt(Nt,e,t,n,r,i),!0;case"dragenter":return Ct=Mt(Ct,e,t,n,r,i),!0;case"mouseover":return At=Mt(At,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return jt.set(s,Mt(jt.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Dt.set(s,Mt(Dt.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Rt(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==i;){var s=bi(i);if(null!==s&&xt(s),null===(s=Xt(e,t,n,r))&&qr(e,t,r,Qt,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else qr(e,t,r,null,n)}}var Qt=null;function Xt(e,t,n,r){if(Qt=null,null!==(e=vi(e=xe(r))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=Ge(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Qt=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Je()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var $t=null,Jt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Jt,r=n.length,i="value"in $t?$t.value:$t.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[s-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,i,s){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return L(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var an,on,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),dn=L({},cn,{view:0,detail:0}),hn=sn(dn),fn=L({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(an=e.screenX-ln.screenX,on=e.screenY-ln.screenY):on=an=0,ln=e),an)},movementY:function(e){return"movementY"in e?e.movementY:on}}),pn=sn(fn),mn=sn(L({},fn,{dataTransfer:0})),gn=sn(L({},dn,{relatedTarget:0})),yn=sn(L({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=L({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=sn(vn),wn=sn(L({},cn,{data:0})),xn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},_n={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function En(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Sn[e])&&!!t[e]}function kn(){return En}var Tn=L({},dn,{key:function(e){if(e.key){var t=xn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?_n[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),In=sn(Tn),Nn=sn(L({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Cn=sn(L({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kn})),An=sn(L({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),jn=L({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=sn(jn),Pn=[9,13,27,32],On=u&&"CompositionEvent"in window,Rn=null;u&&"documentMode"in document&&(Rn=document.documentMode);var Mn=u&&"TextEvent"in window&&!Rn,Ln=u&&(!On||Rn&&8<Rn&&11>=Rn),Un=String.fromCharCode(32),Fn=!1;function zn(e,t){switch(e){case"keyup":return-1!==Pn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Vn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var Gn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Gn[e.type]:"textarea"===t}function Wn(e,t,n,r){Te(r),0<(t=Hr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,Kn=null;function Qn(e){Ur(e,0)}function Xn(e){if(K(wi(e)))return e}function Yn(e,t){if("change"===e)return t}var $n=!1;if(u){var Jn;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Jn=Zn}else Jn=!1;$n=Jn&&(!document.documentMode||9<document.documentMode)}function tr(){Hn&&(Hn.detachEvent("onpropertychange",nr),Kn=Hn=null)}function nr(e){if("value"===e.propertyName&&Xn(Kn)){var t=[];Wn(t,Kn,e,xe(e)),je(Qn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Hn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Xn(Kn)}function sr(e,t){if("click"===e)return Xn(t)}function ar(e,t){if("input"===e||"change"===e)return Xn(t)}var or="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(or(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!d.call(t,i)||!or(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function dr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?dr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=Q();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=Q((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=hr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&dr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=ur(n,s);var a=ur(n,r);i&&a&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,yr=null,vr=null,br=!1;function wr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;br||null==gr||gr!==Q(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&lr(vr,r)||(vr=r,0<(r=Hr(yr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function xr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var _r={animationend:xr("Animation","AnimationEnd"),animationiteration:xr("Animation","AnimationIteration"),animationstart:xr("Animation","AnimationStart"),transitionend:xr("Transition","TransitionEnd")},Sr={},Er={};function kr(e){if(Sr[e])return Sr[e];if(!_r[e])return e;var t,n=_r[e];for(t in n)if(n.hasOwnProperty(t)&&t in Er)return Sr[e]=n[t];return e}u&&(Er=document.createElement("div").style,"AnimationEvent"in window||(delete _r.animationend.animation,delete _r.animationiteration.animation,delete _r.animationstart.animation),"TransitionEvent"in window||delete _r.transitionend.transition);var Tr=kr("animationend"),Ir=kr("animationiteration"),Nr=kr("animationstart"),Cr=kr("transitionend"),Ar=new Map,jr="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Dr(e,t){Ar.set(e,t),l(t,[e])}for(var Pr=0;Pr<jr.length;Pr++){var Or=jr[Pr];Dr(Or.toLowerCase(),"on"+(Or[0].toUpperCase()+Or.slice(1)))}Dr(Tr,"onAnimationEnd"),Dr(Ir,"onAnimationIteration"),Dr(Nr,"onAnimationStart"),Dr("dblclick","onDoubleClick"),Dr("focusin","onFocus"),Dr("focusout","onBlur"),Dr(Cr,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rr));function Lr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,a,o,l,c){if(Ve.apply(this,arguments),Me){if(!Me)throw Error(s(198));var u=Le;Me=!1,Le=null,Ue||(Ue=!0,Fe=u)}}(r,t,void 0,e),e.currentTarget=null}function Ur(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;Lr(i,o,c),s=l}else for(a=0;a<r.length;a++){if(l=(o=r[a]).instance,c=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;Lr(i,o,c),s=l}}}if(Ue)throw e=Fe,Ue=!1,Fe=null,e}function Fr(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||(Gr(t,e,2,!1),n.add(r))}function zr(e,t,n){var r=0;t&&(r|=4),Gr(n,e,r,t)}var Vr="_reactListening"+Math.random().toString(36).slice(2);function Br(e){if(!e[Vr]){e[Vr]=!0,a.forEach((function(t){"selectionchange"!==t&&(Mr.has(t)||zr(t,!1,e),zr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Vr]||(t[Vr]=!0,zr("selectionchange",!1,t))}}function Gr(e,t,n,r){switch(Yt(t)){case 1:var i=Wt;break;case 4:i=Ht;break;default:i=Kt}n=i.bind(null,t,n,e),i=void 0,!Pe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function qr(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var o=r.stateNode.containerInfo;if(o===i||8===o.nodeType&&o.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var l=a.tag;if((3===l||4===l)&&((l=a.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;a=a.return}for(;null!==o;){if(null===(a=vi(o)))return;if(5===(l=a.tag)||6===l){r=s=a;continue e}o=o.parentNode}}r=r.return}je((function(){var r=s,i=xe(n),a=[];e:{var o=Ar.get(e);if(void 0!==o){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=In;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=Cn;break;case Tr:case Ir:case Nr:l=yn;break;case Cr:l=An;break;case"scroll":l=hn;break;case"wheel":l=Dn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Nn}var u=0!==(4&t),d=!u&&"scroll"===e,h=u?null!==o?o+"Capture":null:o;u=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==h&&(null!=(m=De(p,h))&&u.push(Wr(p,m,f)))),d)break;p=p.return}0<u.length&&(o=new l(o,c,null,n,i),a.push({event:o,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(o="mouseover"===e||"pointerover"===e)||n===we||!(c=n.relatedTarget||n.fromElement)||!vi(c)&&!c[pi])&&(l||o)&&(o=i.window===i?i:(o=i.ownerDocument)?o.defaultView||o.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?vi(c):null)&&(c!==(d=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=pn,m="onMouseLeave",h="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=Nn,m="onPointerLeave",h="onPointerEnter",p="pointer"),d=null==l?o:wi(l),f=null==c?o:wi(c),(o=new u(m,p+"leave",l,n,i)).target=d,o.relatedTarget=f,m=null,vi(i)===r&&((u=new u(h,p+"enter",c,n,i)).target=f,u.relatedTarget=d,m=u),d=m,l&&c)e:{for(h=c,p=0,f=u=l;f;f=Kr(f))p++;for(f=0,m=h;m;m=Kr(m))f++;for(;0<p-f;)u=Kr(u),p--;for(;0<f-p;)h=Kr(h),f--;for(;p--;){if(u===h||null!==h&&u===h.alternate)break e;u=Kr(u),h=Kr(h)}u=null}else u=null;null!==l&&Qr(a,o,l,u,!1),null!==c&&null!==d&&Qr(a,d,c,u,!0)}if("select"===(l=(o=r?wi(r):window).nodeName&&o.nodeName.toLowerCase())||"input"===l&&"file"===o.type)var g=Yn;else if(qn(o))if($n)g=ar;else{g=ir;var y=rr}else(l=o.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===o.type||"radio"===o.type)&&(g=sr);switch(g&&(g=g(e,r))?Wn(a,g,n,i):(y&&y(e,o,r),"focusout"===e&&(y=o._wrapperState)&&y.controlled&&"number"===o.type&&ee(o,"number",o.value)),y=r?wi(r):window,e){case"focusin":(qn(y)||"true"===y.contentEditable)&&(gr=y,yr=r,vr=null);break;case"focusout":vr=yr=gr=null;break;case"mousedown":br=!0;break;case"contextmenu":case"mouseup":case"dragend":br=!1,wr(a,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":wr(a,n,i)}var v;if(On)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Bn?zn(e,n)&&(b="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(b="onCompositionStart");b&&(Ln&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==b?"onCompositionEnd"===b&&Bn&&(v=en()):(Jt="value"in($t=i)?$t.value:$t.textContent,Bn=!0)),0<(y=Hr(r,b)).length&&(b=new wn(b,e,null,n,i),a.push({event:b,listeners:y}),v?b.data=v:null!==(v=Vn(n))&&(b.data=v))),(v=Mn?function(e,t){switch(e){case"compositionend":return Vn(t);case"keypress":return 32!==t.which?null:(Fn=!0,Un);case"textInput":return(e=t.data)===Un&&Fn?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!On&&zn(e,t)?(e=en(),Zt=Jt=$t=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ln&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Hr(r,"onBeforeInput")).length&&(i=new wn("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=v))}Ur(a,t)}))}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Hr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=De(e,n))&&r.unshift(Wr(e,s,i)),null!=(s=De(e,t))&&r.push(Wr(e,s,i))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qr(e,t,n,r,i){for(var s=t._reactName,a=[];null!==n&&n!==r;){var o=n,l=o.alternate,c=o.stateNode;if(null!==l&&l===r)break;5===o.tag&&null!==c&&(o=c,i?null!=(l=De(n,s))&&a.unshift(Wr(n,l,o)):i||null!=(l=De(n,s))&&a.push(Wr(n,l,o))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var Xr=/\r\n?/g,Yr=/\u0000|\uFFFD/g;function $r(e){return("string"===typeof e?e:""+e).replace(Xr,"\n").replace(Yr,"")}function Jr(e,t,n){if(t=$r(t),$r(e)!==t&&n)throw Error(s(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,si="function"===typeof Promise?Promise:void 0,ai="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof si?function(e){return si.resolve(null).then(e).catch(oi)}:ri;function oi(e){setTimeout((function(){throw e}))}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Bt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Bt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var di=Math.random().toString(36).slice(2),hi="__reactFiber$"+di,fi="__reactProps$"+di,pi="__reactContainer$"+di,mi="__reactEvents$"+di,gi="__reactListeners$"+di,yi="__reactHandles$"+di;function vi(e){var t=e[hi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[hi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[hi])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function bi(e){return!(e=e[hi]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function wi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function xi(e){return e[fi]||null}var _i=[],Si=-1;function Ei(e){return{current:e}}function ki(e){0>Si||(e.current=_i[Si],_i[Si]=null,Si--)}function Ti(e,t){Si++,_i[Si]=e.current,e.current=t}var Ii={},Ni=Ei(Ii),Ci=Ei(!1),Ai=Ii;function ji(e,t){var n=e.type.contextTypes;if(!n)return Ii;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Di(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Pi(){ki(Ci),ki(Ni)}function Oi(e,t,n){if(Ni.current!==Ii)throw Error(s(168));Ti(Ni,t),Ti(Ci,n)}function Ri(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,G(e)||"Unknown",i));return L({},n,r)}function Mi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ii,Ai=Ni.current,Ti(Ni,e),Ti(Ci,Ci.current),!0}function Li(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Ri(e,t,Ai),r.__reactInternalMemoizedMergedChildContext=e,ki(Ci),ki(Ni),Ti(Ni,e)):ki(Ci),Ti(Ci,n)}var Ui=null,Fi=!1,zi=!1;function Vi(e){null===Ui?Ui=[e]:Ui.push(e)}function Bi(){if(!zi&&null!==Ui){zi=!0;var e=0,t=bt;try{var n=Ui;for(bt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}Ui=null,Fi=!1}catch(i){throw null!==Ui&&(Ui=Ui.slice(e+1)),Ke(Ze,Bi),i}finally{bt=t,zi=!1}}return null}var Gi=[],qi=0,Wi=null,Hi=0,Ki=[],Qi=0,Xi=null,Yi=1,$i="";function Ji(e,t){Gi[qi++]=Hi,Gi[qi++]=Wi,Wi=e,Hi=t}function Zi(e,t,n){Ki[Qi++]=Yi,Ki[Qi++]=$i,Ki[Qi++]=Xi,Xi=e;var r=Yi;e=$i;var i=32-at(r)-1;r&=~(1<<i),n+=1;var s=32-at(t)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Yi=1<<32-at(t)+i|n<<i|r,$i=s+e}else Yi=1<<s|n<<i|r,$i=e}function es(e){null!==e.return&&(Ji(e,1),Zi(e,1,0))}function ts(e){for(;e===Wi;)Wi=Gi[--qi],Gi[qi]=null,Hi=Gi[--qi],Gi[qi]=null;for(;e===Xi;)Xi=Ki[--Qi],Ki[Qi]=null,$i=Ki[--Qi],Ki[Qi]=null,Yi=Ki[--Qi],Ki[Qi]=null}var ns=null,rs=null,is=!1,ss=null;function as(e,t){var n=jc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function os(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ns=e,rs=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ns=e,rs=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Xi?{id:Yi,overflow:$i}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=jc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ns=e,rs=null,!0);default:return!1}}function ls(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cs(e){if(is){var t=rs;if(t){var n=t;if(!os(e,t)){if(ls(e))throw Error(s(418));t=ci(n.nextSibling);var r=ns;t&&os(e,t)?as(r,n):(e.flags=-4097&e.flags|2,is=!1,ns=e)}}else{if(ls(e))throw Error(s(418));e.flags=-4097&e.flags|2,is=!1,ns=e}}}function us(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ns=e}function ds(e){if(e!==ns)return!1;if(!is)return us(e),is=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=rs)){if(ls(e))throw hs(),Error(s(418));for(;t;)as(e,t),t=ci(t.nextSibling)}if(us(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){rs=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}rs=null}}else rs=ns?ci(e.stateNode.nextSibling):null;return!0}function hs(){for(var e=rs;e;)e=ci(e.nextSibling)}function fs(){rs=ns=null,is=!1}function ps(e){null===ss?ss=[e]:ss.push(e)}var ms=w.ReactCurrentBatchConfig;function gs(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=i.refs;null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function ys(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function vs(e){return(0,e._init)(e._payload)}function bs(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function a(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function o(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Lc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===S?d(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===D&&vs(s)===t.type)?((r=i(t,n.props)).ref=gs(e,t,n),r.return=e,r):((r=Oc(n.type,n.key,n.props,null,e.mode,r)).ref=gs(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Uc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,s){return null===t||7!==t.tag?((t=Rc(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Lc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(n=Oc(t.type,t.key,t.props,null,e.mode,n)).ref=gs(e,null,t),n.return=e,n;case _:return(t=Uc(t,e.mode,n)).return=e,t;case D:return h(e,(0,t._init)(t._payload),n)}if(te(t)||R(t))return(t=Rc(t,e.mode,n,null)).return=e,t;ys(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return n.key===i?c(e,t,n,r):null;case _:return n.key===i?u(e,t,n,r):null;case D:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||R(n))return null!==i?null:d(e,t,n,r,null);ys(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case _:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case D:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||R(r))return d(t,e=e.get(n)||null,r,i,null);ys(t,r)}return null}function m(i,s,o,l){for(var c=null,u=null,d=s,m=s=0,g=null;null!==d&&m<o.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var y=f(i,d,o[m],l);if(null===y){null===d&&(d=g);break}e&&d&&null===y.alternate&&t(i,d),s=a(y,s,m),null===u?c=y:u.sibling=y,u=y,d=g}if(m===o.length)return n(i,d),is&&Ji(i,m),c;if(null===d){for(;m<o.length;m++)null!==(d=h(i,o[m],l))&&(s=a(d,s,m),null===u?c=d:u.sibling=d,u=d);return is&&Ji(i,m),c}for(d=r(i,d);m<o.length;m++)null!==(g=p(d,i,m,o[m],l))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),s=a(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&d.forEach((function(e){return t(i,e)})),is&&Ji(i,m),c}function g(i,o,l,c){var u=R(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var d=u=null,m=o,g=o=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var b=f(i,m,v.value,c);if(null===b){null===m&&(m=y);break}e&&m&&null===b.alternate&&t(i,m),o=a(b,o,g),null===d?u=b:d.sibling=b,d=b,m=y}if(v.done)return n(i,m),is&&Ji(i,g),u;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=h(i,v.value,c))&&(o=a(v,o,g),null===d?u=v:d.sibling=v,d=v);return is&&Ji(i,g),u}for(m=r(i,m);!v.done;g++,v=l.next())null!==(v=p(m,i,g,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),o=a(v,o,g),null===d?u=v:d.sibling=v,d=v);return e&&m.forEach((function(e){return t(i,e)})),is&&Ji(i,g),u}return function e(r,s,a,l){if("object"===typeof a&&null!==a&&a.type===S&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case x:e:{for(var c=a.key,u=s;null!==u;){if(u.key===c){if((c=a.type)===S){if(7===u.tag){n(r,u.sibling),(s=i(u,a.props.children)).return=r,r=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===D&&vs(c)===u.type){n(r,u.sibling),(s=i(u,a.props)).ref=gs(r,u,a),s.return=r,r=s;break e}n(r,u);break}t(r,u),u=u.sibling}a.type===S?((s=Rc(a.props.children,r.mode,l,a.key)).return=r,r=s):((l=Oc(a.type,a.key,a.props,null,r.mode,l)).ref=gs(r,s,a),l.return=r,r=l)}return o(r);case _:e:{for(u=a.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===a.containerInfo&&s.stateNode.implementation===a.implementation){n(r,s.sibling),(s=i(s,a.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=Uc(a,r.mode,l)).return=r,r=s}return o(r);case D:return e(r,s,(u=a._init)(a._payload),l)}if(te(a))return m(r,s,a,l);if(R(a))return g(r,s,a,l);ys(r,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,a)).return=r,r=s):(n(r,s),(s=Lc(a,r.mode,l)).return=r,r=s),o(r)):n(r,s)}}var ws=bs(!0),xs=bs(!1),_s=Ei(null),Ss=null,Es=null,ks=null;function Ts(){ks=Es=Ss=null}function Is(e){var t=_s.current;ki(_s),e._currentValue=t}function Ns(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Cs(e,t){Ss=e,ks=Es=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bo=!0),e.firstContext=null)}function As(e){var t=e._currentValue;if(ks!==e)if(e={context:e,memoizedValue:t,next:null},null===Es){if(null===Ss)throw Error(s(308));Es=e,Ss.dependencies={lanes:0,firstContext:e}}else Es=Es.next=e;return t}var js=null;function Ds(e){null===js?js=[e]:js.push(e)}function Ps(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Ds(t)):(n.next=i.next,i.next=n),t.interleaved=n,Os(e,r)}function Os(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Rs=!1;function Ms(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ls(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Us(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Fs(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Nl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Os(e,n)}return null===(i=r.interleaved)?(t.next=t,Ds(r)):(t.next=i.next,i.next=t),r.interleaved=t,Os(e,n)}function zs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function Vs(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=a:s=s.next=a,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Bs(e,t,n,r){var i=e.updateQueue;Rs=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(null!==o){i.shared.pending=null;var l=o,c=l.next;l.next=null,null===a?s=c:a.next=c,a=l;var u=e.alternate;null!==u&&((o=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===o?u.firstBaseUpdate=c:o.next=c,u.lastBaseUpdate=l))}if(null!==s){var d=i.baseState;for(a=0,u=c=l=null,o=s;;){var h=o.lane,f=o.eventTime;if((r&h)===h){null!==u&&(u=u.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,m=o;switch(h=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(h="function"===typeof(p=m.payload)?p.call(f,d,h):p)||void 0===h)break e;d=L({},d,h);break e;case 2:Rs=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(h=i.effects)?i.effects=[o]:h.push(o))}else f={eventTime:f,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===u?(c=u=f,l=d):u=u.next=f,a|=h;if(null===(o=o.next)){if(null===(o=i.shared.pending))break;o=(h=o).next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}if(null===u&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{a|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);Ml|=a,e.lanes=a,e.memoizedState=d}}function Gs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var qs={},Ws=Ei(qs),Hs=Ei(qs),Ks=Ei(qs);function Qs(e){if(e===qs)throw Error(s(174));return e}function Xs(e,t){switch(Ti(Ks,t),Ti(Hs,e),Ti(Ws,qs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ki(Ws),Ti(Ws,t)}function Ys(){ki(Ws),ki(Hs),ki(Ks)}function $s(e){Qs(Ks.current);var t=Qs(Ws.current),n=le(t,e.type);t!==n&&(Ti(Hs,e),Ti(Ws,n))}function Js(e){Hs.current===e&&(ki(Ws),ki(Hs))}var Zs=Ei(0);function ea(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ta=[];function na(){for(var e=0;e<ta.length;e++)ta[e]._workInProgressVersionPrimary=null;ta.length=0}var ra=w.ReactCurrentDispatcher,ia=w.ReactCurrentBatchConfig,sa=0,aa=null,oa=null,la=null,ca=!1,ua=!1,da=0,ha=0;function fa(){throw Error(s(321))}function pa(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!or(e[n],t[n]))return!1;return!0}function ma(e,t,n,r,i,a){if(sa=a,aa=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ra.current=null===e||null===e.memoizedState?Ja:Za,e=n(r,i),ua){a=0;do{if(ua=!1,da=0,25<=a)throw Error(s(301));a+=1,la=oa=null,t.updateQueue=null,ra.current=eo,e=n(r,i)}while(ua)}if(ra.current=$a,t=null!==oa&&null!==oa.next,sa=0,la=oa=aa=null,ca=!1,t)throw Error(s(300));return e}function ga(){var e=0!==da;return da=0,e}function ya(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===la?aa.memoizedState=la=e:la=la.next=e,la}function va(){if(null===oa){var e=aa.alternate;e=null!==e?e.memoizedState:null}else e=oa.next;var t=null===la?aa.memoizedState:la.next;if(null!==t)la=t,oa=e;else{if(null===e)throw Error(s(310));e={memoizedState:(oa=e).memoizedState,baseState:oa.baseState,baseQueue:oa.baseQueue,queue:oa.queue,next:null},null===la?aa.memoizedState=la=e:la=la.next=e}return la}function ba(e,t){return"function"===typeof t?t(e):t}function wa(e){var t=va(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=oa,i=r.baseQueue,a=n.pending;if(null!==a){if(null!==i){var o=i.next;i.next=a.next,a.next=o}r.baseQueue=i=a,n.pending=null}if(null!==i){a=i.next,r=r.baseState;var l=o=null,c=null,u=a;do{var d=u.lane;if((sa&d)===d)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=h,o=r):c=c.next=h,aa.lanes|=d,Ml|=d}u=u.next}while(null!==u&&u!==a);null===c?o=r:c.next=l,or(r,t.memoizedState)||(bo=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{a=i.lane,aa.lanes|=a,Ml|=a,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function xa(e){var t=va(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,a=t.memoizedState;if(null!==i){n.pending=null;var o=i=i.next;do{a=e(a,o.action),o=o.next}while(o!==i);or(a,t.memoizedState)||(bo=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function _a(){}function Sa(e,t){var n=aa,r=va(),i=t(),a=!or(r.memoizedState,i);if(a&&(r.memoizedState=i,bo=!0),r=r.queue,Ra(Ta.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||null!==la&&1&la.memoizedState.tag){if(n.flags|=2048,Aa(9,ka.bind(null,n,r,i,t),void 0,null),null===Cl)throw Error(s(349));0!==(30&sa)||Ea(n,t,i)}return i}function Ea(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function ka(e,t,n,r){t.value=n,t.getSnapshot=r,Ia(t)&&Na(e)}function Ta(e,t,n){return n((function(){Ia(t)&&Na(e)}))}function Ia(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!or(e,n)}catch(r){return!0}}function Na(e){var t=Os(e,1);null!==t&&nc(t,e,1,-1)}function Ca(e){var t=ya();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ba,lastRenderedState:e},t.queue=e,e=e.dispatch=Ka.bind(null,aa,e),[t.memoizedState,e]}function Aa(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=aa.updateQueue)?(t={lastEffect:null,stores:null},aa.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function ja(){return va().memoizedState}function Da(e,t,n,r){var i=ya();aa.flags|=e,i.memoizedState=Aa(1|t,n,void 0,void 0===r?null:r)}function Pa(e,t,n,r){var i=va();r=void 0===r?null:r;var s=void 0;if(null!==oa){var a=oa.memoizedState;if(s=a.destroy,null!==r&&pa(r,a.deps))return void(i.memoizedState=Aa(t,n,s,r))}aa.flags|=e,i.memoizedState=Aa(1|t,n,s,r)}function Oa(e,t){return Da(8390656,8,e,t)}function Ra(e,t){return Pa(2048,8,e,t)}function Ma(e,t){return Pa(4,2,e,t)}function La(e,t){return Pa(4,4,e,t)}function Ua(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Fa(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Pa(4,4,Ua.bind(null,t,e),n)}function za(){}function Va(e,t){var n=va();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&pa(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ba(e,t){var n=va();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&pa(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ga(e,t,n){return 0===(21&sa)?(e.baseState&&(e.baseState=!1,bo=!0),e.memoizedState=n):(or(n,t)||(n=mt(),aa.lanes|=n,Ml|=n,e.baseState=!0),t)}function qa(e,t){var n=bt;bt=0!==n&&4>n?n:4,e(!0);var r=ia.transition;ia.transition={};try{e(!1),t()}finally{bt=n,ia.transition=r}}function Wa(){return va().memoizedState}function Ha(e,t,n){var r=tc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Qa(e))Xa(t,n);else if(null!==(n=Ps(e,t,n,r))){nc(n,e,r,ec()),Ya(n,t,r)}}function Ka(e,t,n){var r=tc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Qa(e))Xa(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var a=t.lastRenderedState,o=s(a,n);if(i.hasEagerState=!0,i.eagerState=o,or(o,a)){var l=t.interleaved;return null===l?(i.next=i,Ds(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Ps(e,t,i,r))&&(nc(n,e,r,i=ec()),Ya(n,t,r))}}function Qa(e){var t=e.alternate;return e===aa||null!==t&&t===aa}function Xa(e,t){ua=ca=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Ya(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var $a={readContext:As,useCallback:fa,useContext:fa,useEffect:fa,useImperativeHandle:fa,useInsertionEffect:fa,useLayoutEffect:fa,useMemo:fa,useReducer:fa,useRef:fa,useState:fa,useDebugValue:fa,useDeferredValue:fa,useTransition:fa,useMutableSource:fa,useSyncExternalStore:fa,useId:fa,unstable_isNewReconciler:!1},Ja={readContext:As,useCallback:function(e,t){return ya().memoizedState=[e,void 0===t?null:t],e},useContext:As,useEffect:Oa,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Da(4194308,4,Ua.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Da(4194308,4,e,t)},useInsertionEffect:function(e,t){return Da(4,2,e,t)},useMemo:function(e,t){var n=ya();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=ya();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Ha.bind(null,aa,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},ya().memoizedState=e},useState:Ca,useDebugValue:za,useDeferredValue:function(e){return ya().memoizedState=e},useTransition:function(){var e=Ca(!1),t=e[0];return e=qa.bind(null,e[1]),ya().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=aa,i=ya();if(is){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Cl)throw Error(s(349));0!==(30&sa)||Ea(r,t,n)}i.memoizedState=n;var a={value:n,getSnapshot:t};return i.queue=a,Oa(Ta.bind(null,r,a,e),[e]),r.flags|=2048,Aa(9,ka.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=ya(),t=Cl.identifierPrefix;if(is){var n=$i;t=":"+t+"R"+(n=(Yi&~(1<<32-at(Yi)-1)).toString(32)+n),0<(n=da++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=ha++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Za={readContext:As,useCallback:Va,useContext:As,useEffect:Ra,useImperativeHandle:Fa,useInsertionEffect:Ma,useLayoutEffect:La,useMemo:Ba,useReducer:wa,useRef:ja,useState:function(){return wa(ba)},useDebugValue:za,useDeferredValue:function(e){return Ga(va(),oa.memoizedState,e)},useTransition:function(){return[wa(ba)[0],va().memoizedState]},useMutableSource:_a,useSyncExternalStore:Sa,useId:Wa,unstable_isNewReconciler:!1},eo={readContext:As,useCallback:Va,useContext:As,useEffect:Ra,useImperativeHandle:Fa,useInsertionEffect:Ma,useLayoutEffect:La,useMemo:Ba,useReducer:xa,useRef:ja,useState:function(){return xa(ba)},useDebugValue:za,useDeferredValue:function(e){var t=va();return null===oa?t.memoizedState=e:Ga(t,oa.memoizedState,e)},useTransition:function(){return[xa(ba)[0],va().memoizedState]},useMutableSource:_a,useSyncExternalStore:Sa,useId:Wa,unstable_isNewReconciler:!1};function to(e,t){if(e&&e.defaultProps){for(var n in t=L({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function no(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:L({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var ro={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),s=Us(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Fs(e,s,i))&&(nc(t,e,i,r),zs(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ec(),i=tc(e),s=Us(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Fs(e,s,i))&&(nc(t,e,i,r),zs(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ec(),r=tc(e),i=Us(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Fs(e,i,r))&&(nc(t,e,r,n),zs(t,e,r))}};function io(e,t,n,r,i,s,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,a):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,s))}function so(e,t,n){var r=!1,i=Ii,s=t.contextType;return"object"===typeof s&&null!==s?s=As(s):(i=Di(t)?Ai:Ni.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?ji(e,i):Ii),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ro,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function ao(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ro.enqueueReplaceState(t,t.state,null)}function oo(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Ms(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=As(s):(s=Di(t)?Ai:Ni.current,i.context=ji(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(no(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&ro.enqueueReplaceState(i,i.state,null),Bs(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function lo(e,t){try{var n="",r=t;do{n+=V(r),r=r.return}while(r);var i=n}catch(s){i="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:i,digest:null}}function co(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function uo(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ho="function"===typeof WeakMap?WeakMap:Map;function fo(e,t,n){(n=Us(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ql||(ql=!0,Wl=r),uo(0,t)},n}function po(e,t,n){(n=Us(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){uo(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){uo(0,t),"function"!==typeof r&&(null===Hl?Hl=new Set([this]):Hl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function mo(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ho;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=kc.bind(null,e,t,n),t.then(e,e))}function go(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function yo(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=Us(-1,1)).tag=2,Fs(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var vo=w.ReactCurrentOwner,bo=!1;function wo(e,t,n,r){t.child=null===e?xs(t,null,n,r):ws(t,e.child,n,r)}function xo(e,t,n,r,i){n=n.render;var s=t.ref;return Cs(t,i),r=ma(e,t,n,r,s,i),n=ga(),null===e||bo?(is&&n&&es(t),t.flags|=1,wo(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qo(e,t,i))}function _o(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Dc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Oc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,So(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var a=s.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(a,r)&&e.ref===t.ref)return qo(e,t,i)}return t.flags|=1,(e=Pc(s,r)).ref=t.ref,e.return=t,t.child=e}function So(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(lr(s,r)&&e.ref===t.ref){if(bo=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,qo(e,t,i);0!==(131072&e.flags)&&(bo=!0)}}return To(e,t,n,r,i)}function Eo(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ti(Pl,Dl),Dl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ti(Pl,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,Ti(Pl,Dl),Dl|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,Ti(Pl,Dl),Dl|=r;return wo(e,t,i,n),t.child}function ko(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function To(e,t,n,r,i){var s=Di(n)?Ai:Ni.current;return s=ji(t,s),Cs(t,i),n=ma(e,t,n,r,s,i),r=ga(),null===e||bo?(is&&r&&es(t),t.flags|=1,wo(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,qo(e,t,i))}function Io(e,t,n,r,i){if(Di(n)){var s=!0;Mi(t)}else s=!1;if(Cs(t,i),null===t.stateNode)Go(e,t),so(t,n,r),oo(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=As(c):c=ji(t,c=Di(n)?Ai:Ni.current);var u=n.getDerivedStateFromProps,d="function"===typeof u||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==r||l!==c)&&ao(t,a,r,c),Rs=!1;var h=t.memoizedState;a.state=h,Bs(t,r,a,i),l=t.memoizedState,o!==r||h!==l||Ci.current||Rs?("function"===typeof u&&(no(t,n,u,r),l=t.memoizedState),(o=Rs||io(t,n,o,r,h,l,c))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=c,r=o):("function"===typeof a.componentDidMount&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,Ls(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:to(t.type,o),a.props=c,d=t.pendingProps,h=a.context,"object"===typeof(l=n.contextType)&&null!==l?l=As(l):l=ji(t,l=Di(n)?Ai:Ni.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(o!==d||h!==l)&&ao(t,a,r,l),Rs=!1,h=t.memoizedState,a.state=h,Bs(t,r,a,i);var p=t.memoizedState;o!==d||h!==p||Ci.current||Rs?("function"===typeof f&&(no(t,n,f,r),p=t.memoizedState),(c=Rs||io(t,n,c,r,h,p,l)||!1)?(u||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,l),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=l,r=c):("function"!==typeof a.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return No(e,t,n,r,s,i)}function No(e,t,n,r,i,s){ko(e,t);var a=0!==(128&t.flags);if(!r&&!a)return i&&Li(t,n,!1),qo(e,t,s);r=t.stateNode,vo.current=t;var o=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=ws(t,e.child,null,s),t.child=ws(t,null,o,s)):wo(e,t,o,s),t.memoizedState=r.state,i&&Li(t,n,!0),t.child}function Co(e){var t=e.stateNode;t.pendingContext?Oi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Oi(0,t.context,!1),Xs(e,t.containerInfo)}function Ao(e,t,n,r,i){return fs(),ps(i),t.flags|=256,wo(e,t,n,r),t.child}var jo,Do,Po,Oo,Ro={dehydrated:null,treeContext:null,retryLane:0};function Mo(e){return{baseLanes:e,cachePool:null,transitions:null}}function Lo(e,t,n){var r,i=t.pendingProps,a=Zs.current,o=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&a)),r?(o=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Ti(Zs,1&a),null===e)return cs(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,o?(i=t.mode,o=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==o?(o.childLanes=0,o.pendingProps=l):o=Mc(l,i,0,null),e=Rc(e,i,n,null),o.return=t,e.return=t,o.sibling=e,t.child=o,t.child.memoizedState=Mo(n),t.memoizedState=Ro,e):Uo(t,l));if(null!==(a=e.memoizedState)&&null!==(r=a.dehydrated))return function(e,t,n,r,i,a,o){if(n)return 256&t.flags?(t.flags&=-257,Fo(e,t,o,r=co(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=r.fallback,i=t.mode,r=Mc({mode:"visible",children:r.children},i,0,null),(a=Rc(a,i,o,null)).flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,0!==(1&t.mode)&&ws(t,e.child,null,o),t.child.memoizedState=Mo(o),t.memoizedState=Ro,a);if(0===(1&t.mode))return Fo(e,t,o,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Fo(e,t,o,r=co(a=Error(s(419)),r,void 0))}if(l=0!==(o&e.childLanes),bo||l){if(null!==(r=Cl)){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|o))?0:i)&&i!==a.retryLane&&(a.retryLane=i,Os(e,i),nc(r,e,i,-1))}return mc(),Fo(e,t,o,r=co(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Ic.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,rs=ci(i.nextSibling),ns=t,is=!0,ss=null,null!==e&&(Ki[Qi++]=Yi,Ki[Qi++]=$i,Ki[Qi++]=Xi,Yi=e.id,$i=e.overflow,Xi=t),t=Uo(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,a,n);if(o){o=i.fallback,l=t.mode,r=(a=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==a?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Pc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==r?o=Pc(r,o):(o=Rc(o,l,n,null)).flags|=2,o.return=t,i.return=t,i.sibling=o,t.child=i,i=o,o=t.child,l=null===(l=e.child.memoizedState)?Mo(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},o.memoizedState=l,o.childLanes=e.childLanes&~n,t.memoizedState=Ro,i}return e=(o=e.child).sibling,i=Pc(o,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function Uo(e,t){return(t=Mc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Fo(e,t,n,r){return null!==r&&ps(r),ws(t,e.child,null,n),(e=Uo(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zo(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ns(e.return,t,n)}function Vo(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Bo(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(wo(e,t,r.children,n),0!==(2&(r=Zs.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zo(e,n,t);else if(19===e.tag)zo(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ti(Zs,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ea(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Vo(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ea(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Vo(t,!0,n,null,s);break;case"together":Vo(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Go(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function qo(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),Ml|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Pc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Wo(e,t){if(!is)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ho(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ko(e,t,n){var r=t.pendingProps;switch(ts(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ho(t),null;case 1:case 17:return Di(t.type)&&Pi(),Ho(t),null;case 3:return r=t.stateNode,Ys(),ki(Ci),ki(Ni),na(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ds(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ss&&(ac(ss),ss=null))),Do(e,t),Ho(t),null;case 5:Js(t);var i=Qs(Ks.current);if(n=t.type,null!==e&&null!=t.stateNode)Po(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Ho(t),null}if(e=Qs(Ws.current),ds(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[hi]=t,r[fi]=a,e=0!==(1&t.mode),n){case"dialog":Fr("cancel",r),Fr("close",r);break;case"iframe":case"object":case"embed":Fr("load",r);break;case"video":case"audio":for(i=0;i<Rr.length;i++)Fr(Rr[i],r);break;case"source":Fr("error",r);break;case"img":case"image":case"link":Fr("error",r),Fr("load",r);break;case"details":Fr("toggle",r);break;case"input":Y(r,a),Fr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Fr("invalid",r);break;case"textarea":ie(r,a),Fr("invalid",r)}for(var l in ve(n,a),i=null,a)if(a.hasOwnProperty(l)){var c=a[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==a.suppressHydrationWarning&&Jr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&Jr(r.textContent,c,e),i=["children",""+c]):o.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Fr("scroll",r)}switch(n){case"input":H(r),Z(r,a,!0);break;case"textarea":H(r),ae(r);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=oe(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[hi]=t,e[fi]=r,jo(e,t,!1,!1),t.stateNode=e;e:{switch(l=be(n,r),n){case"dialog":Fr("cancel",e),Fr("close",e),i=r;break;case"iframe":case"object":case"embed":Fr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Rr.length;i++)Fr(Rr[i],e);i=r;break;case"source":Fr("error",e),i=r;break;case"img":case"image":case"link":Fr("error",e),Fr("load",e),i=r;break;case"details":Fr("toggle",e),i=r;break;case"input":Y(e,r),i=X(e,r),Fr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=L({},r,{value:void 0}),Fr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Fr("invalid",e)}for(a in ve(n,i),c=i)if(c.hasOwnProperty(a)){var u=c[a];"style"===a?ge(e,u):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&de(e,u):"children"===a?"string"===typeof u?("textarea"!==n||""!==u)&&he(e,u):"number"===typeof u&&he(e,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(o.hasOwnProperty(a)?null!=u&&"onScroll"===a&&Fr("scroll",e):null!=u&&b(e,a,u,l))}switch(n){case"input":H(e),Z(e,r,!1);break;case"textarea":H(e),ae(e);break;case"option":null!=r.value&&e.setAttribute("value",""+q(r.value));break;case"select":e.multiple=!!r.multiple,null!=(a=r.value)?ne(e,!!r.multiple,a,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ho(t),null;case 6:if(e&&null!=t.stateNode)Oo(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=Qs(Ks.current),Qs(Ws.current),ds(t)){if(r=t.stateNode,n=t.memoizedProps,r[hi]=t,(a=r.nodeValue!==n)&&null!==(e=ns))switch(e.tag){case 3:Jr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Jr(r.nodeValue,n,0!==(1&e.mode))}a&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[hi]=t,t.stateNode=r}return Ho(t),null;case 13:if(ki(Zs),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(is&&null!==rs&&0!==(1&t.mode)&&0===(128&t.flags))hs(),fs(),t.flags|=98560,a=!1;else if(a=ds(t),null!==r&&null!==r.dehydrated){if(null===e){if(!a)throw Error(s(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(s(317));a[hi]=t}else fs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ho(t),a=!1}else null!==ss&&(ac(ss),ss=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zs.current)?0===Ol&&(Ol=3):mc())),null!==t.updateQueue&&(t.flags|=4),Ho(t),null);case 4:return Ys(),Do(e,t),null===e&&Br(t.stateNode.containerInfo),Ho(t),null;case 10:return Is(t.type._context),Ho(t),null;case 19:if(ki(Zs),null===(a=t.memoizedState))return Ho(t),null;if(r=0!==(128&t.flags),null===(l=a.rendering))if(r)Wo(a,!1);else{if(0!==Ol||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ea(e))){for(t.flags|=128,Wo(a,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(a=n).flags&=14680066,null===(l=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=l.childLanes,a.lanes=l.lanes,a.child=l.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=l.memoizedProps,a.memoizedState=l.memoizedState,a.updateQueue=l.updateQueue,a.type=l.type,e=l.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ti(Zs,1&Zs.current|2),t.child}e=e.sibling}null!==a.tail&&$e()>Bl&&(t.flags|=128,r=!0,Wo(a,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ea(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Wo(a,!0),null===a.tail&&"hidden"===a.tailMode&&!l.alternate&&!is)return Ho(t),null}else 2*$e()-a.renderingStartTime>Bl&&1073741824!==n&&(t.flags|=128,r=!0,Wo(a,!1),t.lanes=4194304);a.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=a.last)?n.sibling=l:t.child=l,a.last=l)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=$e(),t.sibling=null,n=Zs.current,Ti(Zs,r?1&n|2:1&n),t):(Ho(t),null);case 22:case 23:return dc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Dl)&&(Ho(t),6&t.subtreeFlags&&(t.flags|=8192)):Ho(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Qo(e,t){switch(ts(t),t.tag){case 1:return Di(t.type)&&Pi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ys(),ki(Ci),ki(Ni),na(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Js(t),null;case 13:if(ki(Zs),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));fs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return ki(Zs),null;case 4:return Ys(),null;case 10:return Is(t.type._context),null;case 22:case 23:return dc(),null;default:return null}}jo=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Do=function(){},Po=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Qs(Ws.current);var s,a=null;switch(n){case"input":i=X(e,i),r=X(e,r),a=[];break;case"select":i=L({},i,{value:void 0}),r=L({},r,{value:void 0}),a=[];break;case"textarea":i=re(e,i),r=re(e,r),a=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in ve(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(o.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(a||(a=[]),a.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(a=a||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(o.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Fr("scroll",e),a||l===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}},Oo=function(e,t,n,r){n!==r&&(t.flags|=4)};var Xo=!1,Yo=!1,$o="function"===typeof WeakSet?WeakSet:Set,Jo=null;function Zo(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Ec(e,t,r)}else n.current=null}function el(e,t,n){try{n()}catch(r){Ec(e,t,r)}}var tl=!1;function nl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&el(t,n,s)}i=i.next}while(i!==r)}}function rl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function il(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function sl(e){var t=e.alternate;null!==t&&(e.alternate=null,sl(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[hi],delete t[fi],delete t[mi],delete t[gi],delete t[yi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function al(e){return 5===e.tag||3===e.tag||4===e.tag}function ol(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||al(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ll(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ll(e,t,n),e=e.sibling;null!==e;)ll(e,t,n),e=e.sibling}function cl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(cl(e,t,n),e=e.sibling;null!==e;)cl(e,t,n),e=e.sibling}var ul=null,dl=!1;function hl(e,t,n){for(n=n.child;null!==n;)fl(e,t,n),n=n.sibling}function fl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(o){}switch(n.tag){case 5:Yo||Zo(n,t);case 6:var r=ul,i=dl;ul=null,hl(e,t,n),dl=i,null!==(ul=r)&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):ul.removeChild(n.stateNode));break;case 18:null!==ul&&(dl?(e=ul,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),Bt(e)):li(ul,n.stateNode));break;case 4:r=ul,i=dl,ul=n.stateNode.containerInfo,dl=!0,hl(e,t,n),ul=r,dl=i;break;case 0:case 11:case 14:case 15:if(!Yo&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,void 0!==a&&(0!==(2&s)||0!==(4&s))&&el(n,t,a),i=i.next}while(i!==r)}hl(e,t,n);break;case 1:if(!Yo&&(Zo(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Ec(n,t,o)}hl(e,t,n);break;case 21:hl(e,t,n);break;case 22:1&n.mode?(Yo=(r=Yo)||null!==n.memoizedState,hl(e,t,n),Yo=r):hl(e,t,n);break;default:hl(e,t,n)}}function pl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new $o),t.forEach((function(t){var r=Nc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function ml(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var a=e,o=t,l=o;e:for(;null!==l;){switch(l.tag){case 5:ul=l.stateNode,dl=!1;break e;case 3:case 4:ul=l.stateNode.containerInfo,dl=!0;break e}l=l.return}if(null===ul)throw Error(s(160));fl(a,o,i),ul=null,dl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){Ec(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)gl(t,e),t=t.sibling}function gl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ml(t,e),yl(e),4&r){try{nl(3,e,e.return),rl(3,e)}catch(g){Ec(e,e.return,g)}try{nl(5,e,e.return)}catch(g){Ec(e,e.return,g)}}break;case 1:ml(t,e),yl(e),512&r&&null!==n&&Zo(n,n.return);break;case 5:if(ml(t,e),yl(e),512&r&&null!==n&&Zo(n,n.return),32&e.flags){var i=e.stateNode;try{he(i,"")}catch(g){Ec(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var a=e.memoizedProps,o=null!==n?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===a.type&&null!=a.name&&$(i,a),be(l,o);var u=be(l,a);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];"style"===d?ge(i,h):"dangerouslySetInnerHTML"===d?de(i,h):"children"===d?he(i,h):b(i,d,h,u)}switch(l){case"input":J(i,a);break;case"textarea":se(i,a);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?ne(i,!!a.multiple,p,!1):f!==!!a.multiple&&(null!=a.defaultValue?ne(i,!!a.multiple,a.defaultValue,!0):ne(i,!!a.multiple,a.multiple?[]:"",!1))}i[fi]=a}catch(g){Ec(e,e.return,g)}}break;case 6:if(ml(t,e),yl(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(g){Ec(e,e.return,g)}}break;case 3:if(ml(t,e),yl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(g){Ec(e,e.return,g)}break;case 4:default:ml(t,e),yl(e);break;case 13:ml(t,e),yl(e),8192&(i=e.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(Vl=$e())),4&r&&pl(e);break;case 22:if(d=null!==n&&null!==n.memoizedState,1&e.mode?(Yo=(u=Yo)||d,ml(t,e),Yo=u):ml(t,e),yl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!d&&0!==(1&e.mode))for(Jo=e,d=e.child;null!==d;){for(h=Jo=d;null!==Jo;){switch(p=(f=Jo).child,f.tag){case 0:case 11:case 14:case 15:nl(4,f,f.return);break;case 1:Zo(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Ec(r,n,g)}}break;case 5:Zo(f,f.return);break;case 22:if(null!==f.memoizedState){xl(h);continue}}null!==p?(p.return=f,Jo=p):xl(h)}d=d.sibling}e:for(d=null,h=e;;){if(5===h.tag){if(null===d){d=h;try{i=h.stateNode,u?"function"===typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(l=h.stateNode,o=void 0!==(c=h.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",o))}catch(g){Ec(e,e.return,g)}}}else if(6===h.tag){if(null===d)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){Ec(e,e.return,g)}}else if((22!==h.tag&&23!==h.tag||null===h.memoizedState||h===e)&&null!==h.child){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;null===h.sibling;){if(null===h.return||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ml(t,e),yl(e),4&r&&pl(e);case 21:}}function yl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(al(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(he(i,""),r.flags&=-33),cl(e,ol(e),i);break;case 3:case 4:var a=r.stateNode.containerInfo;ll(e,ol(e),a);break;default:throw Error(s(161))}}catch(o){Ec(e,e.return,o)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function vl(e,t,n){Jo=e,bl(e,t,n)}function bl(e,t,n){for(var r=0!==(1&e.mode);null!==Jo;){var i=Jo,s=i.child;if(22===i.tag&&r){var a=null!==i.memoizedState||Xo;if(!a){var o=i.alternate,l=null!==o&&null!==o.memoizedState||Yo;o=Xo;var c=Yo;if(Xo=a,(Yo=l)&&!c)for(Jo=i;null!==Jo;)l=(a=Jo).child,22===a.tag&&null!==a.memoizedState?_l(i):null!==l?(l.return=a,Jo=l):_l(i);for(;null!==s;)Jo=s,bl(s,t,n),s=s.sibling;Jo=i,Xo=o,Yo=c}wl(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,Jo=s):wl(e)}}function wl(e){for(;null!==Jo;){var t=Jo;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Yo||rl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Yo)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:to(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Gs(t,a,r);break;case 3:var o=t.updateQueue;if(null!==o){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Gs(t,o,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var d=u.memoizedState;if(null!==d){var h=d.dehydrated;null!==h&&Bt(h)}}}break;default:throw Error(s(163))}Yo||512&t.flags&&il(t)}catch(f){Ec(t,t.return,f)}}if(t===e){Jo=null;break}if(null!==(n=t.sibling)){n.return=t.return,Jo=n;break}Jo=t.return}}function xl(e){for(;null!==Jo;){var t=Jo;if(t===e){Jo=null;break}var n=t.sibling;if(null!==n){n.return=t.return,Jo=n;break}Jo=t.return}}function _l(e){for(;null!==Jo;){var t=Jo;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{rl(4,t)}catch(l){Ec(t,n,l)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(l){Ec(t,i,l)}}var s=t.return;try{il(t)}catch(l){Ec(t,s,l)}break;case 5:var a=t.return;try{il(t)}catch(l){Ec(t,a,l)}}}catch(l){Ec(t,t.return,l)}if(t===e){Jo=null;break}var o=t.sibling;if(null!==o){o.return=t.return,Jo=o;break}Jo=t.return}}var Sl,El=Math.ceil,kl=w.ReactCurrentDispatcher,Tl=w.ReactCurrentOwner,Il=w.ReactCurrentBatchConfig,Nl=0,Cl=null,Al=null,jl=0,Dl=0,Pl=Ei(0),Ol=0,Rl=null,Ml=0,Ll=0,Ul=0,Fl=null,zl=null,Vl=0,Bl=1/0,Gl=null,ql=!1,Wl=null,Hl=null,Kl=!1,Ql=null,Xl=0,Yl=0,$l=null,Jl=-1,Zl=0;function ec(){return 0!==(6&Nl)?$e():-1!==Jl?Jl:Jl=$e()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Nl)&&0!==jl?jl&-jl:null!==ms.transition?(0===Zl&&(Zl=mt()),Zl):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function nc(e,t,n,r){if(50<Yl)throw Yl=0,$l=null,Error(s(185));yt(e,n,r),0!==(2&Nl)&&e===Cl||(e===Cl&&(0===(2&Nl)&&(Ll|=n),4===Ol&&oc(e,jl)),rc(e,r),1===n&&0===Nl&&0===(1&t.mode)&&(Bl=$e()+500,Fi&&Bi()))}function rc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-at(s),o=1<<a,l=i[a];-1===l?0!==(o&n)&&0===(o&r)||(i[a]=ft(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}(e,t);var r=ht(e,e===Cl?jl:0);if(0===r)null!==n&&Qe(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Qe(n),1===t)0===e.tag?function(e){Fi=!0,Vi(e)}(lc.bind(null,e)):Vi(lc.bind(null,e)),ai((function(){0===(6&Nl)&&Bi()})),n=null;else{switch(wt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Cc(n,ic.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ic(e,t){if(Jl=-1,Zl=0,0!==(6&Nl))throw Error(s(327));var n=e.callbackNode;if(_c()&&e.callbackNode!==n)return null;var r=ht(e,e===Cl?jl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=gc(e,r);else{t=r;var i=Nl;Nl|=2;var a=pc();for(Cl===e&&jl===t||(Gl=null,Bl=$e()+500,hc(e,t));;)try{vc();break}catch(l){fc(e,l)}Ts(),kl.current=a,Nl=i,null!==Al?t=0:(Cl=null,jl=0,t=Ol)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=sc(e,i))),1===t)throw n=Rl,hc(e,0),oc(e,r),rc(e,$e()),n;if(6===t)oc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!or(s(),i))return!1}catch(o){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=gc(e,r))&&(0!==(a=pt(e))&&(r=a,t=sc(e,a))),1===t))throw n=Rl,hc(e,0),oc(e,r),rc(e,$e()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:xc(e,zl,Gl);break;case 3:if(oc(e,r),(130023424&r)===r&&10<(t=Vl+500-$e())){if(0!==ht(e,0))break;if(((i=e.suspendedLanes)&r)!==r){ec(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(xc.bind(null,e,zl,Gl),t);break}xc(e,zl,Gl);break;case 4:if(oc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-at(r);a=1<<o,(o=t[o])>i&&(i=o),r&=~a}if(r=i,10<(r=(120>(r=$e()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*El(r/1960))-r)){e.timeoutHandle=ri(xc.bind(null,e,zl,Gl),r);break}xc(e,zl,Gl);break;default:throw Error(s(329))}}}return rc(e,$e()),e.callbackNode===n?ic.bind(null,e):null}function sc(e,t){var n=Fl;return e.current.memoizedState.isDehydrated&&(hc(e,t).flags|=256),2!==(e=gc(e,t))&&(t=zl,zl=n,null!==t&&ac(t)),e}function ac(e){null===zl?zl=e:zl.push.apply(zl,e)}function oc(e,t){for(t&=~Ul,t&=~Ll,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-at(t),r=1<<n;e[n]=-1,t&=~r}}function lc(e){if(0!==(6&Nl))throw Error(s(327));_c();var t=ht(e,0);if(0===(1&t))return rc(e,$e()),null;var n=gc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=sc(e,r))}if(1===n)throw n=Rl,hc(e,0),oc(e,t),rc(e,$e()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,xc(e,zl,Gl),rc(e,$e()),null}function cc(e,t){var n=Nl;Nl|=1;try{return e(t)}finally{0===(Nl=n)&&(Bl=$e()+500,Fi&&Bi())}}function uc(e){null!==Ql&&0===Ql.tag&&0===(6&Nl)&&_c();var t=Nl;Nl|=1;var n=Il.transition,r=bt;try{if(Il.transition=null,bt=1,e)return e()}finally{bt=r,Il.transition=n,0===(6&(Nl=t))&&Bi()}}function dc(){Dl=Pl.current,ki(Pl)}function hc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Al)for(n=Al.return;null!==n;){var r=n;switch(ts(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Pi();break;case 3:Ys(),ki(Ci),ki(Ni),na();break;case 5:Js(r);break;case 4:Ys();break;case 13:case 19:ki(Zs);break;case 10:Is(r.type._context);break;case 22:case 23:dc()}n=n.return}if(Cl=e,Al=e=Pc(e.current,null),jl=Dl=t,Ol=0,Rl=null,Ul=Ll=Ml=0,zl=Fl=null,null!==js){for(t=0;t<js.length;t++)if(null!==(r=(n=js[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var a=s.next;s.next=i,r.next=a}n.pending=r}js=null}return e}function fc(e,t){for(;;){var n=Al;try{if(Ts(),ra.current=$a,ca){for(var r=aa.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ca=!1}if(sa=0,la=oa=aa=null,ua=!1,da=0,Tl.current=null,null===n||null===n.return){Ol=1,Rl=t,Al=null;break}e:{var a=e,o=n.return,l=n,c=t;if(t=jl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,d=l,h=d.tag;if(0===(1&d.mode)&&(0===h||11===h||15===h)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var p=go(o);if(null!==p){p.flags&=-257,yo(p,o,l,0,t),1&p.mode&&mo(a,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){mo(a,u,t),mc();break e}c=Error(s(426))}else if(is&&1&l.mode){var y=go(o);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),yo(y,o,l,0,t),ps(lo(c,l));break e}}a=c=lo(c,l),4!==Ol&&(Ol=2),null===Fl?Fl=[a]:Fl.push(a),a=o;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,Vs(a,fo(0,c,t));break e;case 1:l=c;var v=a.type,b=a.stateNode;if(0===(128&a.flags)&&("function"===typeof v.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Hl||!Hl.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t,Vs(a,po(a,l,t));break e}}a=a.return}while(null!==a)}wc(n)}catch(w){t=w,Al===n&&null!==n&&(Al=n=n.return);continue}break}}function pc(){var e=kl.current;return kl.current=$a,null===e?$a:e}function mc(){0!==Ol&&3!==Ol&&2!==Ol||(Ol=4),null===Cl||0===(268435455&Ml)&&0===(268435455&Ll)||oc(Cl,jl)}function gc(e,t){var n=Nl;Nl|=2;var r=pc();for(Cl===e&&jl===t||(Gl=null,hc(e,t));;)try{yc();break}catch(i){fc(e,i)}if(Ts(),Nl=n,kl.current=r,null!==Al)throw Error(s(261));return Cl=null,jl=0,Ol}function yc(){for(;null!==Al;)bc(Al)}function vc(){for(;null!==Al&&!Xe();)bc(Al)}function bc(e){var t=Sl(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?wc(e):Al=t,Tl.current=null}function wc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ko(n,t,Dl)))return void(Al=n)}else{if(null!==(n=Qo(n,t)))return n.flags&=32767,void(Al=n);if(null===e)return Ol=6,void(Al=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Al=t);Al=t=e}while(null!==t);0===Ol&&(Ol=5)}function xc(e,t,n){var r=bt,i=Il.transition;try{Il.transition=null,bt=1,function(e,t,n,r){do{_c()}while(null!==Ql);if(0!==(6&Nl))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-at(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,a),e===Cl&&(Al=Cl=null,jl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Kl||(Kl=!0,Cc(tt,(function(){return _c(),null}))),a=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||a){a=Il.transition,Il.transition=null;var o=bt;bt=1;var l=Nl;Nl|=4,Tl.current=null,function(e,t){if(ei=qt,fr(e=hr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch(x){n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var p;h!==n||0!==i&&3!==h.nodeType||(l=o+i),h!==a||0!==r&&3!==h.nodeType||(c=o+r),3===h.nodeType&&(o+=h.nodeValue.length),null!==(p=h.firstChild);)f=h,h=p;for(;;){if(h===e)break t;if(f===n&&++u===i&&(l=o),f===a&&++d===r&&(c=o),null!==(p=h.nextSibling))break;f=(h=f).parentNode}h=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},qt=!1,Jo=t;null!==Jo;)if(e=(t=Jo).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Jo=e;else for(;null!==Jo;){t=Jo;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,b=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:to(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var w=t.stateNode.containerInfo;1===w.nodeType?w.textContent="":9===w.nodeType&&w.documentElement&&w.removeChild(w.documentElement);break;default:throw Error(s(163))}}catch(x){Ec(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,Jo=e;break}Jo=t.return}m=tl,tl=!1}(e,n),gl(n,e),pr(ti),qt=!!ei,ti=ei=null,e.current=n,vl(n,e,i),Ye(),Nl=l,bt=o,Il.transition=a}else e.current=n;if(Kl&&(Kl=!1,Ql=e,Xl=i),a=e.pendingLanes,0===a&&(Hl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),rc(e,$e()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(ql)throw ql=!1,e=Wl,Wl=null,e;0!==(1&Xl)&&0!==e.tag&&_c(),a=e.pendingLanes,0!==(1&a)?e===$l?Yl++:(Yl=0,$l=e):Yl=0,Bi()}(e,t,n,r)}finally{Il.transition=i,bt=r}return null}function _c(){if(null!==Ql){var e=wt(Xl),t=Il.transition,n=bt;try{if(Il.transition=null,bt=16>e?16:e,null===Ql)var r=!1;else{if(e=Ql,Ql=null,Xl=0,0!==(6&Nl))throw Error(s(331));var i=Nl;for(Nl|=4,Jo=e.current;null!==Jo;){var a=Jo,o=a.child;if(0!==(16&Jo.flags)){var l=a.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(Jo=u;null!==Jo;){var d=Jo;switch(d.tag){case 0:case 11:case 15:nl(8,d,a)}var h=d.child;if(null!==h)h.return=d,Jo=h;else for(;null!==Jo;){var f=(d=Jo).sibling,p=d.return;if(sl(d),d===u){Jo=null;break}if(null!==f){f.return=p,Jo=f;break}Jo=p}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Jo=a}}if(0!==(2064&a.subtreeFlags)&&null!==o)o.return=a,Jo=o;else e:for(;null!==Jo;){if(0!==(2048&(a=Jo).flags))switch(a.tag){case 0:case 11:case 15:nl(9,a,a.return)}var v=a.sibling;if(null!==v){v.return=a.return,Jo=v;break e}Jo=a.return}}var b=e.current;for(Jo=b;null!==Jo;){var w=(o=Jo).child;if(0!==(2064&o.subtreeFlags)&&null!==w)w.return=o,Jo=w;else e:for(o=b;null!==Jo;){if(0!==(2048&(l=Jo).flags))try{switch(l.tag){case 0:case 11:case 15:rl(9,l)}}catch(_){Ec(l,l.return,_)}if(l===o){Jo=null;break e}var x=l.sibling;if(null!==x){x.return=l.return,Jo=x;break e}Jo=l.return}}if(Nl=i,Bi(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(_){}r=!0}return r}finally{bt=n,Il.transition=t}}return!1}function Sc(e,t,n){e=Fs(e,t=fo(0,t=lo(n,t),1),1),t=ec(),null!==e&&(yt(e,1,t),rc(e,t))}function Ec(e,t,n){if(3===e.tag)Sc(e,e,n);else for(;null!==t;){if(3===t.tag){Sc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Hl||!Hl.has(r))){t=Fs(t,e=po(t,e=lo(n,e),1),1),e=ec(),null!==t&&(yt(t,1,e),rc(t,e));break}}t=t.return}}function kc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&n,Cl===e&&(jl&n)===n&&(4===Ol||3===Ol&&(130023424&jl)===jl&&500>$e()-Vl?hc(e,0):Ul|=n),rc(e,t)}function Tc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=ec();null!==(e=Os(e,t))&&(yt(e,t,n),rc(e,n))}function Ic(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Tc(e,n)}function Nc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Tc(e,n)}function Cc(e,t){return Ke(e,t)}function Ac(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function jc(e,t,n,r){return new Ac(e,t,n,r)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var n=e.alternate;return null===n?((n=jc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Oc(e,t,n,r,i,a){var o=2;if(r=e,"function"===typeof e)Dc(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case S:return Rc(n.children,i,a,t);case E:o=8,i|=8;break;case k:return(e=jc(12,n,t,2|i)).elementType=k,e.lanes=a,e;case C:return(e=jc(13,n,t,i)).elementType=C,e.lanes=a,e;case A:return(e=jc(19,n,t,i)).elementType=A,e.lanes=a,e;case P:return Mc(n,i,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:o=10;break e;case I:o=9;break e;case N:o=11;break e;case j:o=14;break e;case D:o=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=jc(o,n,t,i)).elementType=e,t.type=r,t.lanes=a,t}function Rc(e,t,n,r){return(e=jc(7,e,r,t)).lanes=n,e}function Mc(e,t,n,r){return(e=jc(22,e,r,t)).elementType=P,e.lanes=n,e.stateNode={isHidden:!1},e}function Lc(e,t,n){return(e=jc(6,e,null,t)).lanes=n,e}function Uc(e,t,n){return(t=jc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Fc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function zc(e,t,n,r,i,s,a,o,l){return e=new Fc(e,t,n,o,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=jc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Ms(s),e}function Vc(e){if(!e)return Ii;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Di(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Di(n))return Ri(e,n,t)}return t}function Bc(e,t,n,r,i,s,a,o,l){return(e=zc(n,r,!0,e,0,s,0,o,l)).context=Vc(null),n=e.current,(s=Us(r=ec(),i=tc(n))).callback=void 0!==t&&null!==t?t:null,Fs(n,s,i),e.current.lanes=i,yt(e,i,r),rc(e,r),e}function Gc(e,t,n,r){var i=t.current,s=ec(),a=tc(i);return n=Vc(n),null===t.context?t.context=n:t.pendingContext=n,(t=Us(s,a)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Fs(i,t,a))&&(nc(e,i,a,s),zs(e,i,a)),a}function qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Hc(e,t){Wc(e,t),(e=e.alternate)&&Wc(e,t)}Sl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ci.current)bo=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return bo=!1,function(e,t,n){switch(t.tag){case 3:Co(t),fs();break;case 5:$s(t);break;case 1:Di(t.type)&&Mi(t);break;case 4:Xs(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ti(_s,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ti(Zs,1&Zs.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Lo(e,t,n):(Ti(Zs,1&Zs.current),null!==(e=qo(e,t,n))?e.sibling:null);Ti(Zs,1&Zs.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Bo(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ti(Zs,Zs.current),r)break;return null;case 22:case 23:return t.lanes=0,Eo(e,t,n)}return qo(e,t,n)}(e,t,n);bo=0!==(131072&e.flags)}else bo=!1,is&&0!==(1048576&t.flags)&&Zi(t,Hi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Go(e,t),e=t.pendingProps;var i=ji(t,Ni.current);Cs(t,n),i=ma(null,t,r,e,i,n);var a=ga();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Di(r)?(a=!0,Mi(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Ms(t),i.updater=ro,t.stateNode=i,i._reactInternals=t,oo(t,r,e,n),t=No(null,t,r,!0,a,n)):(t.tag=0,is&&a&&es(t),wo(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Go(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===N)return 11;if(e===j)return 14}return 2}(r),e=to(r,e),i){case 0:t=To(null,t,r,e,n);break e;case 1:t=Io(null,t,r,e,n);break e;case 11:t=xo(null,t,r,e,n);break e;case 14:t=_o(null,t,r,to(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,To(e,t,r,i=t.elementType===r?i:to(r,i),n);case 1:return r=t.type,i=t.pendingProps,Io(e,t,r,i=t.elementType===r?i:to(r,i),n);case 3:e:{if(Co(t),null===e)throw Error(s(387));r=t.pendingProps,i=(a=t.memoizedState).element,Ls(e,t),Bs(t,r,null,n);var o=t.memoizedState;if(r=o.element,a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Ao(e,t,r,n,i=lo(Error(s(423)),t));break e}if(r!==i){t=Ao(e,t,r,n,i=lo(Error(s(424)),t));break e}for(rs=ci(t.stateNode.containerInfo.firstChild),ns=t,is=!0,ss=null,n=xs(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(fs(),r===i){t=qo(e,t,n);break e}wo(e,t,r,n)}t=t.child}return t;case 5:return $s(t),null===e&&cs(t),r=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,o=i.children,ni(r,i)?o=null:null!==a&&ni(r,a)&&(t.flags|=32),ko(e,t),wo(e,t,o,n),t.child;case 6:return null===e&&cs(t),null;case 13:return Lo(e,t,n);case 4:return Xs(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=ws(t,null,r,n):wo(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,xo(e,t,r,i=t.elementType===r?i:to(r,i),n);case 7:return wo(e,t,t.pendingProps,n),t.child;case 8:case 12:return wo(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,a=t.memoizedProps,o=i.value,Ti(_s,r._currentValue),r._currentValue=o,null!==a)if(or(a.value,o)){if(a.children===i.children&&!Ci.current){t=qo(e,t,n);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var l=a.dependencies;if(null!==l){o=a.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===a.tag){(c=Us(-1,n&-n)).tag=2;var u=a.updateQueue;if(null!==u){var d=(u=u.shared).pending;null===d?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}a.lanes|=n,null!==(c=a.alternate)&&(c.lanes|=n),Ns(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===a.tag)o=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(o=a.return))throw Error(s(341));o.lanes|=n,null!==(l=o.alternate)&&(l.lanes|=n),Ns(o,n,t),o=a.sibling}else o=a.child;if(null!==o)o.return=a;else for(o=a;null!==o;){if(o===t){o=null;break}if(null!==(a=o.sibling)){a.return=o.return,o=a;break}o=o.return}a=o}wo(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Cs(t,n),r=r(i=As(i)),t.flags|=1,wo(e,t,r,n),t.child;case 14:return i=to(r=t.type,t.pendingProps),_o(e,t,r,i=to(r.type,i),n);case 15:return So(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:to(r,i),Go(e,t),t.tag=1,Di(r)?(e=!0,Mi(t)):e=!1,Cs(t,n),so(t,r,i),oo(t,r,i,n),No(null,t,r,!0,e,n);case 19:return Bo(e,t,n);case 22:return Eo(e,t,n)}throw Error(s(156,t.tag))};var Kc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Xc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jc(){}function Zc(e,t,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if("function"===typeof i){var o=i;i=function(){var e=qc(a);o.call(e)}}Gc(t,a,e,i)}else a=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=qc(a);s.call(e)}}var a=Bc(t,r,e,0,null,!1,0,"",Jc);return e._reactRootContainer=a,e[pi]=a.current,Br(8===e.nodeType?e.parentNode:e),uc(),a}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var o=r;r=function(){var e=qc(l);o.call(e)}}var l=zc(e,0,!1,null,0,!1,0,"",Jc);return e._reactRootContainer=l,e[pi]=l.current,Br(8===e.nodeType?e.parentNode:e),uc((function(){Gc(t,l,n,r)})),l}(n,t,e,i,r);return qc(a)}Xc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Gc(e,t,null,null)},Xc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;uc((function(){Gc(null,e,null,null)})),t[pi]=null}},Xc.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Pt.length&&0!==t&&t<Pt[n].priority;n++);Pt.splice(n,0,e),0===n&&Lt(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=dt(t.pendingLanes);0!==n&&(vt(t,1|n),rc(t,$e()),0===(6&Nl)&&(Bl=$e()+500,Bi()))}break;case 13:uc((function(){var t=Os(e,1);if(null!==t){var n=ec();nc(t,e,1,n)}})),Hc(e,1)}},_t=function(e){if(13===e.tag){var t=Os(e,134217728);if(null!==t)nc(t,e,134217728,ec());Hc(e,134217728)}},St=function(e){if(13===e.tag){var t=tc(e),n=Os(e,t);if(null!==n)nc(n,e,t,ec());Hc(e,t)}},Et=function(){return bt},kt=function(e,t){var n=bt;try{return bt=e,t()}finally{bt=n}},_e=function(e,t,n){switch(t){case"input":if(J(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=xi(r);if(!i)throw Error(s(90));K(r),J(r,i)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ne=cc,Ce=uc;var eu={usingClientEntryPoint:!1,Events:[bi,wi,xi,Te,Ie,cc]},tu={findFiberByHostInstance:vi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},nu={bundleType:tu.bundleType,version:tu.version,rendererPackageName:tu.rendererPackageName,rendererConfig:tu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:w.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=We(e))?null:e.stateNode},findFiberByHostInstance:tu.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ru=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ru.isDisabled&&ru.supportsFiber)try{it=ru.inject(nu),st=ru}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=eu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:_,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yc(e))throw Error(s(299));var n=!1,r="",i=Kc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=zc(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,Br(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=We(t))?null:e.stateNode},t.flushSync=function(e){return uc(e)},t.hydrate=function(e,t,n){if(!$c(t))throw Error(s(200));return Zc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yc(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,a="",o=Kc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(a=n.identifierPrefix),void 0!==n.onRecoverableError&&(o=n.onRecoverableError)),t=Bc(t,null,e,1,null!=n?n:null,i,0,a,o),e[pi]=t.current,Br(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Xc(t)},t.render=function(e,t,n){if(!$c(t))throw Error(s(200));return Zc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!$c(e))throw Error(s(40));return!!e._reactRootContainer&&(uc((function(){Zc(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!$c(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return Zc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},812:(e,t,n)=>{n.d(t,{h1:()=>o,uA:()=>i});var r=n(700);class i{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const s="[DEFAULT]";class a{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new r.cY;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service ".concat(this.name," is not available"))}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error("Mismatching Component ".concat(e.name," for Provider ").concat(this.name,"."));if(this.component)throw Error("Component for ".concat(this.name," has already been provided"));if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:s})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error("".concat(this.name,"(").concat(n,") has already been initialized"));if(!this.isComponentSet())throw Error("Component ".concat(this.name," has not been registered yet"));const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===s?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(a){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:s;return this.component?this.component.multipleInstances?e:s:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class o{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component ".concat(e.name," has already been registered with ").concat(this.name));t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new a(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r=n(43),i=n(391),s=n(150),a=n(700),o=n(443);function l(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;var c=n(812);function u(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const d=u,h=new a.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),f=new o.Vy("@firebase/auth");function p(e){if(f.logLevel<=o.$b.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];f.error("Auth (".concat(s.MF,"): ").concat(e),...n)}}function m(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw b(e,...n)}function g(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return b(e,...n)}function y(e,t,n){const r=Object.assign(Object.assign({},d()),{[t]:n});return new a.FA("auth","Firebase",r).create(t,{appName:e.name})}function v(e){return y(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function b(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return h.create(e,...n)}function w(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw b(t,...r)}}function x(e){const t="INTERNAL ASSERTION FAILED: "+e;throw p(t),new Error(t)}function _(e,t){e||x(t)}function S(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function E(){return"http:"===k()||"https:"===k()}function k(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class T{constructor(e,t){this.shortDelay=e,this.longDelay=t,_(t>e,"Short delay should be less than long delay!"),this.isMobile=(0,a.jZ)()||(0,a.lV)()}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(E()||(0,a.sr)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function I(e,t){_(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?"".concat(n).concat(t.startsWith("/")?t.slice(1):t):n}class N{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void x("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void x("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void x("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const C={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},A=new T(3e4,6e4);function j(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function D(e,t,n,r){return P(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=(0,a.Am)(Object.assign({key:e.config.apiKey},s)).slice(1),l=await e._getAdditionalHeaders();l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode);const c=Object.assign({method:t,headers:l},i);return(0,a.c1)()||(c.referrerPolicy="no-referrer"),N.fetch()(R(e,e.config.apiHost,n,o),c)}))}async function P(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},C),t);try{const t=new L(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw U(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,a]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw U(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw U(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw U(e,"user-disabled",s);const o=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(a)throw y(e,o,a);m(e,o)}}catch(i){if(i instanceof a.g)throw i;m(e,"network-request-failed",{message:String(i)})}}async function O(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await D(e,t,n,r,i);return"mfaPendingCredential"in s&&m(e,"multi-factor-auth-required",{_serverResponse:s}),s}function R(e,t,n,r){const i="".concat(t).concat(n,"?").concat(r);return e.config.emulator?I(e.config,i):"".concat(e.config.apiScheme,"://").concat(i)}function M(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class L{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(g(this.auth,"network-request-failed"))),A.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function U(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=g(e,t,r);return i.customData._tokenResponse=n,i}function F(e){return void 0!==e&&void 0!==e.enterprise}class z{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return M(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function V(e,t){return D(e,"GET","/v2/recaptchaConfig",j(e,t))}async function B(e,t){return D(e,"POST","/v1/accounts:lookup",t)}function G(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function q(e){return 1e3*Number(e)}function W(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return p("JWT malformed, contained fewer than 3 sections"),null;try{const e=(0,a.u)(n);return e?JSON.parse(e):(p("Failed to decode base64 JWT payload"),null)}catch(i){return p("Caught error parsing JWT payload as JSON",null===i||void 0===i?void 0:i.toString()),null}}function H(e){const t=W(e);return w(t,"internal-error"),w("undefined"!==typeof t.exp,"internal-error"),w("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function K(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof a.g&&function(e){let{code:t}=e;return t==="auth/".concat("user-disabled")||t==="auth/".concat("user-token-expired")}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class Q{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void((null===e||void 0===e?void 0:e.code)==="auth/".concat("network-request-failed")&&this.schedule(!0))}this.schedule()}}class X{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=G(this.lastLoginAt),this.creationTime=G(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Y(e){var t;const n=e.auth,r=await e.getIdToken(),i=await K(e,B(n,{idToken:r}));w(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const a=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?$(s.providerUserInfo):[],o=(l=e.providerData,c=a,[...l.filter((e=>!c.some((t=>t.providerId===e.providerId)))),...c]);var l,c;const u=e.isAnonymous,d=!(e.email&&s.passwordHash)&&!(null===o||void 0===o?void 0:o.length),h=!!u&&d,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new X(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(e,f)}function $(e){return e.map((e=>{var{providerId:t}=e,n=l(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class J{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){w(e.idToken,"internal-error"),w("undefined"!==typeof e.idToken,"internal-error"),w("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):H(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){w(0!==e.length,"internal-error");const t=H(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(w(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await P(e,{},(async()=>{const n=(0,a.Am)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=R(e,r,"/v1/token","key=".concat(i)),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",N.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new J;return n&&(w("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(w("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(w("number"===typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new J,this.toJSON())}_performRefresh(){return x("not implemented")}}function Z(e,t){w("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class ee{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=l(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Q(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new X(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await K(this,this.stsTokenManager.getToken(this.auth,e));return w(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=(0,a.Ku)(e),r=await n.getIdToken(t),i=W(r);w(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"===typeof i.firebase?i.firebase:void 0,o=null===s||void 0===s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:G(q(i.auth_time)),issuedAtTime:G(q(i.iat)),expirationTime:G(q(i.exp)),signInProvider:o||null,signInSecondFactor:(null===s||void 0===s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=(0,a.Ku)(e);await Y(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(w(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ee(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){w(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Y(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,s.xZ)(this.auth.app))return Promise.reject(v(this.auth));const e=await this.getIdToken();return await K(this,async function(e,t){return D(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,a,o,l,c;const u=null!==(n=t.displayName)&&void 0!==n?n:void 0,d=null!==(r=t.email)&&void 0!==r?r:void 0,h=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(a=t.tenantId)&&void 0!==a?a:void 0,m=null!==(o=t._redirectEventId)&&void 0!==o?o:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,y=null!==(c=t.lastLoginAt)&&void 0!==c?c:void 0,{uid:v,emailVerified:b,isAnonymous:x,providerData:_,stsTokenManager:S}=t;w(v&&S,e,"internal-error");const E=J.fromJSON(this.name,S);w("string"===typeof v,e,"internal-error"),Z(u,e.name),Z(d,e.name),w("boolean"===typeof b,e,"internal-error"),w("boolean"===typeof x,e,"internal-error"),Z(h,e.name),Z(f,e.name),Z(p,e.name),Z(m,e.name),Z(g,e.name),Z(y,e.name);const k=new ee({uid:v,auth:e,email:d,emailVerified:b,displayName:u,isAnonymous:x,photoURL:f,phoneNumber:h,tenantId:p,stsTokenManager:E,createdAt:g,lastLoginAt:y});return _&&Array.isArray(_)&&(k.providerData=_.map((e=>Object.assign({},e)))),m&&(k._redirectEventId=m),k}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new J;r.updateFromServerResponse(t);const i=new ee({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Y(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];w(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?$(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length),a=new J;a.updateFromIdToken(n);const o=new ee({uid:r.localId,auth:e,stsTokenManager:a,isAnonymous:s}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new X(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length)};return Object.assign(o,l),o}}const te=new Map;function ne(e){_(e instanceof Function,"Expected a class definition");let t=te.get(e);return t?(_(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,te.set(e,t),t)}class re{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}re.type="NONE";const ie=re;function se(e,t,n){return"firebase".concat(":",e,":").concat(t,":").concat(n)}class ae{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=se(this.userKey,r.apiKey,i),this.fullPersistenceKey=se("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ee._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new ae(ne(ie),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||ne(ie);const s=se(n,e.config.apiKey,e.name);let a=null;for(const c of t)try{const t=await c._get(s);if(t){const n=ee._fromJSON(e,t);c!==i&&(a=n),i=c;break}}catch(l){}const o=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&o.length?(i=o[0],a&&await i._set(s,a.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch(l){}}))),new ae(i,e,n)):new ae(i,e,n)}}function oe(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(de(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(le(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(fe(t))return"Blackberry";if(pe(t))return"Webos";if(ce(t))return"Safari";if((t.includes("chrome/")||ue(t))&&!t.includes("edge/"))return"Chrome";if(he(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function le(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)();return/firefox\//i.test(e)}function ce(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function ue(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)();return/crios\//i.test(e)}function de(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)();return/iemobile/i.test(e)}function he(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)();return/android/i.test(e)}function fe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)();return/blackberry/i.test(e)}function pe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)();return/webos/i.test(e)}function me(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function ge(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)();return me(e)||he(e)||pe(e)||fe(e)||/windows phone/i.test(e)||de(e)}function ye(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=oe((0,a.ZQ)());break;case"Worker":t="".concat(oe((0,a.ZQ)()),"-").concat(e);break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return"".concat(t,"/","JsCore","/").concat(s.MF,"/").concat(r)}class ve{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(i){r(i)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class be{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,a;const o={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,o),this.validatePasswordCharacterOptions(e,o),o.isValid&&(o.isValid=null===(t=o.meetsMinPasswordLength)||void 0===t||t),o.isValid&&(o.isValid=null===(n=o.meetsMaxPasswordLength)||void 0===n||n),o.isValid&&(o.isValid=null===(r=o.containsLowercaseLetter)||void 0===r||r),o.isValid&&(o.isValid=null===(i=o.containsUppercaseLetter)||void 0===i||i),o.isValid&&(o.isValid=null===(s=o.containsNumericCharacter)||void 0===s||s),o.isValid&&(o.isValid=null===(a=o.containsNonAlphanumericCharacter)||void 0===a||a),o}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class we{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new _e(this),this.idTokenSubscription=new _e(this),this.beforeStateQueue=new ve(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=h,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ne(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await ae.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(i){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await B(this,{idToken:e}),n=await ee._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if((0,s.xZ)(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null===r||void 0===r?void 0:r._redirectEventId,a=await this.tryRedirectSignIn(e);n&&n!==s||!(null===a||void 0===a?void 0:a.user)||(r=a.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(a){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(a)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return w(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Y(e)}catch(t){if((null===t||void 0===t?void 0:t.code)!=="auth/".concat("network-request-failed"))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if((0,s.xZ)(this.app))return Promise.reject(v(this));const t=e?(0,a.Ku)(e):null;return t&&w(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&w(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return(0,s.xZ)(this.app)?Promise.reject(v(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return(0,s.xZ)(this.app)?Promise.reject(v(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(ne(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return D(e,"GET","/v2/passwordPolicy",j(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new be(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new a.FA("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return D(e,"POST","/v2/accounts:revokeToken",j(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ne(e)||this._popupRedirectResolver;w(t,this,"argument-error"),this.redirectPersistenceManager=await ae.create(this,[ne(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return"".concat(this.config.authDomain,":").concat(this.config.apiKey,":").concat(this.name)}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let s=!1;const a=this._isInitialized?Promise.resolve():this._initializationPromise;if(w(a,this,"internal-error"),a.then((()=>{s||i(this.currentUser)})),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return w(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ye(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(f.logLevel<=o.$b.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];f.warn("Auth (".concat(s.MF,"): ").concat(e),...n)}}("Error while retrieving App Check token: ".concat(t.error)),null===t||void 0===t?void 0:t.token}}function xe(e){return(0,a.Ku)(e)}class _e{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,a.tD)((e=>this.observer=e))}get next(){return w(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Se={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ee(e){return Se.loadJS(e)}function ke(e){return"__".concat(e).concat(Math.floor(1e6*Math.random()))}class Te{constructor(e){this.type="recaptcha-enterprise",this.auth=xe(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;F(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{V(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new z(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&F(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Se.recaptchaEnterpriseScript;0!==t.length&&(t+=i),Ee(t).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function Ie(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=new Te(e);let s;try{s=await i.verify(n)}catch(o){s=await i.verify(n,!0)}const a=Object.assign({},t);return r?Object.assign(a,{captchaResp:s}):Object.assign(a,{captchaResponse:s}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Ne(e,t,n,r){var i;if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Ie(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch((async i=>{if(i.code==="auth/".concat("missing-recaptcha-token")){console.log("".concat(n," is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow."));const i=await Ie(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)}))}function Ce(e,t,n){const r=xe(e);w(r._canInitEmulator,r,"emulator-config-failed"),w(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),s=Ae(t),{host:a,port:o}=function(e){const t=Ae(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:je(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:je(t)}}}(t),l=null===o?"":":".concat(o);r.config.emulator={url:"".concat(s,"//").concat(a).concat(l,"/")},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:a,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Ae(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function je(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class De{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return x("not implemented")}_getIdTokenResponse(e){return x("not implemented")}_linkToIdToken(e,t){return x("not implemented")}_getReauthenticationResolver(e){return x("not implemented")}}async function Pe(e,t){return D(e,"POST","/v1/accounts:signUp",t)}async function Oe(e,t){return O(e,"POST","/v1/accounts:signInWithPassword",j(e,t))}class Re extends De{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Re(e,t,"password")}static _fromEmailAndCode(e,t){return new Re(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Ne(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Oe);case"emailLink":return async function(e,t){return O(e,"POST","/v1/accounts:signInWithEmailLink",j(e,t))}(e,{email:this._email,oobCode:this._password});default:m(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Ne(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Pe);case"emailLink":return async function(e,t){return O(e,"POST","/v1/accounts:signInWithEmailLink",j(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:m(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Me(e,t){return O(e,"POST","/v1/accounts:signInWithIdp",j(e,t))}class Le extends De{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Le(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):m("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=l(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new Le(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Me(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Me(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Me(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,a.Am)(t)}return e}}const Ue={USER_NOT_FOUND:"user-not-found"};class Fe extends De{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Fe({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Fe({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return O(e,"POST","/v1/accounts:signInWithPhoneNumber",j(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await O(e,"POST","/v1/accounts:signInWithPhoneNumber",j(e,t));if(n.temporaryProof)throw U(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return O(e,"POST","/v1/accounts:signInWithPhoneNumber",j(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Ue)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new Fe({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class ze{constructor(e){var t,n,r,i,s,o;const l=(0,a.I9)((0,a.hp)(e)),c=null!==(t=l.apiKey)&&void 0!==t?t:null,u=null!==(n=l.oobCode)&&void 0!==n?n:null,d=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=l.mode)&&void 0!==r?r:null);w(c&&u&&d,"argument-error"),this.apiKey=c,this.operation=d,this.code=u,this.continueUrl=null!==(i=l.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=l.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=l.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=(0,a.I9)((0,a.hp)(e)).link,n=t?(0,a.I9)((0,a.hp)(t)).deep_link_id:null,r=(0,a.I9)((0,a.hp)(e)).deep_link_id;return(r?(0,a.I9)((0,a.hp)(r)).link:null)||r||n||t||e}(e);try{return new ze(t)}catch(n){return null}}}class Ve{constructor(){this.providerId=Ve.PROVIDER_ID}static credential(e,t){return Re._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=ze.parseLink(t);return w(n,"argument-error"),Re._fromEmailAndCode(e,n.code,n.tenantId)}}Ve.PROVIDER_ID="password",Ve.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Ve.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Be{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Ge extends Be{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class qe extends Ge{constructor(){super("facebook.com")}static credential(e){return Le._fromParams({providerId:qe.PROVIDER_ID,signInMethod:qe.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qe.credentialFromTaggedObject(e)}static credentialFromError(e){return qe.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return qe.credential(t.oauthAccessToken)}catch(n){return null}}}qe.FACEBOOK_SIGN_IN_METHOD="facebook.com",qe.PROVIDER_ID="facebook.com";class We extends Ge{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Le._fromParams({providerId:We.PROVIDER_ID,signInMethod:We.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return We.credentialFromTaggedObject(e)}static credentialFromError(e){return We.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return We.credential(n,r)}catch(i){return null}}}We.GOOGLE_SIGN_IN_METHOD="google.com",We.PROVIDER_ID="google.com";class He extends Ge{constructor(){super("github.com")}static credential(e){return Le._fromParams({providerId:He.PROVIDER_ID,signInMethod:He.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return He.credentialFromTaggedObject(e)}static credentialFromError(e){return He.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return He.credential(t.oauthAccessToken)}catch(n){return null}}}He.GITHUB_SIGN_IN_METHOD="github.com",He.PROVIDER_ID="github.com";class Ke extends Ge{constructor(){super("twitter.com")}static credential(e,t){return Le._fromParams({providerId:Ke.PROVIDER_ID,signInMethod:Ke.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ke.credentialFromTaggedObject(e)}static credentialFromError(e){return Ke.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return Ke.credential(n,r)}catch(i){return null}}}async function Qe(e,t){return O(e,"POST","/v1/accounts:signUp",j(e,t))}Ke.TWITTER_SIGN_IN_METHOD="twitter.com",Ke.PROVIDER_ID="twitter.com";class Xe{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await ee._fromIdTokenResponse(e,n,r),s=Ye(n);return new Xe({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Ye(n);return new Xe({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Ye(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}async function $e(e){var t;if((0,s.xZ)(e.app))return Promise.reject(v(e));const n=xe(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new Xe({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await Qe(n,{returnSecureToken:!0}),i=await Xe._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}class Je extends a.g{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,Je.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new Je(e,t,n,r)}}function Ze(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if(n.code==="auth/".concat("multi-factor-auth-required"))throw Je._fromErrorAndOperation(e,n,t,r);throw n}))}async function et(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await K(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Xe._forOperation(e,"link",r)}async function tt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if((0,s.xZ)(r.app))return Promise.reject(v(r));const i="reauthenticate";try{const s=await K(e,Ze(r,i,t,e),n);w(s.idToken,r,"internal-error");const a=W(s.idToken);w(a,r,"internal-error");const{sub:o}=a;return w(e.uid===o,r,"user-mismatch"),Xe._forOperation(e,i,s)}catch(a){throw(null===a||void 0===a?void 0:a.code)==="auth/".concat("user-not-found")&&m(r,"user-mismatch"),a}}async function nt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,s.xZ)(e.app))return Promise.reject(v(e));const r="signIn",i=await Ze(e,r,t),a=await Xe._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(a.user),a}async function rt(e,t){if((0,s.xZ)(e.app))return Promise.reject(v(e));const n=xe(e),r=await async function(e,t){return O(e,"POST","/v1/accounts:signInWithCustomToken",j(e,t))}(n,{token:t,returnSecureToken:!0}),i=await Xe._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}new WeakMap;const it="__sak";class st{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(it,"1"),this.storage.removeItem(it),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class at extends st{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=ge(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);(0,a.lT)()&&10===document.documentMode&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}at.type="LOCAL";const ot=at;class lt extends st{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}lt.type="SESSION";const ct=lt;class ut{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new ut(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const a=Array.from(s).map((async e=>e(t.origin,i))),o=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(a);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function dt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}ut.receivers=[];class ht{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((a,o)=>{const l=dt("",20);r.port1.start();const c=setTimeout((()=>{o(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout((()=>{o(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),a(t.data.response);break;default:clearTimeout(c),clearTimeout(i),o(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function ft(){return window}function pt(){return"undefined"!==typeof ft().WorkerGlobalScope&&"function"===typeof ft().importScripts}const mt="firebaseLocalStorageDb",gt="firebaseLocalStorage",yt="fbase_key";class vt{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function bt(e,t){return e.transaction([gt],t?"readwrite":"readonly").objectStore(gt)}function wt(){const e=indexedDB.open(mt,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(gt,{keyPath:yt})}catch(r){n(r)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(gt)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(mt);return new vt(e).toPromise()}(),t(await wt()))}))}))}async function xt(e,t,n){const r=bt(e,!0).put({[yt]:t,value:n});return new vt(r).toPromise()}function _t(e,t){const n=bt(e,!0).delete(t);return new vt(n).toPromise()}class St{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await wt()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return pt()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ut._getInstance(pt()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new ht(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await wt();return await xt(e,it,"1"),await _t(e,it),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>xt(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=bt(e,!1).get(t),r=await new vt(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>_t(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=bt(e,!1).getAll();return new vt(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}St.type="LOCAL";const Et=St;ke("rcb"),new T(3e4,6e4);const kt="recaptcha";async function Tt(e,t,n){var r;const i=await n.verify();try{let s;if(w("string"===typeof i,e,"argument-error"),w(n.type===kt,e,"argument-error"),s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){w("enroll"===t.type,e,"internal-error");const n=await function(e,t){return D(e,"POST","/v2/accounts/mfaEnrollment:start",j(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{w("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;w(n,e,"missing-multi-factor-info");const a=await function(e,t){return D(e,"POST","/v2/accounts/mfaSignIn:start",j(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return a.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return D(e,"POST","/v1/accounts:sendVerificationCode",j(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}class It{constructor(e){this.providerId=It.PROVIDER_ID,this.auth=xe(e)}verifyPhoneNumber(e,t){return Tt(this.auth,e,(0,a.Ku)(t))}static credential(e,t){return Fe._fromVerification(e,t)}static credentialFromResult(e){const t=e;return It.credentialFromTaggedObject(t)}static credentialFromError(e){return It.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?Fe._fromTokenResponse(n,r):null}}function Nt(e,t){return t?ne(t):(w(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}It.PROVIDER_ID="phone",It.PHONE_SIGN_IN_METHOD="phone";class Ct extends De{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Me(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Me(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Me(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function At(e){return nt(e.auth,new Ct(e),e.bypassAuthState)}function jt(e){const{auth:t,user:n}=e;return w(n,t,"internal-error"),tt(n,new Ct(e),e.bypassAuthState)}async function Dt(e){const{auth:t,user:n}=e;return w(n,t,"internal-error"),et(n,new Ct(e),e.bypassAuthState)}class Pt{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:a}=e;if(s)return void this.reject(s);const o={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(a)(o))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return At;case"linkViaPopup":case"linkViaRedirect":return Dt;case"reauthViaPopup":case"reauthViaRedirect":return jt;default:m(this.auth,"internal-error")}}resolve(e){_(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){_(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Ot=new T(2e3,1e4);class Rt extends Pt{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Rt.currentPopupAction&&Rt.currentPopupAction.cancel(),Rt.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return w(e,this.auth,"internal-error"),e}async onExecution(){_(1===this.filter.length,"Popup operations only handle one event");const e=dt();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(g(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(g(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Rt.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(g(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,Ot.get())};e()}}Rt.currentPopupAction=null;const Mt=new Map;class Lt extends Pt{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=Mt.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=zt(t),r=Ft(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Mt.set(this.auth._key(),e)}return this.bypassAuthState||Mt.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Ut(e,t){Mt.set(e._key(),t)}function Ft(e){return ne(e._redirectPersistence)}function zt(e){return se("pendingRedirect",e.config.apiKey,e.name)}async function Vt(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if((0,s.xZ)(e.app))return Promise.reject(v(e));const r=xe(e),i=Nt(r,t),a=new Lt(r,i,n),o=await a.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class Bt{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return qt(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!qt(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(g(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(Gt(e))}saveEventToCache(e){this.cachedEventUids.add(Gt(e)),this.lastProcessedEventTime=Date.now()}}function Gt(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function qt(e){let{type:t,error:n}=e;return"unknown"===t&&(null===n||void 0===n?void 0:n.code)==="auth/".concat("no-auth-event")}const Wt=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ht=/^https?/;async function Kt(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return D(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const r of t)try{if(Qt(r))return}catch(n){}m(e,"unauthorized-domain")}function Qt(e){const t=S(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Ht.test(n))return!1;if(Wt.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Xt=new T(3e4,6e4);function Yt(){const e=ft().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function $t(e){return new Promise(((t,n)=>{var r,i,s;function a(){Yt(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Yt(),n(g(e,"network-request-failed"))},timeout:Xt.get()})}if(null===(i=null===(r=ft().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=ft().gapi)||void 0===s?void 0:s.load)){const t=ke("iframefcb");return ft()[t]=()=>{gapi.load?a():n(g(e,"network-request-failed"))},Ee("".concat(Se.gapiScript,"?onload=").concat(t)).catch((e=>n(e)))}a()}})).catch((e=>{throw Jt=null,e}))}let Jt=null;const Zt=new T(5e3,15e3),en={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},tn=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function nn(e){const t=e.config;w(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?I(t,"emulator/auth/iframe"):"https://".concat(e.config.authDomain,"/").concat("__/auth/iframe"),r={apiKey:t.apiKey,appName:e.name,v:s.MF},i=tn.get(e.config.apiHost);i&&(r.eid=i);const o=e._getFrameworks();return o.length&&(r.fw=o.join(",")),"".concat(n,"?").concat((0,a.Am)(r).slice(1))}async function rn(e){const t=await function(e){return Jt=Jt||$t(e),Jt}(e),n=ft().gapi;return w(n,e,"internal-error"),t.open({where:document.body,url:nn(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:en,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=g(e,"network-request-failed"),s=ft().setTimeout((()=>{r(i)}),Zt.get());function a(){ft().clearTimeout(s),n(t)}t.ping(a).then(a,(()=>{r(i)}))}))))}const sn={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class an{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function on(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},sn),{width:r.toString(),height:i.toString(),top:s,left:o}),u=(0,a.ZQ)().toLowerCase();n&&(l=ue(u)?"_blank":n),le(u)&&(t=t||"http://localhost",c.scrollbars="yes");const d=Object.entries(c).reduce(((e,t)=>{let[n,r]=t;return"".concat(e).concat(n,"=").concat(r,",")}),"");if(function(){var e;return me(arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,a.ZQ)())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(u)&&"_self"!==l)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",l),new an(null);const h=window.open(t||"",l,d);w(h,e,"popup-blocked");try{h.focus()}catch(f){}return new an(h)}const ln="__/auth/handler",cn="emulator/auth/handler",un=encodeURIComponent("fac");async function dn(e,t,n,r,i,o){w(e.config.authDomain,e,"auth-domain-config-required"),w(e.config.apiKey,e,"invalid-api-key");const l={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:s.MF,eventId:i};if(t instanceof Be){t.setDefaultLanguage(e.languageCode),l.providerId=t.providerId||"",(0,a.Im)(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(o||{}))l[e]=t}if(t instanceof Ge){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(l.scopes=e.join(","))}e.tenantId&&(l.tid=e.tenantId);const c=l;for(const s of Object.keys(c))void 0===c[s]&&delete c[s];const u=await e._getAppCheckToken(),d=u?"#".concat(un,"=").concat(encodeURIComponent(u)):"";return"".concat(function(e){let{config:t}=e;if(!t.emulator)return"https://".concat(t.authDomain,"/").concat(ln);return I(t,cn)}(e),"?").concat((0,a.Am)(c).slice(1)).concat(d)}const hn="webStorageSupport";const fn=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=ct,this._completeRedirectFn=Vt,this._overrideRedirectResult=Ut}async _openPopup(e,t,n,r){var i;_(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return on(e,await dn(e,t,n,S(),r),dt())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){ft().location.href=e}(await dn(e,t,n,S(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(_(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await rn(e),n=new Bt(e);return t.register("authEvent",(t=>{w(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(hn,{type:hn},(n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[hn];void 0!==i&&t(!!i),m(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Kt(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ge()||ce()||me()}};var pn="@firebase/auth",mn="1.7.9";class gn{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){w(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const yn=(0,a.XA)("authIdTokenMaxAge")||300;let vn=null;var bn;Se={loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=g("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},bn="Browser",(0,s.om)(new c.uA("auth",((e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:a,authDomain:o}=r.options;w(a&&!a.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:a,authDomain:o,clientPlatform:bn,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ye(bn)},c=new we(r,i,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ne);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(c,n),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),(0,s.om)(new c.uA("auth-internal",(e=>(e=>new gn(e))(xe(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,s.KO)(pn,mn,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(bn)),(0,s.KO)(pn,mn,"esm2017");var wn=n(472);(0,s.KO)("firebase","10.14.1","app");const xn={apiKey:"AIzaSyDELpL-KPlPpxAxondBu6WMPncmmtcZHs8",authDomain:"my-labyrinth-game.firebaseapp.com",projectId:"my-labyrinth-game",storageBucket:"my-labyrinth-game.firebasestorage.app",messagingSenderId:"387163715938",appId:"1:387163715938:web:5d1cc5f6b5075f41f2143b"},_n=(0,s.Wp)(xn),Sn=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:(0,s.Sx)();const t=(0,s.j6)(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=(0,s.j6)(e,"auth");if(n.isInitialized()){const e=n.getImmediate(),r=n.getOptions();if((0,a.bD)(r,null!==t&&void 0!==t?t:{}))return e;m(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:fn,persistence:[Et,ot,ct]}),r=(0,a.XA)("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>yn)return;const r=null===t||void 0===t?void 0:t.token;vn!==r&&(vn=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:"Bearer ".concat(r)}:{}}))});!function(e,t,n){(0,a.Ku)(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e,t,n,r){(0,a.Ku)(e).onIdTokenChanged(t,n,r)}(n,(e=>t(e)))}}var i;const o=(0,a.Tj)("auth");return o&&Ce(n,"http://".concat(o)),n}(_n),En=(0,wn.aU)(_n),kn=xn.appId;var Tn=n(555);function In(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}const Nn=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(((e,t,n)=>Boolean(e)&&n.indexOf(e)===t)).join(" ")};var Cn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const An=["color","size","strokeWidth","absoluteStrokeWidth","className","children","iconNode"],jn=(0,r.forwardRef)(((e,t)=>{let{color:n="currentColor",size:i=24,strokeWidth:s=2,absoluteStrokeWidth:a,className:o="",children:l,iconNode:c}=e,u=In(e,An);return(0,r.createElement)("svg",(0,Tn.A)((0,Tn.A)({ref:t},Cn),{},{width:i,height:i,stroke:n,strokeWidth:a?24*Number(s)/Number(i):s,className:Nn("lucide",o)},u),[...c.map((e=>{let[t,n]=e;return(0,r.createElement)(t,n)})),...Array.isArray(l)?l:[l]])})),Dn=["className"],Pn=(e,t)=>{const n=(0,r.forwardRef)(((n,i)=>{let{className:s}=n,a=In(n,Dn);return(0,r.createElement)(jn,(0,Tn.A)({ref:i,iconNode:t,className:Nn("lucide-".concat((o=e,o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),s)},a));var o}));return n.displayName="".concat(e),n},On=Pn("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Rn=Pn("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Mn=Pn("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Ln=Pn("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),Un=Pn("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Fn=6,zn=20,Vn=600,Bn=[{id:"COMP_FIRST_GOAL",text:"\u8ab0\u3088\u308a\u3082\u65e9\u304f1\u4f4d\u3067\u30b4\u30fc\u30eb\u3059\u308b (\u540c\u76df\u306a\u3057\u306e\u5834\u5408)",type:"competitive",points:20,gameEndCondition:!1,immediateCheckOnGoal:!0},{id:"COMP_TARGET_LAST",text:"\u7279\u5b9a\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u3092\u6700\u4e0b\u4f4d\u306b\u3059\u308b",type:"competitive",requiresTarget:!0,points:20,gameEndCondition:!0},{id:"COMP_SOLO_TOP3",text:"\u8ab0\u3068\u3082\u540c\u76df\u305b\u305a\u306b\u4e0a\u4f4d3\u4f4d\u4ee5\u5185\u3067\u30b4\u30fc\u30eb\u3059\u308b",type:"competitive",points:20,gameEndCondition:!0},{id:"COOP_ALLY_TOP2",text:"\u7279\u5b9a\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u3068\u540c\u76df\u3057\u3001\u5171\u306b\u4e0a\u4f4d2\u4f4d\u4ee5\u5185\u3067\u30b4\u30fc\u30eb\u3059\u308b",type:"cooperative",requiresTarget:!0,points:20,gameEndCondition:!0},{id:"COOP_LARGE_ALLIANCE",text:"3\u4eba\u4ee5\u4e0a\u306e\u540c\u76df\u3092\u6210\u7acb\u3055\u305b\u308b",type:"cooperative",points:20,immediateCheck:!0},{id:"SAB_OBSTRUCT_THRICE",text:"\u4ed6\u30d7\u30ec\u30a4\u30e4\u30fc\u306b3\u56de\u4ee5\u4e0a\u59a8\u5bb3\u3092\u6210\u529f\u3055\u305b\u308b",type:"sabotage",points:20,counterMax:3,immediateCheck:!0},{id:"SAB_BETRAY_AND_WIN",text:"\u540c\u76df\u3092\u88cf\u5207\u308a\u3001\u305d\u306e\u76f8\u624b\u3088\u308a\u4e0a\u4f4d\u3067\u30b4\u30fc\u30eb\u3059\u308b",type:"sabotage",requiresTarget:!0,points:15,gameEndCondition:!0}];function Gn(e){let t,n=e.length;for(;0!==n;)t=Math.floor(Math.random()*n),n--,[e[n],e[t]]=[e[t],e[n]];return e}const qn=e=>{const t=[];for(let n=0;n<e-1;n++)for(let r=0;r<e;r++)t.push({r:n,c:r,type:"horizontal",active:!1});for(let n=0;n<e;n++)for(let r=0;r<e-1;r++)t.push({r:n,c:r,type:"vertical",active:!1});return t},Wn=(e,t,n,r)=>{if(!e||!t)return!1;const i=[[e.r,e.c]],s=new Set(["".concat(e.r,"-").concat(e.c)]),a=[[0,1],[0,-1],[1,0],[-1,0]];for(;i.length>0;){const[e,o]=i.shift();if(e===t.r&&o===t.c)return!0;for(const[t,l]of a){const a=e+t,c=o+l;if(a>=0&&a<r&&c>=0&&c<r&&!s.has("".concat(a,"-").concat(c))){let r=!1;if(0===t){const t=Math.min(o,c);n.find((n=>"vertical"===n.type&&n.r===e&&n.c===t&&n.active))&&(r=!0)}else{const t=Math.min(e,a);n.find((e=>"horizontal"===e.type&&e.r===t&&e.c===o&&e.active))&&(r=!0)}r||(s.add("".concat(a,"-").concat(c)),i.push([a,c]))}}}return!1},Hn=e=>{if(null===e||e<0)return"--:--";const t=Math.floor(e/60),n=e%60;return"".concat(String(t).padStart(2,"0"),":").concat(String(n).padStart(2,"0"))},Kn=()=>localStorage.getItem("labyrinth_username")||"",Qn=e=>e&&e.trim().length>0&&e.trim().length<=20;var Xn=n(579);const Yn=e=>{let{page:t=1,onClose:n}=e;const r=async e=>{try{await navigator.clipboard.writeText(e),console.log("\u30c6\u30ad\u30b9\u30c8\u3092\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f:",e)}catch(t){console.error("\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u3078\u306e\u30b3\u30d4\u30fc\u306b\u5931\u6557\u3057\u307e\u3057\u305f:",t);const n=document.createElement("textarea");n.value=e,document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n)}};return(0,Xn.jsx)("div",{className:"help-overlay",children:(0,Xn.jsxs)("div",{className:"help-overlay-content",children:[(0,Xn.jsx)("button",{className:"help-close-btn",onClick:n,children:"\xd7"}),1===t?(0,Xn.jsxs)("div",{className:"help-content",children:[(0,Xn.jsx)("h2",{children:"\ud83c\udfae \u30e9\u30d3\u30ea\u30f3\u30b9 - \u904a\u3073\u65b9\u30ac\u30a4\u30c9"}),(0,Xn.jsx)("p",{className:"help-description",children:"\u898b\u3048\u306a\u3044\u58c1\u306e\u8ff7\u8def\u3067\u76f8\u624b\u306e\u601d\u8003\u3092\u8aad\u307f\u5408\u3046\u5fc3\u7406\u6226\u30b2\u30fc\u30e0\u3067\u3059\u3002"}),(0,Xn.jsxs)("div",{className:"help-sections",children:[(0,Xn.jsxs)("div",{className:"help-section",children:[(0,Xn.jsx)("h3",{children:"\ud83c\udfaf \u30b2\u30fc\u30e0\u306e\u76ee\u7684"}),(0,Xn.jsx)("p",{children:"\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u304c\u4f5c\u3063\u305f\u300c\u898b\u3048\u306a\u3044\u58c1\u300d\u306e\u8ff7\u8def\u3092\u653b\u7565\u3057\u3066\u3001\u30b4\u30fc\u30eb\u3092\u76ee\u6307\u3057\u307e\u3059\u3002\u58c1\u306e\u4f4d\u7f6e\u306f\u898b\u3048\u306a\u3044\u305f\u3081\u3001\u79fb\u52d5\u3057\u306a\u304c\u3089\u58c1\u306e\u914d\u7f6e\u3092\u63a8\u7406\u3057\u3066\u3044\u304f\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002"})]}),(0,Xn.jsxs)("div",{className:"help-section",children:[(0,Xn.jsx)("h3",{children:"\ud83d\udccb \u57fa\u672c\u30eb\u30fc\u30eb"}),(0,Xn.jsxs)("ul",{children:[(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"\u30de\u30c3\u30d7:"})," 6\xd76\u306e\u30de\u30b9\uff0836\u30de\u30b9\uff09\u3067\u69cb\u6210"]}),(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"\u58c1:"})," \u5404\u30de\u30b9\u306e\u9593\u306b20\u672c\u306e\u58c1\u304c\u8a2d\u7f6e\u3055\u308c\u3066\u3044\u308b"]}),(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"\u79fb\u52d5:"})," \u4e0a\u4e0b\u5de6\u53f3\u306b1\u30de\u30b9\u305a\u3064\u79fb\u52d5\u53ef\u80fd"]}),(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"\u58c1\u5224\u5b9a:"})," \u79fb\u52d5\u5148\u306b\u58c1\u304c\u3042\u308b\u5834\u5408\u306f\u79fb\u52d5\u5931\u6557\u3001\u58c1\u304c\u8868\u793a\u3055\u308c\u308b"]}),(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"\u9023\u7d9a\u79fb\u52d5:"})," \u58c1\u306b\u3076\u3064\u304b\u308b\u307e\u3067\u9023\u7d9a\u3067\u79fb\u52d5\u3067\u304d\u308b"]}),(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"\u30b4\u30fc\u30eb:"})," \u30b4\u30fc\u30eb\u30de\u30b9\u306b\u5230\u9054\u3059\u308c\u3070\u52dd\u5229"]})]})]}),(0,Xn.jsxs)("div",{className:"help-section",children:[(0,Xn.jsx)("h3",{children:"\ud83c\udfc3\u200d\u2642\ufe0f \u30b9\u30bf\u30f3\u30c0\u30fc\u30c9\u30e2\u30fc\u30c9\uff082\u4eba\u5bfe\u6226\uff09"}),(0,Xn.jsxs)("div",{className:"mode-details",children:[(0,Xn.jsx)("h4",{children:"\ud83d\udcdd \u6e96\u5099\u30d5\u30a7\u30fc\u30ba"}),(0,Xn.jsxs)("ul",{children:[(0,Xn.jsx)("li",{children:"\u5404\u30d7\u30ec\u30a4\u30e4\u30fc\u304c6\xd76\u30de\u30b9\u306e\u8ff7\u8def\u3092\u4f5c\u6210"}),(0,Xn.jsx)("li",{children:"20\u672c\u306e\u58c1\u3001\u30b9\u30bf\u30fc\u30c8\u4f4d\u7f6e\u3001\u30b4\u30fc\u30eb\u4f4d\u7f6e\u3092\u8a2d\u5b9a"}),(0,Xn.jsx)("li",{children:"\u76f8\u624b\u306e\u8ff7\u8def\u3092\u653b\u7565\u3057\u3001\u81ea\u5206\u306e\u8ff7\u8def\u306f\u76f8\u624b\u304c\u653b\u7565"})]}),(0,Xn.jsx)("h4",{children:"\ud83c\udfb2 \u30b2\u30fc\u30e0\u9032\u884c"}),(0,Xn.jsxs)("ul",{children:[(0,Xn.jsx)("li",{children:"\u30e9\u30f3\u30c0\u30e0\u3067\u9806\u756a\u3092\u6c7a\u5b9a\u3057\u3001\u4ea4\u4e92\u306b\u30bf\u30fc\u30f3\u3092\u9032\u884c"}),(0,Xn.jsx)("li",{children:"\u76f8\u624b\u306e\u4f4d\u7f6e\u304c\u5e38\u306b\u898b\u3048\u308b\uff08\u5fc3\u7406\u6226\u306e\u8981\u7d20\uff09"}),(0,Xn.jsx)("li",{children:"\u58c1\u306b\u3076\u3064\u304b\u308b\u3068\u30bf\u30fc\u30f3\u7d42\u4e86"}),(0,Xn.jsx)("li",{children:"\u3069\u3061\u3089\u304b\u304c\u30b4\u30fc\u30eb\u3057\u305f\u6642\u70b9\u3067\u30b2\u30fc\u30e0\u7d42\u4e86"})]}),(0,Xn.jsx)("h4",{children:"\ud83c\udfaf \u52dd\u5229\u6761\u4ef6"}),(0,Xn.jsx)("p",{children:"\u5148\u306b\u30b4\u30fc\u30eb\u306b\u5230\u9054\u3057\u305f\u30d7\u30ec\u30a4\u30e4\u30fc\u306e\u52dd\u5229"})]})]}),(0,Xn.jsxs)("div",{className:"help-section",children:[(0,Xn.jsx)("h3",{children:"\u2694\ufe0f \u30a8\u30af\u30b9\u30c8\u30e9\u30e2\u30fc\u30c9\uff084\u4eba\u5bfe\u6226\uff09"}),(0,Xn.jsxs)("div",{className:"mode-details",children:[(0,Xn.jsx)("h4",{children:"\ud83d\udcdd \u6e96\u5099\u30d5\u30a7\u30fc\u30ba"}),(0,Xn.jsxs)("ul",{children:[(0,Xn.jsx)("li",{children:"4\u4eba\u305d\u308c\u305e\u308c\u304c\u8ff7\u8def\u3092\u4f5c\u6210\uff08\u8a084\u3064\u306e\u8ff7\u8def\uff09"}),(0,Xn.jsx)("li",{children:"\u8ff7\u8def\u306f\u30e9\u30f3\u30c0\u30e0\u306b\u30b7\u30e3\u30c3\u30d5\u30eb\u3057\u3066\u914d\u5e03"}),(0,Xn.jsx)("li",{children:"\u81ea\u5206\u304c\u4f5c\u3063\u305f\u8ff7\u8def\u306f\u81ea\u5206\u3067\u306f\u653b\u7565\u3057\u306a\u3044"})]}),(0,Xn.jsx)("h4",{children:"\ud83c\udfb2 \u30b2\u30fc\u30e0\u9032\u884c"}),(0,Xn.jsxs)("ul",{children:[(0,Xn.jsx)("li",{children:"\u5ba3\u8a00\u30d5\u30a7\u30fc\u30ba: \u30a2\u30af\u30b7\u30e7\u30f3\u3092\u9078\u629e\u30fb\u5ba3\u8a00"}),(0,Xn.jsx)("li",{children:"\u5b9f\u884c\u30d5\u30a7\u30fc\u30ba: \u5ba3\u8a00\u3055\u308c\u305f\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u5b9f\u884c"}),(0,Xn.jsx)("li",{children:"\u4ed6\u30d7\u30ec\u30a4\u30e4\u30fc\u306e\u4f4d\u7f6e\u306f\u57fa\u672c\u7684\u306b\u898b\u3048\u306a\u3044"}),(0,Xn.jsx)("li",{children:"\u81ea\u5206\u304c\u4f5c\u3063\u305f\u8ff7\u8def\u3092\u30d7\u30ec\u30a4\u3057\u3066\u3044\u308b\u4eba\u306e\u4f4d\u7f6e\u306e\u307f\u898b\u3048\u308b"})]}),(0,Xn.jsx)("h4",{children:"\ud83d\udcb0 \u30dd\u30a4\u30f3\u30c8\u30b7\u30b9\u30c6\u30e0"}),(0,Xn.jsxs)("ul",{children:[(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"\u79fb\u52d5\u30dd\u30a4\u30f3\u30c8:"})," \u672a\u63a2\u7d22\u30de\u30b9\u306b\u5165\u308b\u3068 +1pt"]}),(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"\u30d0\u30c8\u30eb\u52dd\u5229:"})," \u30d0\u30c8\u30eb\u306b\u52dd\u3064\u3068 +5pt"]}),(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"\u30b4\u30fc\u30eb\u9806\u4f4d:"})," 1\u4f4d:20pt / 2\u4f4d:15pt / 3\u4f4d:10pt / 4\u4f4d:0pt"]})]}),(0,Xn.jsx)("h4",{children:"\u2694\ufe0f \u30d0\u30c8\u30eb\u30b7\u30b9\u30c6\u30e0"}),(0,Xn.jsxs)("ul",{children:[(0,Xn.jsx)("li",{children:"\u540c\u3058\u30de\u30b9\u306b\u8907\u6570\u30d7\u30ec\u30a4\u30e4\u30fc\u304c\u6b62\u307e\u308b\u3068\u30d0\u30c8\u30eb\u767a\u751f"}),(0,Xn.jsx)("li",{children:"\u304a\u4e92\u3044\u30dd\u30a4\u30f3\u30c8\u3092\u8ced\u3051\u3066\u3001\u591a\u304f\u8ced\u3051\u305f\u65b9\u304c\u52dd\u5229"}),(0,Xn.jsx)("li",{children:"\u6557\u8005\u306f\u6b21\u306e\u30bf\u30fc\u30f3\u3092\u4f11\u307f"}),(0,Xn.jsx)("li",{children:"\u540c\u3058\u76f8\u624b\u3068\u306f1\u56de\u3057\u304b\u30d0\u30c8\u30eb\u3067\u304d\u306a\u3044"})]}),(0,Xn.jsx)("h4",{children:"\ud83c\udfaf \u52dd\u5229\u6761\u4ef6"}),(0,Xn.jsx)("p",{children:"3\u4eba\u304c\u30b4\u30fc\u30eb\u3057\u305f\u6642\u70b9\u3067\u30b2\u30fc\u30e0\u7d42\u4e86\u3002\u7dcf\u30dd\u30a4\u30f3\u30c8\u304c\u6700\u3082\u9ad8\u3044\u30d7\u30ec\u30a4\u30e4\u30fc\u306e\u52dd\u5229"})]})]}),(0,Xn.jsxs)("div",{className:"help-section",children:[(0,Xn.jsx)("h3",{children:"\ud83c\udfae \u64cd\u4f5c\u65b9\u6cd5"}),(0,Xn.jsxs)("ul",{children:[(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"\u79fb\u52d5:"})," \u753b\u9762\u306e\u77e2\u5370\u30dc\u30bf\u30f3 \u307e\u305f\u306f \u30ad\u30fc\u30dc\u30fc\u30c9\u306e\u77e2\u5370\u30ad\u30fc/WASD"]}),(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"\u30bb\u30eb\u9078\u629e:"})," \u8ff7\u8def\u306e\u30de\u30b9\u3092\u76f4\u63a5\u30af\u30ea\u30c3\u30af\uff08\u96a3\u63a5\u30bb\u30eb\u306e\u307f\uff09"]}),(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"\u30c1\u30e3\u30c3\u30c8:"})," Open Chat\uff08\u5168\u54e1\uff09\u3068Closed Chat\uff08\u81ea\u5206\u306e\u307f\uff09\u3092\u6d3b\u7528"]}),(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"\u30a2\u30af\u30b7\u30e7\u30f3:"})," \u30a8\u30af\u30b9\u30c8\u30e9\u30e2\u30fc\u30c9\u3067\u306f\u79fb\u52d5\u30fb\u5075\u5bdf\u30fb\u59a8\u5bb3\u30fb\u4ea4\u6e09\u30fb\u5f85\u6a5f\u304b\u3089\u9078\u629e"]})]})]}),(0,Xn.jsxs)("div",{className:"help-section",children:[(0,Xn.jsx)("h3",{children:"\ud83d\udca1 \u6226\u7565\u306e\u30d2\u30f3\u30c8"}),(0,Xn.jsxs)("ul",{children:[(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"\u5fc3\u7406\u6226:"})," \u30c1\u30e3\u30c3\u30c8\u3067\u76f8\u624b\u3092\u8aa4\u8a98\u5c0e\u3057\u305f\u308a\u3001\u5354\u529b\u3092\u6301\u3061\u304b\u3051\u305f\u308a\u3057\u3088\u3046"]}),(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"\u58c1\u306e\u8a18\u61b6:"})," \u4e00\u5ea6\u3076\u3064\u304b\u3063\u305f\u58c1\u306e\u4f4d\u7f6e\u3092\u899a\u3048\u3066\u304a\u3053\u3046"]}),(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"\u76f8\u624b\u89b3\u5bdf:"})," \u76f8\u624b\u306e\u52d5\u304d\u304b\u3089\u8ff7\u8def\u306e\u69cb\u9020\u3092\u63a8\u7406\u3057\u3088\u3046"]}),(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"\u30ea\u30b9\u30af\u7ba1\u7406:"})," \u30d0\u30c8\u30eb\u3067\u306f\u9069\u5207\u306a\u8ced\u3051\u30dd\u30a4\u30f3\u30c8\u3092\u9078\u629e\u3057\u3088\u3046"]}),(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"\u60c5\u5831\u6226:"})," \u771f\u5b9f\u3068\u5618\u3092\u4f7f\u3044\u5206\u3051\u3066\u76f8\u624b\u3092\u7ffb\u5f04\u3057\u3088\u3046"]})]})]}),(0,Xn.jsxs)("div",{className:"help-section",children:[(0,Xn.jsx)("h3",{children:"\ud83d\udd27 \u30c1\u30e3\u30c3\u30c8\u6a5f\u80fd"}),(0,Xn.jsxs)("ul",{children:[(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"Open Chat:"})," \u5168\u30d7\u30ec\u30a4\u30e4\u30fc\u306b\u898b\u3048\u308b\u516c\u958b\u30c1\u30e3\u30c3\u30c8"]}),(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"Closed Chat:"})," \u81ea\u5206\u3060\u3051\u306b\u898b\u3048\u308b\u975e\u516c\u958b\u30c1\u30e3\u30c3\u30c8\uff08\u5b9f\u969b\u306e\u884c\u52d5\u5165\u529b\u7528\uff09"]}),(0,Xn.jsxs)("li",{children:[(0,Xn.jsx)("strong",{children:"\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8:"})," \u3088\u304f\u4f7f\u3046\u767a\u8a00\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u96c6\u3082\u6d3b\u7528\u53ef\u80fd"]})]})]})]})]}):(0,Xn.jsxs)("div",{className:"help-content",children:[(0,Xn.jsx)("h2",{children:"\u30c1\u30e3\u30c3\u30c8\u767a\u8a00\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u96c6"}),(0,Xn.jsx)("p",{className:"help-description",children:"\u5bfe\u6226\u4e2d\u306e\u30c1\u30e3\u30c3\u30c8\u3067\u4f7f\u3048\u308b\u767a\u8a00\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3067\u3059\u3002\u30af\u30ea\u30c3\u30af\u3057\u3066\u30b3\u30d4\u30fc\u3067\u304d\u307e\u3059\u3002"}),(0,Xn.jsxs)("div",{className:"template-sections",children:[(0,Xn.jsxs)("div",{className:"template-section",children:[(0,Xn.jsx)("h3",{children:"\ud83e\udd1d \u5354\u529b\u30fb\u9023\u643a"}),(0,Xn.jsxs)("ul",{children:[(0,Xn.jsx)("li",{onClick:()=>r("\u4e00\u7dd2\u306b\u9032\u307f\u307e\u305b\u3093\u304b\uff1f"),children:"\u300c\u4e00\u7dd2\u306b\u9032\u307f\u307e\u305b\u3093\u304b\uff1f\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u5354\u529b\u3057\u3066\u7a81\u7834\u3057\u307e\u3057\u3087\u3046\uff01"),children:"\u300c\u5354\u529b\u3057\u3066\u7a81\u7834\u3057\u307e\u3057\u3087\u3046\uff01\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u30c1\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u9811\u5f35\u308a\u307e\u3057\u3087\u3046"),children:"\u300c\u30c1\u30fc\u30e0\u30ef\u30fc\u30af\u3067\u9811\u5f35\u308a\u307e\u3057\u3087\u3046\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u307f\u3093\u306a\u3067\u529b\u3092\u5408\u308f\u305b\u3088\u3046"),children:"\u300c\u307f\u3093\u306a\u3067\u529b\u3092\u5408\u308f\u305b\u3088\u3046\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u540c\u76df\u3092\u7d44\u307f\u307e\u3057\u3087\u3046"),children:"\u300c\u540c\u76df\u3092\u7d44\u307f\u307e\u3057\u3087\u3046\u300d"})]})]}),(0,Xn.jsxs)("div",{className:"template-section",children:[(0,Xn.jsx)("h3",{children:"\u2753 \u8cea\u554f\u30fb\u76f8\u8ac7"}),(0,Xn.jsxs)("ul",{children:[(0,Xn.jsx)("li",{onClick:()=>r("\u3069\u3053\u306b\u9032\u3080\u4e88\u5b9a\u3067\u3059\u304b\uff1f"),children:"\u300c\u3069\u3053\u306b\u9032\u3080\u4e88\u5b9a\u3067\u3059\u304b\uff1f\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u3053\u306e\u58c1\u306f\u8ab0\u304c\u7f6e\u304d\u307e\u3057\u305f\u304b\uff1f"),children:"\u300c\u3053\u306e\u58c1\u306f\u8ab0\u304c\u7f6e\u304d\u307e\u3057\u305f\u304b\uff1f\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u30b4\u30fc\u30eb\u307e\u3067\u306e\u9053\u306f\u898b\u3064\u304b\u308a\u307e\u3057\u305f\u304b\uff1f"),children:"\u300c\u30b4\u30fc\u30eb\u307e\u3067\u306e\u9053\u306f\u898b\u3064\u304b\u308a\u307e\u3057\u305f\u304b\uff1f\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u4eca\u306e\u72b6\u6cc1\u3092\u6559\u3048\u3066\u304f\u3060\u3055\u3044"),children:"\u300c\u4eca\u306e\u72b6\u6cc1\u3092\u6559\u3048\u3066\u304f\u3060\u3055\u3044\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u30d2\u30f3\u30c8\u304c\u6b32\u3057\u3044\u3067\u3059"),children:"\u300c\u30d2\u30f3\u30c8\u304c\u6b32\u3057\u3044\u3067\u3059\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u3069\u3061\u3089\u306e\u65b9\u5411\u304c\u3044\u3044\u3068\u601d\u3044\u307e\u3059\u304b\uff1f"),children:"\u300c\u3069\u3061\u3089\u306e\u65b9\u5411\u304c\u3044\u3044\u3068\u601d\u3044\u307e\u3059\u304b\uff1f\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u6226\u7565\u3092\u76f8\u8ac7\u3057\u307e\u305b\u3093\u304b\uff1f"),children:"\u300c\u6226\u7565\u3092\u76f8\u8ac7\u3057\u307e\u305b\u3093\u304b\uff1f\u300d"})]})]}),(0,Xn.jsxs)("div",{className:"template-section",children:[(0,Xn.jsx)("h3",{children:"\ud83d\udce2 \u60c5\u5831\u5171\u6709"}),(0,Xn.jsxs)("ul",{children:[(0,Xn.jsx)("li",{onClick:()=>r("\u3053\u306e\u9053\u306f\u884c\u304d\u6b62\u307e\u308a\u3067\u3059"),children:"\u300c\u3053\u306e\u9053\u306f\u884c\u304d\u6b62\u307e\u308a\u3067\u3059\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u3053\u3053\u304b\u3089\u9032\u3081\u305d\u3046\u3067\u3059"),children:"\u300c\u3053\u3053\u304b\u3089\u9032\u3081\u305d\u3046\u3067\u3059\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u58c1\u3092\u7f6e\u304d\u307e\u3057\u305f"),children:"\u300c\u58c1\u3092\u7f6e\u304d\u307e\u3057\u305f\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u30b4\u30fc\u30eb\u304c\u898b\u3048\u307e\u3057\u305f\uff01"),children:"\u300c\u30b4\u30fc\u30eb\u304c\u898b\u3048\u307e\u3057\u305f\uff01\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u6ce8\u610f\uff1a\u3053\u306e\u5148\u306f\u5371\u967a\u304b\u3082"),children:"\u300c\u6ce8\u610f\uff1a\u3053\u306e\u5148\u306f\u5371\u967a\u304b\u3082\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u30c8\u30e9\u30c3\u30d7\u3092\u767a\u898b\u3057\u307e\u3057\u305f"),children:"\u300c\u30c8\u30e9\u30c3\u30d7\u3092\u767a\u898b\u3057\u307e\u3057\u305f\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u91cd\u8981\u306a\u60c5\u5831\u304c\u3042\u308a\u307e\u3059"),children:"\u300c\u91cd\u8981\u306a\u60c5\u5831\u304c\u3042\u308a\u307e\u3059\u300d"})]})]}),(0,Xn.jsxs)("div",{className:"template-section",children:[(0,Xn.jsx)("h3",{children:"\u2694\ufe0f \u7af6\u4e89\u30fb\u5bfe\u6297"}),(0,Xn.jsxs)("ul",{children:[(0,Xn.jsx)("li",{onClick:()=>r("\u8ca0\u3051\u307e\u305b\u3093\u3088\uff01"),children:"\u300c\u8ca0\u3051\u307e\u305b\u3093\u3088\uff01\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u8ffd\u3044\u3064\u3044\u3066\u307f\u305b\u307e\u3059"),children:"\u300c\u8ffd\u3044\u3064\u3044\u3066\u307f\u305b\u307e\u3059\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u4eca\u5ea6\u306f\u963b\u6b62\u3057\u307e\u3059"),children:"\u300c\u4eca\u5ea6\u306f\u963b\u6b62\u3057\u307e\u3059\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u6226\u7565\u3092\u5909\u66f4\u3057\u307e\u3059"),children:"\u300c\u6226\u7565\u3092\u5909\u66f4\u3057\u307e\u3059\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u624b\u5f37\u3044\u76f8\u624b\u3067\u3059\u306d"),children:"\u300c\u624b\u5f37\u3044\u76f8\u624b\u3067\u3059\u306d\u300d"})]})]}),(0,Xn.jsxs)("div",{className:"template-section",children:[(0,Xn.jsx)("h3",{children:"\ud83d\udc4f \u5fdc\u63f4\u30fb\u611f\u8b1d"}),(0,Xn.jsxs)("ul",{children:[(0,Xn.jsx)("li",{onClick:()=>r("\u30ca\u30a4\u30b9\u30d7\u30ec\u30a4\uff01"),children:"\u300c\u30ca\u30a4\u30b9\u30d7\u30ec\u30a4\uff01\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059"),children:"\u300c\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u3059\u3054\u3044\u3067\u3059\u306d\uff01"),children:"\u300c\u3059\u3054\u3044\u3067\u3059\u306d\uff01\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f"),children:"\u300c\u304a\u75b2\u308c\u69d8\u3067\u3057\u305f\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u697d\u3057\u304b\u3063\u305f\u3067\u3059"),children:"\u300c\u697d\u3057\u304b\u3063\u305f\u3067\u3059\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u7d20\u6674\u3089\u3057\u3044\u6226\u7565\u3067\u3057\u305f"),children:"\u300c\u7d20\u6674\u3089\u3057\u3044\u6226\u7565\u3067\u3057\u305f\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u307e\u305f\u3088\u308d\u3057\u304f\u304a\u9858\u3044\u3057\u307e\u3059"),children:"\u300c\u307e\u305f\u3088\u308d\u3057\u304f\u304a\u9858\u3044\u3057\u307e\u3059\u300d"})]})]}),(0,Xn.jsxs)("div",{className:"template-section",children:[(0,Xn.jsx)("h3",{children:"\ud83c\udfaf \u30a8\u30af\u30b9\u30c8\u30e9\u30e2\u30fc\u30c9\u5c02\u7528"}),(0,Xn.jsxs)("ul",{children:[(0,Xn.jsx)("li",{onClick:()=>r("\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u5ba3\u8a00\u3057\u307e\u3059"),children:"\u300c\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u5ba3\u8a00\u3057\u307e\u3059\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u5075\u5bdf\u7d50\u679c\u3092\u5171\u6709\u3057\u307e\u3059"),children:"\u300c\u5075\u5bdf\u7d50\u679c\u3092\u5171\u6709\u3057\u307e\u3059\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u540c\u76df\u306e\u63d0\u6848\u304c\u3042\u308a\u307e\u3059"),children:"\u300c\u540c\u76df\u306e\u63d0\u6848\u304c\u3042\u308a\u307e\u3059\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u4ea4\u6e09\u3057\u307e\u305b\u3093\u304b\uff1f"),children:"\u300c\u4ea4\u6e09\u3057\u307e\u305b\u3093\u304b\uff1f\u300d"}),(0,Xn.jsx)("li",{onClick:()=>r("\u79d8\u5bc6\u76ee\u6a19\u3092\u9054\u6210\u3057\u307e\u3057\u305f"),children:"\u300c\u79d8\u5bc6\u76ee\u6a19\u3092\u9054\u6210\u3057\u307e\u3057\u305f\u300d"})]})]})]}),(0,Xn.jsx)("div",{className:"copy-hint",children:(0,Xn.jsx)("p",{className:"text-sm text-gray-600",children:"\ud83d\udca1 \u5404\u767a\u8a00\u3092\u30af\u30ea\u30c3\u30af\u3059\u308b\u3068\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3055\u308c\u307e\u3059"})})]}),(0,Xn.jsx)("div",{className:"help-footer",children:(0,Xn.jsx)("button",{className:"help-close-button",onClick:n,children:"\u9589\u3058\u308b"})})]})})},$n=e=>{let{setGameMode:t,setScreen:n,userId:i,debugMode:s,isOnline:a}=e;const[o,l]=(0,r.useState)(""),[c,u]=(0,r.useState)(!1),[d,h]=(0,r.useState)(!1),[f,p]=(0,r.useState)(1);(0,r.useEffect)((()=>{const e=Kn();e?l(e):u(!0)}),[]);const m=()=>{Qn(o)?((e=>{localStorage.setItem("labyrinth_username",e)})(o.trim()),u(!1),g("\u30e6\u30fc\u30b6\u30fc\u30cd\u30fc\u30e0\u3092\u4fdd\u5b58\u3057\u307e\u3057\u305f\uff01","success")):g("\u30e6\u30fc\u30b6\u30fc\u30cd\u30fc\u30e0\u306f1-20\u6587\u5b57\u3067\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044\u3002","error")},g=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info";const n=document.getElementById("notification-area");if(n){n.innerHTML=e;const r="success"===t?"bg-green-500":"error"===t?"bg-red-500":"bg-blue-500";n.className="fixed top-5 right-5 ".concat(r," text-white p-3 rounded-md shadow-lg z-50 text-sm"),setTimeout((()=>{n.className+=" hidden"}),3e3)}},y=async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"standard";if(console.log("\ud83c\udfaf [DEBUG] Mode selected:",{mode:e,gameType:r,userId:i,debugMode:s}),console.log("\ud83e\uddf9 [Cleanup] Clearing old game data from localStorage"),localStorage.removeItem("labyrinthGameId"),localStorage.removeItem("labyrinthGameType"),!o||!Qn(o))return u(!0),void g("\u30b2\u30fc\u30e0\u3092\u958b\u59cb\u3059\u308b\u306b\u306f\u30e6\u30fc\u30b6\u30fc\u30cd\u30fc\u30e0\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002","error");if(!i)return console.error("\u274c [DEBUG] No userId available"),void g("\u30e6\u30fc\u30b6\u30fcID\u304c\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u30da\u30fc\u30b8\u3092\u30ea\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\u3002","error");t(e);const a=(0,wn.rJ)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"));let l=null;const c="2player"===e?2:4;console.log("\ud83d\udd0d [DEBUG] Searching for existing games:",{mode:e,gameType:r,requiredPlayerCount:c});try{console.log("\ud83e\uddf9 [Cleanup] Searching for old/invalid games to clean up");const e=(0,wn.P)(a,(0,wn._M)("status","in",["waiting","creating"])),t=await(0,wn.GG)(e),n=new Date,r=new Date(n.getTime()-36e5);for(const s of t.docs){var d;const e=s.data(),t=null===(d=e.createdAt)||void 0===d?void 0:d.toDate(),n=!t||t<r||e.players&&e.players.filter((e=>e===i)).length>1;n&&(console.log("\ud83d\uddd1\ufe0f [Cleanup] Deleting old/invalid game:",s.id),await(0,wn.updateDoc)((0,wn.doc)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),s.id),{status:"abandoned",abandonedAt:(0,wn.serverTimestamp)(),abandonReason:"Automatic cleanup - old or invalid game"}))}}catch(p){console.error("\u274c [Cleanup] Error during cleanup:",p)}if(s)console.log("\ud83d\udd27 [DEBUG] Debug mode: Skipping existing games, creating new one");else{const t=(0,wn.P)(a,(0,wn._M)("mode","==",e),(0,wn._M)("gameType","==","standard"),(0,wn._M)("status","==","waiting")),n=await(0,wn.GG)(t);if(console.log("\ud83d\udd0d [DEBUG] Found",n.size,"waiting games"),!n.empty)for(const e of n.docs){var h,f;const t=e.data();console.log("\ud83d\udd0d [DEBUG] Checking game:",{id:e.id,players:t.players,playerCount:t.players.length,includesCurrentUser:t.players.includes(i),createdAt:null===(h=t.createdAt)||void 0===h?void 0:h.toDate()});const n=null===(f=t.createdAt)||void 0===f?void 0:f.toDate(),r=!n||new Date-n<36e5;if(t.players.length<c&&!t.players.includes(i)&&r&&t.players.length>0){l=e.id,console.log("\u2705 [DEBUG] Joining existing game:",l),await(0,wn.updateDoc)((0,wn.doc)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),l),{players:(0,wn.hq)(i),status:t.players.length+1===c?"creating":"waiting",lastUpdated:(0,wn.serverTimestamp)(),joinedAt:(0,wn.serverTimestamp)(),["playerNames.".concat(i)]:o}),console.log("\u2705 [DEBUG] Successfully joined game. New status:",t.players.length+1===c?"creating":"waiting"),setTimeout((async()=>{try{const e=await(0,wn.getDoc)((0,wn.doc)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),l));if(e.exists()){const t=e.data();console.log("\ud83d\udd0d [DEBUG] Game state after join:",{id:l,players:t.players,playerCount:t.players.length,status:t.status,currentUserIncluded:t.players.includes(i)})}}catch(p){console.error("\u274c [DEBUG] Error verifying game state after join:",p)}}),1e3);break}}}if(!l){console.log("\ud83c\udd95 [DEBUG] Creating new game");try{let t,n;s?"4player"===e?(t=[i,"debug_player_2_".concat(Date.now()),"debug_player_3_".concat(Date.now()),"debug_player_4_".concat(Date.now())],n="creating"):"2player"===e?(t=[i,"debug_player_2_".concat(Date.now())],n="creating"):(t=[i],n="waiting"):(t=[i],n="waiting");const r={};s?(r[i]=o,t.forEach(((e,t)=>{e!==i&&e.startsWith("debug_player")&&(r[e]="\u30c7\u30d0\u30c3\u30b0\u30d7\u30ec\u30a4\u30e4\u30fc".concat(t+1))}))):r[i]=o;const c={mode:e,gameType:"standard",status:n,players:t,hostId:i,createdAt:(0,wn.serverTimestamp)(),lastUpdated:(0,wn.serverTimestamp)(),currentTurnPlayerId:null,turnOrder:[],mazes:{},playerStates:{},goalCount:0,playerGoalOrder:[],activeBattle:null,chatMessagesLastFetch:null,playerNames:r,debugMode:s,version:Date.now()};console.log("\ud83c\udd95 [DEBUG] New game data:",c);const u=await(0,wn.gS)(a,c);l=u.id,console.log("\u2705 [DEBUG] Successfully created new game:",l)}catch(p){return console.error("\u274c [DEBUG] Error creating game:",p),void g("\u30b2\u30fc\u30e0\u306e\u4f5c\u6210\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002","error")}}console.log("\ud83d\udcbe [DEBUG] Storing game info in localStorage:",{gameIdToJoin:l,gameType:"standard"}),localStorage.setItem("labyrinthGameId",l),localStorage.setItem("labyrinthGameType","standard"),console.log("\ud83d\ude80 [DEBUG] Redirecting to course creation"),n("courseCreation")};return(0,Xn.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gradient-to-br from-slate-900 to-slate-700 text-white p-4",children:[(0,Xn.jsx)("div",{id:"notification-area",className:"fixed top-5 right-5 bg-red-500 text-white p-3 rounded-md shadow-lg hidden z-50"}),s&&(0,Xn.jsxs)("div",{className:"fixed top-5 left-5 bg-orange-500 text-white p-3 rounded-md shadow-lg z-50",children:[(0,Xn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Xn.jsx)("span",{className:"text-lg",children:"\ud83d\udd27"}),(0,Xn.jsx)("span",{className:"font-bold",children:"DEBUG MODE"})]}),(0,Xn.jsx)("p",{className:"text-xs mt-1",children:"4\u4eba\u5bfe\u6226\u3092\u4e00\u4eba\u3067\u30c6\u30b9\u30c8\u53ef\u80fd"})]}),(0,Xn.jsxs)("header",{className:"text-center mb-8",children:[(0,Xn.jsx)("h1",{className:"text-5xl font-bold tracking-tight mb-2",children:"\u30e9\u30d3\u30ea\u30f3\u30b9"}),(0,Xn.jsx)("p",{className:"text-xl text-slate-300",children:"\u5fc3\u7406\u6226\u8ff7\u8def\u30b2\u30fc\u30e0"}),i&&(0,Xn.jsxs)("p",{className:"text-sm text-slate-400 mt-2",children:["\u30e6\u30fc\u30b6\u30fcID: ",i.substring(0,12),"..."]}),o&&(0,Xn.jsxs)("p",{className:"text-sm text-slate-300 mt-1",children:["\u30d7\u30ec\u30a4\u30e4\u30fc\u540d: ",o]}),(0,Xn.jsxs)("div",{className:"mt-3 flex items-center justify-center space-x-2",children:[(0,Xn.jsx)("div",{className:"w-3 h-3 rounded-full ".concat(a?"bg-green-500":"bg-red-500")}),(0,Xn.jsx)("span",{className:"text-xs text-slate-400",children:a?"\u30aa\u30f3\u30e9\u30a4\u30f3":"\u30aa\u30d5\u30e9\u30a4\u30f3"})]})]}),c&&(0,Xn.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Xn.jsxs)("div",{className:"bg-white text-gray-800 p-6 rounded-lg shadow-2xl max-w-md w-full mx-4",children:[(0,Xn.jsx)("h2",{className:"text-2xl font-bold mb-4 text-center",children:"\u30d7\u30ec\u30a4\u30e4\u30fc\u540d\u3092\u8a2d\u5b9a"}),(0,Xn.jsx)("p",{className:"text-gray-600 mb-4 text-center",children:"\u30b2\u30fc\u30e0\u4e2d\u306b\u8868\u793a\u3055\u308c\u308b\u540d\u524d\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044"}),(0,Xn.jsx)("input",{type:"text",value:o,onChange:e=>l(e.target.value),placeholder:"\u30d7\u30ec\u30a4\u30e4\u30fc\u540d\uff081-20\u6587\u5b57\uff09",className:"w-full p-3 border border-gray-300 rounded-lg mb-4 focus:outline-none focus:ring-2 focus:ring-blue-500",maxLength:20,onKeyPress:e=>"Enter"===e.key&&m()}),(0,Xn.jsxs)("div",{className:"flex space-x-3",children:[(0,Xn.jsx)("button",{onClick:m,disabled:!Qn(o),className:"flex-1 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed text-white font-bold py-3 px-6 rounded-lg transition-colors",children:"\u4fdd\u5b58"}),Kn()&&(0,Xn.jsx)("button",{onClick:()=>u(!1),className:"flex-1 bg-gray-500 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg transition-colors",children:"\u30ad\u30e3\u30f3\u30bb\u30eb"})]})]})}),(0,Xn.jsxs)("div",{className:"bg-slate-800 p-8 rounded-xl shadow-2xl w-full max-w-md",children:[(0,Xn.jsx)("h2",{className:"text-3xl font-semibold mb-6 text-center text-sky-400",children:"\u30e2\u30fc\u30c9\u9078\u629e"}),(0,Xn.jsx)("div",{className:"mb-6 p-4 bg-slate-700 rounded-lg",children:(0,Xn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Xn.jsxs)("div",{children:[(0,Xn.jsx)("p",{className:"text-sm text-slate-400",children:"\u30d7\u30ec\u30a4\u30e4\u30fc\u540d"}),(0,Xn.jsx)("p",{className:"text-white font-semibold",children:o||"\u672a\u8a2d\u5b9a"})]}),(0,Xn.jsx)("button",{onClick:()=>u(!0),className:"bg-slate-600 hover:bg-slate-500 text-white px-3 py-1 rounded text-sm transition-colors",children:"\u5909\u66f4"})]})}),(0,Xn.jsxs)("div",{className:"space-y-4",children:[(0,Xn.jsxs)("button",{onClick:()=>y("2player","standard"),disabled:!o||!Qn(o),className:"w-full bg-sky-500 hover:bg-sky-600 disabled:bg-gray-500 disabled:cursor-not-allowed text-white font-bold py-3 px-6 rounded-lg text-lg transition-all duration-150 ease-in-out transform hover:scale-105 shadow-lg flex items-center justify-center space-x-2",children:[(0,Xn.jsx)(On,{size:24})," ",(0,Xn.jsx)("span",{children:"2\u4eba\u5bfe\u6226"})]}),(0,Xn.jsxs)("button",{onClick:()=>y("4player","standard"),disabled:!o||!Qn(o),className:"w-full ".concat(s?"bg-orange-500 hover:bg-orange-600":"bg-teal-500 hover:bg-teal-600"," disabled:bg-gray-500 disabled:cursor-not-allowed text-white font-bold py-3 px-6 rounded-lg text-lg transition-all duration-150 ease-in-out transform hover:scale-105 shadow-lg flex items-center justify-center space-x-2"),children:[(0,Xn.jsx)(Rn,{size:24}),(0,Xn.jsxs)("span",{children:["4\u4eba\u5bfe\u6226 ",s&&"\ud83d\udd27"]})]})]})]}),(0,Xn.jsxs)("footer",{className:"mt-8 text-center text-slate-400 space-x-6",children:[(0,Xn.jsxs)("button",{onClick:()=>{p(1),h(!0)},className:"hover:text-sky-400 transition-colors",children:[(0,Xn.jsx)(Mn,{size:20,className:"inline mr-1"})," \u904a\u3073\u65b9"]}),(0,Xn.jsxs)("button",{onClick:()=>{p(2),h(!0)},className:"hover:text-sky-400 transition-colors",children:[(0,Xn.jsx)(Ln,{size:20,className:"inline mr-1"})," \u30c1\u30e3\u30c3\u30c8\u30d8\u30eb\u30d7"]}),(0,Xn.jsxs)("button",{onClick:()=>{g("\u554f\u984c\u767a\u751f\u6642\u306f\u30ea\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\u3002","info")},className:"hover:text-sky-400 transition-colors",children:[(0,Xn.jsx)(Un,{size:20,className:"inline mr-1"})," \u30d8\u30eb\u30d7"]})]}),d&&(0,Xn.jsx)(Yn,{page:f,onClose:()=>h(!1)})]})},Jn=Pn("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Zn=Pn("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),er=Pn("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),tr=Pn("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),nr=Pn("Skull",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["path",{d:"M8 20v2h8v-2",key:"ded4og"}],["path",{d:"m12.5 17-.5-1-.5 1h1z",key:"3me087"}],["path",{d:"M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20",key:"xq9p5u"}]]),rr=e=>{let{mazeData:t,playerPosition:n,showAllWalls:r,wallSettings:i,onWallClick:s,isCreating:a,startPos:o,goalPos:l,onCellClick:c,revealedCells:u={},revealedPlayerWalls:d=[],smallView:h=!1,highlightPlayer:f=!0,otherPlayers:p=[],gridSize:m=Fn,traps:g=[],selectingTrapCoord:y=!1,onTrapCoordSelect:v,alliedPlayersPos:b=[],sharedWallsFromAllies:w=[],showAllPlayerPositions:x=!1,hitWalls:_=[]}=e;if(!a&&!t&&!h)return(0,Xn.jsx)("div",{className:"text-center p-4",children:"\u8ff7\u8def\u30c7\u30fc\u30bf\u3092\u8aad\u307f\u8fbc\u307f\u4e2d..."});if(h&&!t)return(0,Xn.jsx)("div",{className:"text-center p-1 text-xs",children:"\u30c7\u30fc\u30bf\u306a\u3057"});const S=a?i:null===t||void 0===t?void 0:t.walls;let E="w-12 h-12 md:w-16 md:h-16";m>7&&(E="w-8 h-8 md:w-10 md:h-10"),m>10&&(E="w-7 h-7 md:w-8 md:h-8");const k=h?m>7?"w-5 h-5 md:w-6 md:h-6":"w-6 h-6 md:w-8 md:h-8":E,T=h?m>7?10:12:m>7?16:24,I=h?"text-2xs md:text-xs":m>7?"text-xs":"text-sm",N=(e,r)=>{var i,s,c,u;if(a)return o&&o.r===e&&o.c===r?(0,Xn.jsx)("span",{className:"font-bold ".concat(I," text-green-700"),children:"S"}):l&&l.r===e&&l.c===r?(0,Xn.jsx)("span",{className:"font-bold ".concat(I," text-red-700"),children:"G"}):null;const d=p.filter((t=>t.position.r===e&&t.position.c===r)),m=g.find((n=>n.r===e&&n.c===r&&n.mazeOwnerId===(null===t||void 0===t?void 0:t.ownerId))),y=b.find((t=>t.r===e&&t.c===r));let v=[];f&&n&&n.r===e&&n.c===r&&v.push((0,Xn.jsx)(On,{size:T,className:"text-white opacity-80 z-10"},"mainPlayer")),x&&!h?p.forEach((t=>{!t.position||t.position.r!==e||t.position.c!==r||n&&t.id===n.id||v.push((0,Xn.jsx)(On,{size:.8*T,className:"text-orange-500 opacity-90 absolute",title:"\u76f8\u624b\u30d7\u30ec\u30a4\u30e4\u30fc: ".concat(t.id.substring(0,5)),style:{left:"".concat(20*Math.random()+30,"%"),top:"".concat(20*Math.random()+30,"%")}},t.id))})):(y&&!h&&(f&&n&&n.r===e&&n.c===r||v.push((0,Xn.jsx)(tr,{size:.8*T,className:"text-green-500 opacity-80 absolute z-5",title:"Allied: ".concat(y.id.substring(0,5))},"ally-".concat(y.id)))),d.length>0&&!h&&d.forEach((t=>{!t.position||f&&n&&n.r===e&&n.c===r||b.find((n=>n.id===t.id&&n.r===e&&n.c===r))||v.push((0,Xn.jsx)(On,{size:.8*T,className:"text-purple-400 opacity-70 absolute",title:t.id.substring(0,5)},t.id))}))),!m||h||n&&n.r===e&&n.c===r||v.push((0,Xn.jsx)(nr,{size:.7*T,className:"text-red-500 opacity-60 absolute z-0",title:"Trap by ".concat(m.ownerId.substring(0,5))},"trap"));let w=null;return(null===t||void 0===t||null===(i=t.start)||void 0===i?void 0:i.r)===e&&(null===t||void 0===t||null===(s=t.start)||void 0===s?void 0:s.c)===r&&(w=(0,Xn.jsx)("span",{className:"font-bold ".concat(I," text-green-700 absolute bottom-0 right-0 opacity-70"),children:"S"})),(null===t||void 0===t||null===(c=t.goal)||void 0===c?void 0:c.r)===e&&(null===t||void 0===t||null===(u=t.goal)||void 0===u?void 0:u.c)===r&&(w=(0,Xn.jsx)("span",{className:"font-bold ".concat(I," text-red-700 absolute bottom-0 right-0 opacity-70"),children:"G"})),(0,Xn.jsxs)(Xn.Fragment,{children:[v,w]})},C=(e,t,n,i)=>{if(!S&&(!w||0===w.length))return!1;let s,o,l;if(e===n)l="vertical",s=e,o=Math.min(t,i);else{if(t!==i)return!1;l="horizontal",s=Math.min(e,n),o=t}const c=null===S||void 0===S?void 0:S.find((e=>e.type===l&&e.r===s&&e.c===o&&!0===e.active)),u=null===w||void 0===w?void 0:w.find((e=>e.type===l&&e.r===s&&e.c===o&&!0===e.active));if(a||h)return!!c;if(r)return!!c||!!u;return!!d.find((e=>e.type===l&&e.r===s&&e.c===o&&!0===e.active))||!!u},A=(e,t,n,r)=>{if(!_||0===_.length)return!1;let i,s,a;if(e===n)a="vertical",i=e,s=Math.min(t,r);else{if(t!==r)return!1;a="horizontal",i=Math.min(e,n),s=t}const o=_.some((e=>e.type===a&&e.r===i&&e.c===s));return o&&console.log("\ud83d\udd34 [MazeGrid] Hit wall found:",{wallType:a,wallR:i,wallC:s,r1:e,c1:t,r2:n,c2:r}),o};return(0,Xn.jsx)("div",{className:"grid grid-cols-1 gap-0 ".concat(h?"border-2":"border-8"," border-black bg-gray-50 rounded-md shadow-lg"),style:{gridTemplateColumns:"repeat(".concat(m,", minmax(0, 1fr))")},children:Array(m).fill(0).map(((e,r)=>Array(m).fill(0).map(((e,d)=>{var p,g;const b="".concat(r,"-").concat(d);let w="".concat(k," flex items-center justify-center relative");if(a)o&&o.r===r&&o.c===d?w+=" bg-green-300":l&&l.r===r&&l.c===d?w+=" bg-red-300":w+=" hover:bg-gray-100 cursor-pointer";else if(h){var x,_,S,E;f&&n&&n.r===r&&n.c===d?w+=" bg-blue-300":(null===t||void 0===t||null===(x=t.start)||void 0===x?void 0:x.r)===r&&(null===t||void 0===t||null===(_=t.start)||void 0===_?void 0:_.c)===d?w+=" bg-green-100":(null===t||void 0===t||null===(S=t.goal)||void 0===S?void 0:S.r)===r&&(null===t||void 0===t||null===(E=t.goal)||void 0===E?void 0:E.c)===d?w+=" bg-red-100":w+=" bg-gray-100"}else{var T,I,j,D;f&&n&&n.r===r&&n.c===d?w+=" bg-blue-400 transition-colors duration-300":(null===t||void 0===t||null===(T=t.start)||void 0===T?void 0:T.r)===r&&(null===t||void 0===t||null===(I=t.start)||void 0===I?void 0:I.c)===d?w+=" bg-green-200":(null===t||void 0===t||null===(j=t.goal)||void 0===j?void 0:j.r)===r&&(null===t||void 0===t||null===(D=t.goal)||void 0===D?void 0:D.c)===d?w+=" bg-red-200":u["".concat(r,"-").concat(d)]?w+=" bg-yellow-100":w+=" bg-gray-50"}y&&v&&!a&&!h&&(w+=" cursor-crosshair hover:bg-red-200/50");let P="";const O=h?"border-2":"border-8",R=("border-black ".concat(O),"border-red-500 ".concat(O),"border-gray-300"),M=h?"border-2":"border-8";return 0===r?P+=" border-t ".concat(M," border-t-black"):C(r,d,r-1,d)?A(r,d,r-1,d)?P+=" border-t ".concat(O," border-t-red-500"):P+=" border-t ".concat(O," border-t-black"):P+=" border-t ".concat(R),r===m-1?P+=" border-b ".concat(M," border-b-black"):C(r,d,r+1,d)?A(r,d,r+1,d)?P+=" border-b ".concat(O," border-b-red-500"):P+=" border-b ".concat(O," border-b-black"):P+=" border-b ".concat(R),0===d?P+=" border-l ".concat(M," border-l-black"):C(r,d,r,d-1)?A(r,d,r,d-1)?P+=" border-l ".concat(O," border-l-red-500"):P+=" border-l ".concat(O," border-l-black"):P+=" border-l ".concat(R),d===m-1?P+=" border-r ".concat(M," border-r-black"):C(r,d,r,d+1)?A(r,d,r,d+1)?P+=" border-r ".concat(O," border-r-red-500"):P+=" border-r ".concat(O," border-r-black"):P+=" border-r ".concat(R),w+=" ".concat(P),(0,Xn.jsxs)("div",{className:w,onClick:()=>{a&&c&&c(r,d),y&&v&&v(r,d)},children:[N(r,d),a&&s&&!h&&(0,Xn.jsxs)(Xn.Fragment,{children:[r<m-1&&(0,Xn.jsx)("div",{title:"H-wall (".concat(r,",").concat(d,")"),className:"absolute bottom-[-4px] left-0 w-full h-[8px] cursor-pointer hover:bg-blue-300/50 z-10 ".concat(i&&null!==(p=i.find((e=>"horizontal"===e.type&&e.r===r&&e.c===d)))&&void 0!==p&&p.active?"bg-black/50":"bg-gray-300/30"),onClick:e=>{e.stopPropagation(),s(r,d,"horizontal")}}),d<m-1&&(0,Xn.jsx)("div",{title:"V-wall (".concat(r,",").concat(d,")"),className:"absolute top-0 right-[-4px] w-[8px] h-full cursor-pointer hover:bg-blue-300/50 z-10 ".concat(i&&null!==(g=i.find((e=>"vertical"===e.type&&e.r===r&&e.c===d)))&&void 0!==g&&g.active?"bg-black/50":"bg-gray-300/30"),onClick:e=>{e.stopPropagation(),s(r,d,"vertical")}})]})]},b)}))))})},ir=e=>{let{userId:t,setScreen:n,gameMode:i,debugMode:s,isOnline:a}=e;const[o,l]=(0,r.useState)(null),[c,u]=(0,r.useState)(null),[d,h]=(0,r.useState)("standard"),f="extra"===d?11:Fn,[p,m]=(0,r.useState)(qn(f)),[g,y]=(0,r.useState)(null),[v,b]=(0,r.useState)(null),[w,x]=(0,r.useState)("wall"),[_,S]=(0,r.useState)("\u58c1\u3092".concat(zn,"\u672c\u8a2d\u7f6e\u3057\u3001S/G\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002")),[E,k]=(0,r.useState)(null),[T,I]=(0,r.useState)("connected"),[N,C]=(0,r.useState)(Date.now()),A=Kn()||"\u672a\u8a2d\u5b9a\u30e6\u30fc\u30b6\u30fc",j=(0,r.useRef)(null),D=(0,r.useRef)(null),P=e=>{var n,r;if(e===t)return A;if(null!==c&&void 0!==c&&c.playerNames&&c.playerNames[e])return c.playerNames[e];if(null!==c&&void 0!==c&&null!==(n=c.playerStates)&&void 0!==n&&null!==(r=n[e])&&void 0!==r&&r.playerName)return c.playerStates[e].playerName;if(e.startsWith("debug_player")){const t=e.charAt(12)||e.split("_")[2];return"\u30c7\u30d0\u30c3\u30b0\u30d7\u30ec\u30a4\u30e4\u30fc".concat(t)}return"\u30d7\u30ec\u30a4\u30e4\u30fc".concat(e.substring(0,8),"...")};(0,r.useEffect)((()=>{const e=localStorage.getItem("labyrinthGameId"),t=localStorage.getItem("labyrinthGameType")||"standard";h(t),k("extra"===t?300:null),e?l(e):S("\u30b2\u30fc\u30e0ID\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3002\u30ed\u30d3\u30fc\u306b\u623b\u3063\u3066\u304f\u3060\u3055\u3044\u3002")}),[]),(0,r.useEffect)((()=>{m(qn("extra"===d?11:Fn))}),[d]),(0,r.useEffect)((()=>{if("extra"===d&&null!==E&&E>0&&"creating"===(null===c||void 0===c?void 0:c.status)&&(!c.mazes||!c.mazes[t])){const e=setTimeout((()=>k(E-1)),1e3);return()=>clearTimeout(e)}"extra"!==d||0!==E||"creating"!==(null===c||void 0===c?void 0:c.status)||c.mazes&&c.mazes[t]||S("\u6642\u9593\u5207\u308c\u3067\u3059\uff01\u8ff7\u8def\u3092\u81ea\u52d5\u9001\u4fe1\u3057\u307e\u3059\uff08\u307e\u305f\u306f\u73fe\u5728\u306e\u72b6\u614b\u3067\u78ba\u5b9a\uff09\u3002")}),[E,d,c,t]),(0,r.useEffect)((()=>{if(!o||!t)return;console.log("\ud83d\udd17 [CourseCreation] Setting up enhanced real-time listener for game:",o);const e=(0,wn.doc)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),o),r=(0,wn.aQ)(e,{includeMetadataChanges:!0},(e=>{const r=Date.now(),i=e.metadata.fromCache?"cache":"server",s=e.metadata.hasPendingWrites;if(console.log("\ud83d\udcf1 [CourseCreation] Game data updated from ".concat(i,":"),{gameId:o.substring(0,8),userId:t.substring(0,8),timestamp:(new Date).toISOString(),source:i,hasPendingWrites:s,exists:e.exists()}),"server"===i?(I("connected"),C(r),D.current&&(clearTimeout(D.current),D.current=null)):"cache"===i&&(I("cached"),D.current&&clearTimeout(D.current),D.current=setTimeout((()=>{Date.now()-N>1e4&&I("disconnected")}),1e4)),e.exists()){var a,l,c,f;const r=e.data();if(console.log("\ufffd [CourseCreation] Detailed game state:",{status:r.status,players:r.players,playerCount:(null===(a=r.players)||void 0===a?void 0:a.length)||0,currentUserIncluded:null===(l=r.players)||void 0===l?void 0:l.includes(t),mazesCount:Object.keys(r.mazes||{}).length,mazeOwners:Object.keys(r.mazes||{}),lastUpdated:null===(c=r.lastUpdated)||void 0===c||null===(f=c.toDate())||void 0===f?void 0:f.toISOString(),source:i,hasPendingWrites:s}),"server"===i||!s){u(r);const e=r.gameType||"standard";if(d!==e&&h(e),"abandoned"===r.status||"disbanded"===r.status)return console.log("\u26a0\ufe0f [CourseCreation] Game was abandoned/disbanded, returning to lobby"),S("\u30b2\u30fc\u30e0\u304c\u89e3\u6563\u3055\u308c\u307e\u3057\u305f\u3002\u30ed\u30d3\u30fc\u306b\u623b\u308a\u307e\u3059\u3002"),localStorage.removeItem("labyrinthGameId"),localStorage.removeItem("labyrinthGameType"),void setTimeout((()=>n("lobby")),2e3);if(!r.players||!r.players.includes(t))return console.log("\u26a0\ufe0f [CourseCreation] Current user not in players list, returning to lobby"),S("\u30d7\u30ec\u30a4\u30e4\u30fc\u30ea\u30b9\u30c8\u304b\u3089\u9664\u5916\u3055\u308c\u307e\u3057\u305f\u3002\u30ed\u30d3\u30fc\u306b\u623b\u308a\u307e\u3059\u3002"),localStorage.removeItem("labyrinthGameId"),localStorage.removeItem("labyrinthGameType"),void setTimeout((()=>n("lobby")),2e3);if(("playing"===r.status||"extra"===e&&r.currentExtraModePhase&&"mazeCreation"!==r.currentExtraModePhase)&&n("play"),r.mazes&&r.mazes[t]){S("\u8ff7\u8def\u9001\u4fe1\u6e08\u3002\u4ed6\u30d7\u30ec\u30a4\u30e4\u30fc\u5f85\u6a5f\u4e2d...");const n=r.mazes[t],i=n.gridSize||("extra"===e?11:Fn);n.allWallsConfiguration?m(n.allWallsConfiguration):m(qn(i)),n.start&&y(n.start),n.goal&&b(n.goal)}else"creating"===r.status&&O(p,g,v,"extra"===e?11:Fn)}}else console.log("\u274c [CourseCreation] Game document does not exist"),S("\u30b2\u30fc\u30e0\u30c7\u30fc\u30bf\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3002\u30ed\u30d3\u30fc\u306b\u623b\u308a\u307e\u3059\u3002"),localStorage.removeItem("labyrinthGameId"),localStorage.removeItem("labyrinthGameType"),setTimeout((()=>n("lobby")),2e3)}),(e=>{console.error("\u274c [CourseCreation] Error in real-time listener:",e),I("error"),S("\u63a5\u7d9a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\u30da\u30fc\u30b8\u3092\u30ea\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}));return j.current=r,()=>{console.log("\ud83d\udd0c [CourseCreation] Unsubscribing from real-time listener"),j.current&&(j.current(),j.current=null),D.current&&(clearTimeout(D.current),D.current=null)}}),[o,t,n]);const O=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:g,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:v,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:f;const i=e.filter((e=>e.active)).length;let s="\u58c1: ".concat(i,"/").concat(zn,"\u672c\u3002");s+=t?"S(".concat(t.r,",").concat(t.c,")\u3002"):"S\u672a\u8a2d\u5b9a\u3002",s+=n?"G(".concat(n.r,",").concat(n.c,")\u3002"):"G\u672a\u8a2d\u5b9a\u3002",t&&n&&!Wn(t,n,e,r)&&(s+=" <span class='text-red-500 font-semibold'>\u8b66\u544a: S\u304b\u3089G\u3078\u306e\u7d4c\u8def\u304c\u3042\u308a\u307e\u305b\u3093\uff01</span>"),S(s)},R=p.filter((e=>e.active)).length,M=g&&v&&Wn(g,v,p,f),L=g&&v&&R===zn&&M&&c&&(!c.mazes||!c.mazes[t]);return(0,Xn.jsxs)("div",{className:"flex flex-col items-center justify-start min-h-screen bg-slate-100 p-4 pt-8",children:[(0,Xn.jsxs)("div",{className:"w-full max-w-2xl flex justify-between items-center mb-4",children:[(0,Xn.jsxs)("h1",{className:"text-3xl font-bold text-slate-800",children:["\u30b3\u30fc\u30b9\u4f5c\u6210 ","extra"===d&&"(\u30a8\u30af\u30b9\u30c8\u30e9\u30e2\u30fc\u30c9)"]}),(0,Xn.jsx)("button",{onClick:()=>n("lobby"),className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded font-semibold",children:"\u30db\u30fc\u30e0\u306b\u623b\u308b"})]}),o&&(0,Xn.jsxs)("p",{className:"text-sm text-slate-600 mb-1",children:["\u30b2\u30fc\u30e0ID: ",o.substring(0,8),"..."]}),t&&(0,Xn.jsxs)("p",{className:"text-sm text-slate-600 mb-1",children:["\u3042\u306a\u305f: ",A," (",i,")"]}),(0,Xn.jsxs)("div",{className:"mb-2 flex items-center justify-center space-x-2",children:[(0,Xn.jsx)("div",{className:"w-3 h-3 rounded-full ".concat("connected"===T?"bg-green-500":"cached"===T?"bg-yellow-500":"disconnected"===T?"bg-red-500":"bg-gray-500")}),(0,Xn.jsx)("span",{className:"text-xs text-slate-600",children:"connected"===T?"\u30ea\u30a2\u30eb\u30bf\u30a4\u30e0\u540c\u671f\u4e2d":"cached"===T?"\u30ad\u30e3\u30c3\u30b7\u30e5\u304b\u3089\u8868\u793a\u4e2d":"disconnected"===T?"\u63a5\u7d9a\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3059":"\u63a5\u7d9a\u30a8\u30e9\u30fc"}),(0,Xn.jsxs)("span",{className:"text-xs text-slate-400",children:["(\u6700\u7d42\u540c\u671f: ",new Date(N).toLocaleTimeString(),")"]})]}),"extra"===d&&null!==E&&(0,Xn.jsxs)("p",{className:"text-lg font-semibold text-red-600 mb-2",children:[(0,Xn.jsx)(Jn,{size:20,className:"inline mr-1"})," \u6b8b\u308a\u6642\u9593: ",Hn(E)]}),(0,Xn.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl mb-6 w-full ".concat(f>6?"max-w-2xl":"max-w-lg"),children:[(0,Xn.jsxs)("div",{className:"flex justify-center space-x-1 sm:space-x-2 mb-4",children:[(0,Xn.jsxs)("button",{onClick:()=>x("wall"),className:"px-2 sm:px-4 py-2 rounded-md font-semibold text-xs sm:text-sm ".concat("wall"===w?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:["\u58c1 (",R,"/",zn,")"]}),(0,Xn.jsxs)("button",{onClick:()=>x("start"),className:"px-2 sm:px-4 py-2 rounded-md font-semibold text-xs sm:text-sm ".concat("start"===w?"bg-green-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:["S ",g?(0,Xn.jsx)(Zn,{size:14,className:"inline"}):(0,Xn.jsx)(er,{size:14,className:"inline"})]}),(0,Xn.jsxs)("button",{onClick:()=>x("goal"),className:"px-2 sm:px-4 py-2 rounded-md font-semibold text-xs sm:text-sm ".concat("goal"===w?"bg-red-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:["G ",v?(0,Xn.jsx)(Zn,{size:14,className:"inline"}):(0,Xn.jsx)(er,{size:14,className:"inline"})]})]}),(0,Xn.jsx)("p",{className:"text-center text-sm text-slate-700 mb-4 h-12 overflow-y-auto",dangerouslySetInnerHTML:{__html:_}}),(0,Xn.jsx)("div",{className:"flex justify-center",children:(0,Xn.jsx)(rr,{isCreating:!0,wallSettings:p,onWallClick:(e,n,r)=>{var i,s;if("wall"!==w||null!==c&&void 0!==c&&null!==(i=c.mazes)&&void 0!==i&&i[t])return void(null!==c&&void 0!==c&&null!==(s=c.mazes)&&void 0!==s&&s[t]&&S("\u8ff7\u8def\u306f\u9001\u4fe1\u6e08\u307f\u306e\u305f\u3081\u5909\u66f4\u3067\u304d\u307e\u305b\u3093\u3002"));const a=p.findIndex((t=>t.r===e&&t.c===n&&t.type===r));if(-1===a)return;const o=p.map((e=>(0,Tn.A)({},e))),l=o.filter((e=>e.active)).length;if(o[a].active)o[a].active=!1;else{if(l>=zn)return O(o,g,v,f),void S("\u58c1\u306f".concat(zn,"\u672c\u307e\u3067\u3067\u3059\u3002 <span class='text-red-500 font-semibold'>S\u304b\u3089G\u3078\u306e\u7d4c\u8def\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002</span>"));o[a].active=!0}g&&v&&!Wn(g,v,o,f)&&o[a].active?S("\u3053\u306e\u58c1\u3092\u8a2d\u7f6e\u3059\u308b\u3068S\u304b\u3089G\u3078\u306e\u7d4c\u8def\u304c\u306a\u304f\u306a\u308a\u307e\u3059\u3002 <span class='text-red-500 font-semibold'>S\u304b\u3089G\u3078\u306e\u7d4c\u8def\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002</span>"):(m(o),O(o,g,v,f))},onCellClick:(e,n)=>{var r;if(null!==c&&void 0!==c&&null!==(r=c.mazes)&&void 0!==r&&r[t])return void S("\u8ff7\u8def\u306f\u9001\u4fe1\u6e08\u307f\u306e\u305f\u3081\u5909\u66f4\u3067\u304d\u307e\u305b\u3093\u3002");let i=g,s=v;if("start"===w){if(v&&v.r===e&&v.c===n)return void S("S\u3068G\u306f\u7570\u306a\u308b\u30de\u30b9\u306b\u3002 <span class='text-red-500 font-semibold'>S\u304b\u3089G\u3078\u306e\u7d4c\u8def\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002</span>");i={r:e,c:n}}else if("goal"===w){if(g&&g.r===e&&g.c===n)return void S("S\u3068G\u306f\u7570\u306a\u308b\u30de\u30b9\u306b\u3002 <span class='text-red-500 font-semibold'>S\u304b\u3089G\u3078\u306e\u7d4c\u8def\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002</span>");s={r:e,c:n}}i&&s&&!Wn(i,s,p,f)?S("\u73fe\u5728\u306e\u58c1\u3067\u306f\u3001\u305d\u306e".concat("start"===w?"S":"G","\u4f4d\u7f6e\u3060\u3068\u7d4c\u8def\u304c\u78ba\u4fdd\u3067\u304d\u307e\u305b\u3093\u3002 <span class='text-red-500 font-semibold'>S\u304b\u3089G\u3078\u306e\u7d4c\u8def\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002</span>")):("start"===w&&y(i),"goal"===w&&b(s),O(p,i,s,f))},startPos:g,goalPos:v,gridSize:f})}),(0,Xn.jsx)("button",{onClick:async()=>{if(!g||!v)return void S("S\u3068G\u3092\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002 <span class='text-red-500 font-semibold'>S\u304b\u3089G\u3078\u306e\u7d4c\u8def\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002</span>");if(p.filter((e=>e.active)).length!==zn)return void S("\u58c1\u3092\u6b63\u78ba\u306b".concat(zn,"\u672c\u8a2d\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002 <span class='text-red-500 font-semibold'>S\u304b\u3089G\u3078\u306e\u7d4c\u8def\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002</span>"));if(!Wn(g,v,p,f))return void S("S\u304b\u3089G\u3078\u306e\u7d4c\u8def\u304c\u3042\u308a\u307e\u305b\u3093\u3002\u58c1\u3084S/G\u3092\u8abf\u6574\u3057\u3066\u304f\u3060\u3055\u3044\u3002");if(!o||!t||!c)return void S("\u30b2\u30fc\u30e0/\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u304c\u3042\u308a\u307e\u305b\u3093\u3002");const e={start:g,goal:v,walls:p.filter((e=>e.active)),allWallsConfiguration:p,ownerId:t,gridSize:f};try{const n=(0,wn.doc)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),o),r=await(0,wn.getDoc)(n);if(!r.exists())return void S("\u30b2\u30fc\u30e0\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3002");const i=r.data();let a=(0,Tn.A)((0,Tn.A)({},i.mazes||{}),{},{[t]:e});if(s&&i.players){const e="2player"===i.mode?2:4;if(i.players.length===e){console.log("\ud83d\udd27 [DEBUG] Auto-generating mazes for other ".concat(e-1," players")),S("\u30c7\u30d0\u30c3\u30b0\u30e2\u30fc\u30c9: \u4ed6\u30d7\u30ec\u30a4\u30e4\u30fc\u5206\u306e\u8ff7\u8def\u3092\u81ea\u52d5\u751f\u6210\u4e2d...");i.players.filter((e=>e!==t)).forEach((e=>{if(!a[e]){const t=(()=>{const e=qn(f),t=[];for(;t.length<zn;){const n=Math.floor(Math.random()*e.length);e[n].active||(e[n].active=!0,t.push(n))}let n,r;do{n={r:Math.floor(Math.random()*f),c:Math.floor(Math.random()*f)},r={r:Math.floor(Math.random()*f),c:Math.floor(Math.random()*f)}}while(n.r===r.r&&n.c===r.c||!Wn(n,r,e,f));return{start:n,goal:r,walls:e.filter((e=>e.active)),allWallsConfiguration:e,gridSize:f}})();a[e]=(0,Tn.A)((0,Tn.A)({},t),{},{ownerId:e,isAutoGenerated:!0}),console.log("\ud83d\udd27 [DEBUG] Auto-generated maze for player ".concat(e.substring(0,8),"..."))}}))}}await(0,wn.updateDoc)(n,{mazes:a}),S(s?"\u8ff7\u8def\u9001\u4fe1\u5b8c\u4e86\uff08\u30c7\u30d0\u30c3\u30b0\u30e2\u30fc\u30c9: \u5168\u54e1\u5206\u81ea\u52d5\u751f\u6210\uff09":"\u8ff7\u8def\u9001\u4fe1\u3002\u4ed6\u30d7\u30ec\u30a4\u30e4\u30fc\u5f85\u6a5f\u4e2d...");const l="2player"===i.mode?2:4;if(Object.keys(a).length===i.players.length&&i.players.length===l){let e=[...i.players];e=Gn(e);const r={};let s=Gn([...i.players]),o="extra"===d?Gn([...Bn]):[];e.forEach(((n,c)=>{let u=s[c],h=0;for(;u===n&&h<l&&l>1;)u=s[(c+h+1)%l],h++;u===n&&l>1&&(u=s[(c+1)%l]);let f,p=null;if("extra"===d&&o.length>0){if(p=(0,Tn.A)({},o.pop()),p.requiresTarget){let t=e.filter((e=>e!==n));p.targetPlayerId=t.length>0?t[Math.floor(Math.random()*t.length)]:null,p.text=p.text.replace("\u7279\u5b9a\u306e\u30d7\u30ec\u30a4\u30e4\u30fc",p.targetPlayerId?p.targetPlayerId.substring(0,5)+"...":"\u8ab0\u304b")}p.achieved=!1,p.progress=0}if(n===t)f=A;else if(i.playerNames&&i.playerNames[n])f=i.playerNames[n];else if(n.startsWith("debug_player")){const e=n.charAt(12)||n.split("_")[2];f="\u30c7\u30d0\u30c3\u30b0\u30d7\u30ec\u30a4\u30e4\u30fc".concat(e)}else f="\u30d7\u30ec\u30a4\u30e4\u30fc".concat(n.substring(0,8),"...");r[n]={assignedMazeOwnerId:u,myOriginalMazeOwnerId:n,position:a[u].start,score:0,revealedCells:{},revealedWalls:[],isTurnSkipped:!1,goalTime:null,rank:null,battledOpponents:[],inBattleWith:null,battleBet:null,secretObjective:p,personalTimerEnd:"extra"===d?wn.Dc.fromMillis(Date.now()+6e5):null,personalTimeUsed:0,declaredAction:null,allianceId:null,hasDeclaredThisTurn:!1,privateLog:[],sabotageEffects:[],negotiationOffers:[],sharedDataFromAllies:{walls:[],scoutLogs:[]},temporaryPriorityBoost:0,betrayedAllies:[],playerName:f}}));const c={playerStates:r,turnOrder:e,currentTurnPlayerId:e[0],goalCount:0,playerGoalOrder:[]};"extra"===d?(c.status="playing",c.currentExtraModePhase="declaration",c.declarations={},e.forEach((e=>{c.declarations[e]={type:null,submittedAt:null}})),c.phaseTimerEnd=wn.Dc.fromMillis(Date.now()+3e4),console.log("Extra mode starting, declaration phase.")):c.status="playing",await(0,wn.updateDoc)(n,c)}}catch(n){console.error("Error submitting maze:",n),S("\u8ff7\u8def\u306e\u9001\u4fe1\u306b\u5931\u6557\u3057\u307e\u3057\u305f: "+n.message)}},disabled:!L,className:"mt-6 w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded-lg text-lg transition-colors disabled:bg-gray-400 disabled:cursor-not-allowed",children:"\u8ff7\u8def\u3092\u78ba\u5b9a"})]}),c&&c.players&&(0,Xn.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow-md w-full ".concat(f>6?"max-w-2xl":"max-w-lg"," mb-4"),children:[(0,Xn.jsxs)("h3",{className:"text-lg font-semibold mb-2",children:["\u53c2\u52a0\u30d7\u30ec\u30a4\u30e4\u30fc (",c.players.length,"/","2player"===c.mode?2:4,"\u4eba):"]}),(0,Xn.jsx)("ul",{className:"list-disc list-inside text-sm",children:c.players.map((e=>(0,Xn.jsxs)("li",{className:e===t?"font-bold":"",children:[P(e)," ",c.mazes&&c.mazes[e]?(0,Xn.jsx)(Zn,{size:16,className:"inline text-green-500 ml-1"}):(0,Xn.jsx)("span",{className:"text-xs text-gray-500",children:"(\u4f5c\u6210\u4e2d)"})]},e)))})]})]})},sr=Pn("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),ar=Pn("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),or=Pn("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),lr=Pn("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),cr=Pn("Swords",[["polyline",{points:"14.5 17.5 3 6 3 3 6 3 17.5 14.5",key:"1hfsw2"}],["line",{x1:"13",x2:"19",y1:"19",y2:"13",key:"1vrmhu"}],["line",{x1:"16",x2:"20",y1:"16",y2:"20",key:"1bron3"}],["line",{x1:"19",x2:"21",y1:"21",y2:"19",key:"13pww6"}],["polyline",{points:"14.5 6.5 18 3 21 3 21 6 17.5 9.5",key:"hbey2j"}],["line",{x1:"5",x2:"9",y1:"14",y2:"18",key:"1hf58s"}],["line",{x1:"7",x2:"4",y1:"17",y2:"20",key:"pidxm4"}],["line",{x1:"3",x2:"5",y1:"19",y2:"21",key:"1pehsh"}]]),ur=Pn("Move",[["polyline",{points:"5 9 2 12 5 15",key:"1r5uj5"}],["polyline",{points:"9 5 12 2 15 5",key:"5v383o"}],["polyline",{points:"15 19 12 22 9 19",key:"g7qi8m"}],["polyline",{points:"19 9 22 12 19 15",key:"tpp73q"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}]]),dr=Pn("Hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]]),hr=Pn("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]),fr=Pn("CircleMinus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}]]),pr=Pn("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),mr=e=>{let{isOpen:t,onClose:n,onBet:i,maxBet:s,opponentName:a,myName:o,myCurrentScore:l}=e;const[c,u]=(0,r.useState)(1);if((0,r.useEffect)((()=>{t&&u(1)}),[t]),!t)return null;const d=Math.max(1,l);return(0,Xn.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4",children:(0,Xn.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-xl w-full max-w-sm text-center",children:[(0,Xn.jsxs)("h2",{className:"text-2xl font-bold mb-2 text-red-600 flex items-center justify-center",children:[(0,Xn.jsx)(cr,{size:28,className:"mr-2"})," \u30d0\u30c8\u30eb\u767a\u751f\uff01"]}),(0,Xn.jsxs)("p",{className:"mb-1 text-lg",children:["vs ",(0,Xn.jsx)("span",{className:"font-semibold",children:a?a.substring(0,8):"\u76f8\u624b"})]}),(0,Xn.jsxs)("p",{className:"mb-4 text-sm text-gray-600",children:["\u3042\u306a\u305f\u306e\u73fe\u5728\u30dd\u30a4\u30f3\u30c8: ",l,"pt"]}),(0,Xn.jsx)("p",{className:"mb-1 font-semibold",children:"\u30dd\u30a4\u30f3\u30c8\u3092\u8ced\u3051\u3066\u304f\u3060\u3055\u3044"}),(0,Xn.jsxs)("p",{className:"mb-4 text-xs text-gray-500",children:["(\u6700\u5c0f: 1pt, \u6700\u5927: ",d,"pt)"]}),(0,Xn.jsxs)("div",{className:"flex items-center justify-center space-x-3 my-4",children:[(0,Xn.jsx)("button",{onClick:()=>u((e=>Math.max(1,e-1))),disabled:c<=1,className:"p-2 bg-gray-300 hover:bg-gray-400 rounded-full disabled:opacity-50 transition-colors","aria-label":"\u30d9\u30c3\u30c8\u3092\u6e1b\u3089\u3059",children:(0,Xn.jsx)(fr,{size:28})}),(0,Xn.jsx)("span",{className:"text-3xl font-bold w-16 text-center",children:c}),(0,Xn.jsx)("button",{onClick:()=>u((e=>Math.min(e+1,d))),disabled:c>=d,className:"p-2 bg-gray-300 hover:bg-gray-400 rounded-full disabled:opacity-50 transition-colors","aria-label":"\u30d9\u30c3\u30c8\u3092\u5897\u3084\u3059",children:(0,Xn.jsx)(pr,{size:28})})]}),(0,Xn.jsx)("button",{onClick:()=>i(c),className:"w-full bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-4 rounded-lg text-lg transition-colors",children:"\u8ced\u3051\u308b\uff01"}),(0,Xn.jsx)("p",{className:"text-xs mt-3 text-gray-500",children:"\u76f8\u624b\u3082\u30dd\u30a4\u30f3\u30c8\u5165\u529b\u4e2d\u3067\u3059..."})]})})},gr=Pn("Timer",[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]]),yr=e=>{let{isOpen:t,gameData:n,userId:r,onClose:i,onReturnToLobby:s,onStartReview:a}=e;if(!t||!n||!n.playerStates)return null;const o="standard"===n.gameType;let l=null,c=null;if(o){var u;const e=(n.players||[]).map((e=>(0,Tn.A)({id:e},n.playerStates[e])));e.sort(((e,t)=>(e.goalTime?e.goalTime.toMillis?e.goalTime.toMillis():e.goalTime:1/0)-(t.goalTime?t.goalTime.toMillis?t.goalTime.toMillis():t.goalTime:1/0))),null!==(u=e[0])&&void 0!==u&&u.goalTime&&(l=e[0],c=e[1])}const d=(n.players||[]).map((e=>(0,Tn.A)({id:e},n.playerStates[e]))).sort(((e,t)=>(e.rank||1/0)-(t.rank||1/0)||(t.score||0)-(e.score||0)));return(0,Xn.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4 transition-opacity duration-300 ease-in-out",children:(0,Xn.jsxs)("div",{className:"bg-white p-6 md:p-8 rounded-lg shadow-2xl w-full max-w-md text-center transform transition-all duration-300 ease-in-out scale-100",children:[(0,Xn.jsxs)("h2",{className:"text-3xl font-bold mb-4 text-indigo-600 flex items-center justify-center",children:[(0,Xn.jsx)(hr,{size:32,className:"mr-2 text-yellow-400"}),"\u30b2\u30fc\u30e0\u7d42\u4e86\uff01"]}),o&&l?(0,Xn.jsxs)("div",{className:"mb-6",children:[(0,Xn.jsx)("h3",{className:"text-2xl font-bold mb-4 text-gray-700",children:"\u52dd\u8005"}),(0,Xn.jsxs)("div",{className:"p-4 rounded-lg ".concat(l.id===r?"bg-gold-100 border-4 border-yellow-400":"bg-purple-100 border-4 border-purple-400"),children:[(0,Xn.jsxs)("div",{className:"flex items-center justify-center mb-2",children:[(0,Xn.jsx)(hr,{size:24,className:"text-yellow-400 mr-2"}),(0,Xn.jsx)("span",{className:"text-xl font-bold text-gray-800",children:l.id===r?"\u3042\u306a\u305f\u306e\u52dd\u5229\uff01":"\u76f8\u624b\u306e\u52dd\u5229\uff01"})]}),(0,Xn.jsxs)("p",{className:"text-sm text-gray-600",children:["\u30d7\u30ec\u30a4\u30e4\u30fc: ",l.id===r?"\u3042\u306a\u305f":"".concat(l.id.substring(0,8),"...")]}),l.goalTime&&(0,Xn.jsxs)("p",{className:"text-sm text-green-600 font-semibold mt-1",children:[(0,Xn.jsx)(Zn,{size:16,className:"inline mr-1"}),"\u30b4\u30fc\u30eb\u9054\u6210\uff01"]})]})]}):o?(0,Xn.jsx)("div",{className:"mb-6",children:(0,Xn.jsx)("p",{className:"text-gray-600",children:"\u30b2\u30fc\u30e0\u7d50\u679c\u3092\u96c6\u8a08\u4e2d..."})}):(0,Xn.jsxs)("div",{className:"mb-6",children:[(0,Xn.jsx)("h3",{className:"text-xl font-semibold mb-2 text-gray-700",children:"\u6700\u7d42\u7d50\u679c:"}),"extra"===n.gameType&&n.gameTimerEnd&&n.gameTimerEnd.toMillis()<=Date.now()&&(0,Xn.jsx)("p",{className:"text-sm text-red-600 mb-3 animate-pulse",children:"(\u5168\u4f53\u5236\u9650\u6642\u9593\u5207\u308c\u306b\u3088\u308a\u7d42\u4e86)"}),(0,Xn.jsx)("ul",{className:"space-y-2 text-left text-sm max-h-[50vh] overflow-y-auto pr-2",children:d.map(((e,t)=>(0,Xn.jsxs)("li",{className:"p-3 rounded-md shadow-sm ".concat(e.id===r?"bg-blue-100 ring-2 ring-blue-600":"bg-gray-50 border"),children:[(0,Xn.jsxs)("div",{className:"flex justify-between items-center mb-1",children:[(0,Xn.jsxs)("span",{className:"font-bold text-lg text-indigo-700",children:[e.rank||t+1,"\u4f4d: ",e.id.substring(0,8),"..."]}),(0,Xn.jsxs)("span",{className:"font-bold text-xl text-indigo-700",children:[e.score||0," pt"]})]}),e.secretObjective&&(0,Xn.jsxs)("div",{className:"text-xs mt-1 pl-1 border-l-2 border-purple-200",children:[(0,Xn.jsx)("span",{className:"font-semibold text-purple-600",children:"\u79d8\u5bc6\u76ee\u6a19:"})," ",e.secretObjective.text,e.secretObjective.achieved?(0,Xn.jsx)(Zn,{size:14,className:"inline ml-1 text-green-500",title:"\u9054\u6210\u6e08"}):(0,Xn.jsx)(er,{size:14,className:"inline ml-1 text-red-500",title:"\u672a\u9054\u6210"}),e.secretObjective.achieved&&(0,Xn.jsxs)("span",{className:"text-green-600 font-semibold",children:[" (+",e.secretObjective.points,"pt)"]})]}),e.personalTimeUsed>Vn&&"extra"===n.gameType&&(0,Xn.jsxs)("p",{className:"text-xs text-red-600 pl-1 mt-0.5",children:[(0,Xn.jsx)(gr,{size:12,className:"inline"})," \u6642\u9593\u8d85\u904e\u30da\u30ca\u30eb\u30c6\u30a3: ",-5*Math.floor((e.personalTimeUsed-Vn)/30),"pt"]})]},e.id)))})]}),(0,Xn.jsxs)("div",{className:"space-y-3",children:[o&&(0,Xn.jsx)("button",{onClick:()=>{i(),a&&a()},className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg text-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",children:"\u611f\u60f3\u6226\u30e2\u30fc\u30c9\u3078"}),(0,Xn.jsx)("button",{onClick:()=>{i(),s&&s()},className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-4 rounded-lg text-lg transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-opacity-50",children:"\u30db\u30fc\u30e0\u306b\u623b\u308b"})]})]})})},vr=Pn("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),br=Pn("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]),wr=Pn("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),xr=Pn("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),_r=e=>{var t,n,i,s,a,o;let{gameData:l,mazeData:c,allMazeData:u={},userId:d,gameId:h,onExit:f}=e;const[p,m]=(0,r.useState)("both"),[g,y]=(0,r.useState)([]),[v,b]=(0,r.useState)(""),w=(0,r.useRef)(null),x=Kn()||"\u672a\u8a2d\u5b9a\u30e6\u30fc\u30b6\u30fc",_=l.players||[],[S,E]=(0,r.useState)((()=>{var e;const t=null===(e=l.playerStates)||void 0===e?void 0:e[d];return(null===t||void 0===t?void 0:t.assignedMazeOwnerId)||_[0]||d})),k=(0,r.useMemo)((()=>{console.log("\ud83d\udd0d [ReviewMode Debug] allMazeData:",u),console.log("\ud83d\udd0d [ReviewMode Debug] selectedMazeOwner:",S),console.log("\ud83d\udd0d [ReviewMode Debug] mazeData:",c);let e=u[S];return!e&&c&&(e=c),!e&&null!==l&&void 0!==l&&l.mazes&&(e=l.mazes[S]),console.log("\ud83d\udd0d [ReviewMode Debug] currentDisplayMaze:",e),e}),[u,S,c,null===l||void 0===l?void 0:l.mazes]);(0,r.useEffect)((()=>{w.current&&(w.current.scrollTop=w.current.scrollHeight)}),[g]),(0,r.useEffect)((()=>{if(!h)return void console.log("\ud83d\udd0d [ReviewMode] gameId is not available, chat function will be limited");const e=(0,wn.rJ)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames/").concat(h,"/chatMessages")),t=(0,wn.P)(e,(0,wn.My)("timestamp","asc"),(0,wn.AB)(100)),n=(0,wn.aQ)(t,(e=>{const t=e.docs.map((e=>(0,Tn.A)({id:e.id},e.data())));y(t)}),(e=>{console.error("\u274c [ReviewMode] Error loading chat messages:",e)}));return()=>n()}),[h]);const T=async()=>{if(!v.trim()||!h)return void console.log("\ud83d\udd0d [ReviewMode Chat] Cannot send message:",{chatInput:v,gameId:h,isEmpty:!v.trim()});console.log("\ud83d\udd0d [ReviewMode Chat] Sending message:",{chatInput:v,gameId:h,userId:d,currentUserName:x});const e=(0,wn.rJ)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames/").concat(h,"/chatMessages"));try{await(0,wn.gS)(e,{senderId:d,senderName:x,text:v,timestamp:(0,wn.serverTimestamp)()}),console.log("\u2705 [ReviewMode Chat] Message sent successfully"),b("")}catch(t){console.error("\u274c [ReviewMode Chat] Error sending review chat message:",t),alert("\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u9001\u4fe1\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u3082\u3046\u4e00\u5ea6\u304a\u8a66\u3057\u304f\u3060\u3055\u3044\u3002")}},I=(0,r.useMemo)((()=>{if(!l||!l.playerStates)return null;const e=_.find((e=>{const t=l.playerStates[e];return(null===t||void 0===t?void 0:t.assignedMazeOwnerId)===S}));return e?l.playerStates[e]:l.playerStates[S]}),[_,l,S]);if(!l||!l.playerStates)return(0,Xn.jsx)("div",{className:"max-w-7xl mx-auto p-4 bg-gray-100 min-h-screen",children:(0,Xn.jsx)("div",{className:"text-center",children:(0,Xn.jsx)("p",{className:"text-gray-500",children:"\u30c7\u30fc\u30bf\u3092\u8aad\u307f\u8fbc\u307f\u4e2d..."})})});l.playerStates[d];return(0,Xn.jsxs)("div",{className:"max-w-7xl mx-auto p-4 bg-gray-100 min-h-screen",children:[(0,Xn.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4",children:[(0,Xn.jsxs)("div",{className:"flex justify-between items-center",children:[(0,Xn.jsxs)("h1",{className:"text-2xl font-bold text-gray-800 flex items-center",children:[(0,Xn.jsx)(vr,{size:24,className:"mr-2 text-blue-600"}),"\u611f\u60f3\u6226\u30e2\u30fc\u30c9 - \u5168\u4f53\u632f\u308a\u8fd4\u308a"]}),(0,Xn.jsxs)("button",{onClick:()=>{console.log("\ud83d\udeaa [ReviewMode] Exit button clicked"),f&&f()},className:"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded flex items-center",children:[(0,Xn.jsx)(ar,{size:16,className:"mr-2"}),"\u7d42\u4e86"]})]}),(0,Xn.jsxs)("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:[(0,Xn.jsx)("h3",{className:"font-semibold text-blue-800 mb-2",children:"\ud83c\udf89 \u30b2\u30fc\u30e0\u7d50\u679c"}),(0,Xn.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:_.map(((e,t)=>{const n=l.playerStates[e],r=e===d?x:"\u30d7\u30ec\u30a4\u30e4\u30fc".concat(t+1);return(0,Xn.jsxs)("div",{className:"bg-white p-3 rounded border",children:[(0,Xn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Xn.jsx)("span",{className:"font-semibold",children:r}),(null===n||void 0===n?void 0:n.goalTime)&&(0,Xn.jsx)("span",{className:"text-green-600 font-bold",children:"\u30b4\u30fc\u30eb\u9054\u6210!"})]}),(0,Xn.jsxs)("div",{className:"text-sm text-gray-600 mt-1",children:["4player"===(null===l||void 0===l?void 0:l.mode)&&(0,Xn.jsxs)("p",{children:["\u30b9\u30b3\u30a2: ",(null===n||void 0===n?void 0:n.score)||0,"pt"]}),(0,Xn.jsxs)("p",{children:["\u5230\u9054\u30de\u30b9\u6570: ",Object.keys((null===n||void 0===n?void 0:n.revealedCells)||{}).length]})]})]},e)}))})]})]}),(0,Xn.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,Xn.jsx)("div",{className:"lg:col-span-2",children:(0,Xn.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,Xn.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,Xn.jsxs)("h2",{className:"text-lg font-semibold flex items-center",children:[(0,Xn.jsx)(br,{size:20,className:"mr-2"}),"\u8ff7\u8def\u5168\u4f53\u56f3\uff08\u5168\u3066\u306e\u58c1\u3092\u8868\u793a\uff09"]}),(0,Xn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Xn.jsx)("span",{className:"text-sm text-gray-600",children:"\u8868\u793a\u3059\u308b\u8ff7\u8def:"}),(0,Xn.jsx)("select",{value:S,onChange:e=>E(e.target.value),className:"px-3 py-1 border border-gray-300 rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:_.map(((e,t)=>{const n=e===d?x:"\u30d7\u30ec\u30a4\u30e4\u30fc".concat(t+1);return(0,Xn.jsxs)("option",{value:e,children:[n,"\u306e\u8ff7\u8def"]},e)}))})]})]}),k&&k.walls?(0,Xn.jsxs)("div",{className:"relative",children:[(0,Xn.jsxs)("div",{className:"mb-3 p-3 bg-gray-50 rounded-lg",children:[(0,Xn.jsx)("h4",{className:"font-semibold text-gray-700 mb-2",children:"\u8868\u793a\u306e\u8aac\u660e"}),(0,Xn.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,Xn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Xn.jsx)("div",{className:"w-4 h-4 bg-yellow-200 border-2 border-yellow-400 rounded"}),(0,Xn.jsx)("span",{children:"\u901a\u3063\u305f\u7d4c\u8def"})]}),(0,Xn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Xn.jsx)("div",{className:"w-4 h-4 border-t-4 border-red-500"}),(0,Xn.jsx)("span",{children:"\u3076\u3064\u304b\u3063\u305f\u58c1\uff08\u8d64\uff09"})]}),(0,Xn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Xn.jsx)("div",{className:"w-4 h-4 bg-blue-500 rounded-full"}),(0,Xn.jsx)("span",{children:"\u30d7\u30ec\u30a4\u30e4\u30fc\u6700\u7d42\u4f4d\u7f6e"})]}),(0,Xn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Xn.jsx)("div",{className:"w-4 h-4 bg-red-500 rounded-full"}),(0,Xn.jsx)("span",{children:"\u30b4\u30fc\u30eb"})]})]})]}),!1,(0,Xn.jsx)("div",{className:"flex justify-center",children:(0,Xn.jsxs)("div",{className:"flex flex-col",children:[(0,Xn.jsxs)("div",{className:"flex mb-1",children:[(0,Xn.jsx)("div",{className:"".concat((()=>{const e=k.gridSize||6;return e>10?"w-7 h-7 md:w-8 md:h-8":e>7?"w-8 h-8 md:w-10 md:h-10":"w-12 h-12 md:w-16 md:h-16"})())}),Array.from({length:k.gridSize||6},((e,t)=>String.fromCharCode(65+t))).map((e=>(0,Xn.jsx)("div",{className:"".concat((()=>{const e=k.gridSize||6;return e>10?"w-7 h-7 md:w-8 md:h-8":e>7?"w-8 h-8 md:w-10 md:h-10":"w-12 h-12 md:w-16 md:h-16"})()," flex items-center justify-center text-xs md:text-sm font-semibold text-gray-600 border border-transparent"),children:e},e)))]}),(0,Xn.jsxs)("div",{className:"flex",children:[(0,Xn.jsx)("div",{className:"flex flex-col mr-1",children:Array.from({length:k.gridSize||6},((e,t)=>t+1)).map((e=>(0,Xn.jsx)("div",{className:"".concat((()=>{const e=k.gridSize||6;return e>10?"w-7 h-7 md:w-8 md:h-8":e>7?"w-8 h-8 md:w-10 md:h-10":"w-12 h-12 md:w-16 md:h-16"})()," flex items-center justify-center text-xs md:text-sm font-semibold text-gray-600 border border-transparent"),children:e},e)))}),(0,Xn.jsx)(rr,{mazeData:k,playerPosition:null===I||void 0===I?void 0:I.position,otherPlayers:[],revealedCells:(null===I||void 0===I?void 0:I.revealedCells)||{},revealedPlayerWalls:((null===k||void 0===k?void 0:k.walls)||[]).filter((e=>!0===e.active)),hitWalls:(null===I||void 0===I?void 0:I.hitWalls)||[],onCellClick:()=>{},gridSize:(null===k||void 0===k?void 0:k.gridSize)||6,sharedWallsFromAllies:[],highlightPlayer:!0,smallView:!1,showAllWalls:!0})]})]})}),(0,Xn.jsxs)("div",{className:"mt-4 p-3 bg-blue-50 rounded",children:[(0,Xn.jsxs)("h4",{className:"font-semibold text-blue-800 mb-2",children:[S===d?x:"\u30d7\u30ec\u30a4\u30e4\u30fc".concat(_.indexOf(S)+1),"\u306e\u8ff7\u8def"]}),(0,Xn.jsxs)("div",{className:"text-sm text-blue-700 space-y-1",children:[(0,Xn.jsxs)("p",{children:["\u2022 \u7dcf\u58c1\u6570: ",(null===(t=k.walls)||void 0===t?void 0:t.length)||0,"\u500b"]}),(0,Xn.jsxs)("p",{children:["\u2022 \u30a2\u30af\u30c6\u30a3\u30d6\u58c1\u6570: ",(k.walls||[]).filter((e=>!0===e.active)).length,"\u500b"]}),(0,Xn.jsxs)("p",{children:["\u2022 \u30b4\u30fc\u30eb\u4f4d\u7f6e: (",(null===(n=k.goal)||void 0===n?void 0:n.r)||0,", ",(null===(i=k.goal)||void 0===i?void 0:i.c)||0,")"]}),(0,Xn.jsxs)("p",{children:["\u2022 \u4f5c\u6210\u8005: ",S===d?x:"\u30d7\u30ec\u30a4\u30e4\u30fc".concat(_.indexOf(S)+1)]})]}),I&&(0,Xn.jsxs)("div",{className:"mt-3 pt-3 border-t border-blue-200",children:[(0,Xn.jsx)("h5",{className:"font-semibold text-blue-800 mb-2",children:"\u653b\u7565\u7d50\u679c"}),(0,Xn.jsxs)("div",{className:"text-sm text-blue-700 space-y-1",children:[(0,Xn.jsxs)("p",{children:["\u2022 \u653b\u7565\u8005: ",(()=>{const e=_.find((e=>{var t;return(null===(t=l.playerStates[e])||void 0===t?void 0:t.assignedMazeOwnerId)===S}));return e===d?x:"\u30d7\u30ec\u30a4\u30e4\u30fc".concat(_.indexOf(e)+1)})()]}),(0,Xn.jsxs)("p",{children:["\u2022 \u898b\u3064\u3051\u305f\u30de\u30b9\u306e\u6570: ",Object.keys(I.revealedCells||{}).length,"\u500b"]}),(0,Xn.jsxs)("p",{children:["\u2022 \u6700\u7d42\u4f4d\u7f6e: (",(null===(s=I.position)||void 0===s?void 0:s.r)||0,", ",(null===(a=I.position)||void 0===a?void 0:a.c)||0,")"]}),(0,Xn.jsxs)("p",{children:["\u2022 \u3076\u3064\u304b\u3063\u305f\u58c1: ",(I.hitWalls||[]).length,"\u500b"]}),(0,Xn.jsxs)("p",{children:["\u2022 \u30b4\u30fc\u30eb\u9054\u6210: ",I.goalTime?"\u2705 \u9054\u6210":"\u274c \u672a\u9054\u6210"]}),"4player"===(null===l||void 0===l?void 0:l.mode)&&I.goalTime&&(0,Xn.jsxs)("p",{children:["\u30b9\u30b3\u30a2: ",(null===I||void 0===I?void 0:I.score)||0,"pt"]})]})]})]})]}):(0,Xn.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,Xn.jsx)(br,{size:48,className:"mx-auto mb-4 opacity-50"}),(0,Xn.jsx)("p",{className:"mb-2",children:"\u9078\u629e\u3055\u308c\u305f\u8ff7\u8def\u30c7\u30fc\u30bf\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093"}),(0,Xn.jsx)("p",{className:"text-sm",children:"\u5225\u306e\u8ff7\u8def\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044"}),!1]}),(0,Xn.jsxs)("div",{className:"mt-4 p-3 bg-gray-50 rounded",children:[(0,Xn.jsx)("h4",{className:"font-semibold mb-2",children:"\u30d7\u30ec\u30a4\u30e4\u30fc\u306e\u52d5\u304d"}),(0,Xn.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:_.map(((e,t)=>{const n=l.playerStates[e],r=e===d?x:"\u30d7\u30ec\u30a4\u30e4\u30fc".concat(t+1),i=Object.keys((null===n||void 0===n?void 0:n.revealedCells)||{}).length;return(0,Xn.jsxs)("div",{className:"flex justify-between",children:[(0,Xn.jsxs)("span",{children:[r,":"]}),(0,Xn.jsxs)("span",{className:"text-blue-600",children:[i,"\u30bb\u30eb\u63a2\u7d22"]})]},e)}))})]})]})}),(0,Xn.jsx)("div",{className:"lg:col-span-1",children:(0,Xn.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,Xn.jsxs)("h2",{className:"text-lg font-semibold mb-4 flex items-center",children:[(0,Xn.jsx)(Ln,{size:20,className:"mr-2"}),"\u611f\u60f3\u6226\u30c1\u30e3\u30c3\u30c8"]}),(0,Xn.jsx)("div",{className:"h-64 overflow-y-auto border rounded-lg p-3 mb-4 bg-gray-50",ref:w,children:0===g.length?(0,Xn.jsxs)("div",{className:"text-center text-gray-500 py-8",children:[(0,Xn.jsx)(Ln,{size:32,className:"mx-auto mb-2 opacity-50"}),(0,Xn.jsx)("p",{children:"\u307e\u3060\u30e1\u30c3\u30bb\u30fc\u30b8\u304c\u3042\u308a\u307e\u305b\u3093"}),(0,Xn.jsx)("p",{className:"text-sm",children:"\u611f\u60f3\u3092\u30b7\u30a7\u30a2\u3057\u307e\u3057\u3087\u3046\uff01"})]}):(0,Xn.jsx)("div",{className:"space-y-2",children:g.map((e=>(0,Xn.jsxs)("div",{className:"p-2 rounded-lg max-w-[80%] ".concat(e.senderId===d?"bg-blue-100 text-blue-800 ml-auto":"bg-white border"),children:[(0,Xn.jsx)("div",{className:"text-xs text-gray-500 mb-1",children:e.senderName}),(0,Xn.jsx)("div",{className:"text-sm",children:e.text})]},e.id)))})}),(0,Xn.jsxs)("div",{className:"flex space-x-2",children:[(0,Xn.jsx)("input",{type:"text",value:v,onChange:e=>b(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),T())},placeholder:h?"\u611f\u60f3\u3092\u5165\u529b...":"\u30c1\u30e3\u30c3\u30c8\u6a5f\u80fd\u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\uff08\u30b2\u30fc\u30e0ID\u4e0d\u660e\uff09",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!h}),(0,Xn.jsx)("button",{onClick:T,disabled:!v.trim()||!h,className:"bg-blue-500 text-white px-3 py-2 rounded-lg hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed",children:(0,Xn.jsx)(wr,{size:16})})]}),(0,Xn.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,Xn.jsx)("h4",{className:"text-sm font-semibold text-gray-700",children:"\u611f\u60f3\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8:"}),(0,Xn.jsx)("div",{className:"grid grid-cols-1 gap-1",children:["\u9762\u767d\u3044\u30b2\u30fc\u30e0\u3067\u3057\u305f\uff01","\u8ff7\u8def\u306e\u8a2d\u8a08\u304c\u5de7\u5999\u3067\u3057\u305f","\u307e\u305f\u30d7\u30ec\u30a4\u3057\u307e\u3057\u3087\u3046\uff01","\u826f\u3044\u6226\u7565\u3067\u3057\u305f\u306d","\u6b21\u56de\u306f\u8ca0\u3051\u307e\u305b\u3093\uff01"].map(((e,t)=>(0,Xn.jsxs)("button",{onClick:()=>b(e),className:"text-left text-xs text-blue-600 hover:text-blue-800 hover:bg-blue-50 p-1 rounded",children:['"',e,'"']},t)))})]})]})})]}),(0,Xn.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 mt-4",children:[(0,Xn.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center",children:[(0,Xn.jsx)(xr,{size:18,className:"mr-2"}),"\u30b2\u30fc\u30e0\u5206\u6790"]}),(0,Xn.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,Xn.jsxs)("div",{children:[(0,Xn.jsx)("h4",{className:"font-semibold text-gray-700 mb-2",children:"\u8ff7\u8def\u306e\u7279\u5fb4"}),(0,Xn.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[(0,Xn.jsxs)("li",{children:["\u2022 \u7dcf\u58c1\u6570: ",(null===k||void 0===k||null===(o=k.walls)||void 0===o?void 0:o.length)||0,"\u500b"]}),(0,Xn.jsxs)("li",{children:["\u2022 \u30a2\u30af\u30c6\u30a3\u30d6\u58c1\u6570: ",((null===k||void 0===k?void 0:k.walls)||[]).filter((e=>!0===e.active)).length,"\u500b"]}),(0,Xn.jsxs)("li",{children:["\u2022 \u30b4\u30fc\u30eb\u5230\u9054\u7387: ",_.filter((e=>{var t;return null===(t=l.playerStates[e])||void 0===t?void 0:t.goalTime})).length,"/",_.length]})]})]}),(0,Xn.jsxs)("div",{children:[(0,Xn.jsx)("h4",{className:"font-semibold text-gray-700 mb-2",children:"\u30d7\u30ec\u30a4\u30e4\u30fc\u5206\u6790"}),(0,Xn.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[(0,Xn.jsxs)("li",{children:["\u2022 \u5e73\u5747\u63a2\u7d22\u30bb\u30eb\u6570: ",Math.round(_.reduce(((e,t)=>{var n;return e+Object.keys((null===(n=l.playerStates[t])||void 0===n?void 0:n.revealedCells)||{}).length}),0)/_.length)]}),(0,Xn.jsxs)("li",{children:["\u2022 \u6700\u9ad8\u30b9\u30b3\u30a2: ",Math.max(..._.map((e=>{var t;return(null===(t=l.playerStates[e])||void 0===t?void 0:t.score)||0})))]}),(0,Xn.jsx)("li",{children:"\u2022 \u63a2\u7d22\u52b9\u7387: \u826f\u597d"})]})]}),(0,Xn.jsxs)("div",{children:[(0,Xn.jsx)("h4",{className:"font-semibold text-gray-700 mb-2",children:"\u6539\u5584\u30dd\u30a4\u30f3\u30c8"}),(0,Xn.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[(0,Xn.jsx)("li",{children:"\u2022 \u3088\u308a\u52b9\u7387\u7684\u306a\u63a2\u7d22\u30eb\u30fc\u30c8"}),(0,Xn.jsx)("li",{children:"\u2022 \u6226\u7565\u7684\u306a\u8ff7\u8def\u8a2d\u8a08"}),(0,Xn.jsx)("li",{children:"\u2022 \u30d7\u30ec\u30a4\u30e4\u30fc\u9593\u306e\u99c6\u3051\u5f15\u304d"})]})]})]})]})]})},Sr=e=>{let{chatMessages:t,chatInput:n,setChatInput:r,handleSendChatMessage:i,onShowHelp:s,onShowTemplate:a,chatLogRef:o,isInBattle:l=!1,title:c="\u30aa\u30fc\u30d7\u30f3\u30c1\u30e3\u30c3\u30c8"}=e;return l?(0,Xn.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4 h-full",children:[(0,Xn.jsxs)("h4",{className:"text-lg font-semibold mb-3 flex items-center",children:[(0,Xn.jsx)(cr,{size:20,className:"mr-2 text-red-600"}),"\u30d0\u30c8\u30eb\u4e2d - \u30af\u30ed\u30fc\u30ba\u30c1\u30e3\u30c3\u30c8"]}),(0,Xn.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg text-center",children:[(0,Xn.jsx)("p",{className:"text-red-600 font-semibold mb-2",children:"\u2694\ufe0f \u30d0\u30c8\u30eb\u767a\u751f\uff01"}),(0,Xn.jsx)("p",{className:"text-sm text-red-500",children:"\u30dd\u30a4\u30f3\u30c8\u3092\u8ced\u3051\u3066\u304f\u3060\u3055\u3044"}),(0,Xn.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:"\u30c1\u30e3\u30c3\u30c8\u306f\u4e00\u6642\u7684\u306b\u5229\u7528\u3067\u304d\u307e\u305b\u3093"})]})]}):(0,Xn.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,Xn.jsxs)("h4",{className:"text-lg font-semibold mb-3 flex items-center",children:[(0,Xn.jsx)(Ln,{size:20,className:"mr-2"}),c,(0,Xn.jsx)("button",{className:"ml-auto text-blue-500 hover:text-blue-700 text-xl focus:outline-none",title:"\u30d8\u30eb\u30d7",onClick:s,children:"\u2753"})]}),(0,Xn.jsx)("div",{ref:o,className:"bg-gray-50 p-3 rounded-lg h-40 overflow-y-auto text-sm mb-3 border",children:t.map((e=>(0,Xn.jsxs)("div",{className:"mb-2 ".concat("system"===e.senderId?"text-blue-600 font-semibold":""),children:[(0,Xn.jsxs)("span",{className:"font-medium",children:[e.senderName,":"]})," ",e.text]},e.id)))}),(0,Xn.jsxs)("div",{className:"flex space-x-2",children:[(0,Xn.jsx)("input",{type:"text",value:n,onChange:e=>r(e.target.value),onKeyPress:e=>"Enter"===e.key&&i(),className:"flex-1 px-3 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u5165\u529b..."}),(0,Xn.jsx)("button",{onClick:a||s,className:"bg-gray-100 hover:bg-gray-200 text-gray-600 px-3 py-2 rounded-lg transition-colors",title:"\u767a\u8a00\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8",children:"\u2753"}),(0,Xn.jsx)("button",{onClick:i,className:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors",disabled:!n.trim(),children:(0,Xn.jsx)(wr,{size:16})})]})]})},Er=Pn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),kr=e=>{let{isOpen:t,onClose:n,onSelectTemplate:r}=e;if(!t)return null;return(0,Xn.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,Xn.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[80vh] overflow-hidden",children:[(0,Xn.jsxs)("div",{className:"flex items-center justify-between p-4 border-b bg-blue-50",children:[(0,Xn.jsxs)("h2",{className:"text-xl font-bold text-gray-800 flex items-center",children:[(0,Xn.jsx)(Ln,{className:"mr-2 text-blue-600",size:24}),"\u767a\u8a00\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8"]}),(0,Xn.jsx)("button",{onClick:n,className:"text-gray-500 hover:text-gray-700 transition-colors",children:(0,Xn.jsx)(Er,{size:24})})]}),(0,Xn.jsxs)("div",{className:"p-4 overflow-y-auto max-h-[60vh]",children:[(0,Xn.jsx)("p",{className:"text-gray-600 mb-4 text-sm",children:"\u4ee5\u4e0b\u306e\u30c6\u30f3\u30d7\u30ec\u30fc\u30c8\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u3001\u30c1\u30e3\u30c3\u30c8\u306b\u5165\u529b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"}),(0,Xn.jsx)("div",{className:"space-y-6",children:[{category:"\u8cea\u554f\u30fb\u78ba\u8a8d",items:["\u3069\u3053\u306b\u3044\u307e\u3059\u304b\uff1f","\u3069\u3061\u3089\u306e\u65b9\u5411\u306b\u5411\u304b\u3063\u3066\u3044\u307e\u3059\u304b\uff1f","\u30b4\u30fc\u30eb\u306f\u898b\u3064\u304b\u308a\u307e\u3057\u305f\u304b\uff1f","\u73fe\u5728\u306e\u30b9\u30b3\u30a2\u306f\u3069\u306e\u304f\u3089\u3044\u3067\u3059\u304b\uff1f","\u58c1\u306b\u963b\u307e\u308c\u3066\u3044\u307e\u305b\u3093\u304b\uff1f"]},{category:"\u60c5\u5831\u5171\u6709",items:["\u30b4\u30fc\u30eb\u3092\u767a\u898b\u3057\u307e\u3057\u305f\uff01","\u3053\u306e\u65b9\u5411\u306f\u884c\u304d\u6b62\u307e\u308a\u3067\u3059","\u25cb\u25cb\u306e\u4f4d\u7f6e\u306b\u58c1\u304c\u3042\u308a\u307e\u3059","\u30b9\u30bf\u30fc\u30c8\u5730\u70b9\u306b\u623b\u308a\u307e\u3057\u305f","\u9806\u8abf\u306b\u9032\u3093\u3067\u3044\u307e\u3059"]},{category:"\u4f5c\u6226\u30fb\u5354\u529b",items:["\u4e00\u7dd2\u306b\u63a2\u7d22\u3057\u307e\u305b\u3093\u304b\uff1f","\u3053\u306e\u9053\u3092\u8a66\u3057\u3066\u307f\u307e\u3057\u3087\u3046","\u5225\u3005\u306e\u9053\u3092\u63a2\u7d22\u3057\u307e\u3057\u3087\u3046","\u60c5\u5831\u3092\u5171\u6709\u3057\u307e\u3057\u3087\u3046","\u9811\u5f35\u308a\u307e\u3057\u3087\u3046\uff01"]},{category:"\u30ea\u30a2\u30af\u30b7\u30e7\u30f3",items:["\u304a\u75b2\u308c\u69d8\u3067\u3059\uff01","\u30ca\u30a4\u30b9\u30d7\u30ec\u30a4\uff01","\u3059\u3054\u3044\u3067\u3059\u306d\uff01","\u9811\u5f35\u3063\u3066\uff01","\u3042\u308a\u304c\u3068\u3046\u3054\u3056\u3044\u307e\u3059\uff01"]}].map(((e,t)=>(0,Xn.jsxs)("div",{children:[(0,Xn.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-3 border-b border-gray-200 pb-2",children:e.category}),(0,Xn.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:e.items.map(((e,t)=>(0,Xn.jsx)("button",{onClick:()=>(e=>{r(e),n()})(e),className:"text-left p-3 bg-gray-50 hover:bg-blue-50 border border-gray-200 hover:border-blue-300 rounded-lg transition-colors text-sm",children:e},t)))})]},t)))})]}),(0,Xn.jsx)("div",{className:"p-4 border-t bg-gray-50 text-center",children:(0,Xn.jsx)("button",{onClick:n,className:"bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg transition-colors",children:"\u9589\u3058\u308b"})})]})})},Tr=Pn("Bug",[["path",{d:"m8 2 1.88 1.88",key:"fmnt4t"}],["path",{d:"M14.12 3.88 16 2",key:"qol33r"}],["path",{d:"M9 7.13v-1a3.003 3.003 0 1 1 6 0v1",key:"d7y7pr"}],["path",{d:"M12 20c-3.3 0-6-2.7-6-6v-3a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v3c0 3.3-2.7 6-6 6",key:"xs1cw7"}],["path",{d:"M12 20v-9",key:"1qisl0"}],["path",{d:"M6.53 9C4.6 8.8 3 7.1 3 5",key:"32zzws"}],["path",{d:"M6 13H2",key:"82j7cp"}],["path",{d:"M3 21c0-2.1 1.7-3.9 3.8-4",key:"4p0ekp"}],["path",{d:"M20.97 5c0 2.1-1.6 3.8-3.5 4",key:"18gb23"}],["path",{d:"M22 13h-4",key:"1jl80f"}],["path",{d:"M17.2 17c2.1.1 3.8 1.9 3.8 4",key:"k3fwyw"}]]),Ir=Pn("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),Nr=Pn("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),Cr=e=>{var t,n;let{debugMode:r,gameData:i,debugCurrentPlayerId:s,setDebugCurrentPlayerId:a,showOpponentWallsDebug:o,setShowOpponentWallsDebug:l,debugPlayerStates:c,userId:u,onPlayerSwitch:d}=e;if(!r)return null;const h=(null===i||void 0===i?void 0:i.players)||[];return(0,Xn.jsxs)("div",{className:"fixed top-4 right-4 bg-yellow-100 border-2 border-yellow-400 rounded-lg p-4 shadow-lg z-50 max-w-xs",children:[(0,Xn.jsxs)("div",{className:"flex items-center mb-3",children:[(0,Xn.jsx)(Tr,{className:"mr-2 text-yellow-700",size:20}),(0,Xn.jsx)("h3",{className:"font-bold text-yellow-800",children:"\ud83d\udd27 \u30c7\u30d0\u30c3\u30b0\u30e2\u30fc\u30c9"})]}),(0,Xn.jsxs)("div",{className:"space-y-3",children:[(0,Xn.jsxs)("div",{className:"space-y-2",children:[(0,Xn.jsxs)("label",{className:"flex items-center text-sm font-medium text-yellow-800",children:[(0,Xn.jsx)(On,{className:"mr-1",size:14}),"\u64cd\u4f5c\u30d7\u30ec\u30a4\u30e4\u30fc:"]}),(0,Xn.jsx)("select",{value:s,onChange:e=>{a(e.target.value),d&&d(e.target.value)},className:"w-full p-2 text-xs border border-yellow-400 rounded bg-white",children:h.map((e=>(0,Xn.jsxs)("option",{value:e,children:[e===u?"\u3042\u306a\u305f":"".concat(e.substring(0,8),"..."),e===(null===i||void 0===i?void 0:i.currentTurnPlayerId)?" (\u30bf\u30fc\u30f3\u4e2d)":""]},e)))})]}),c[s]&&(0,Xn.jsx)("div",{className:"p-2 bg-white rounded border",children:(0,Xn.jsxs)("div",{className:"text-xs text-gray-600",children:[(0,Xn.jsx)("div",{className:"font-medium mb-1",children:"\u9078\u629e\u4e2d\u30d7\u30ec\u30a4\u30e4\u30fc\u60c5\u5831:"}),(0,Xn.jsxs)("div",{children:["\u4f4d\u7f6e: (",(null===(t=c[s].position)||void 0===t?void 0:t.r)||0,", ",(null===(n=c[s].position)||void 0===n?void 0:n.c)||0,")"]}),(0,Xn.jsxs)("div",{children:["\u30dd\u30a4\u30f3\u30c8: ",c[s].score||0,"pt"]}),c[s].goalTime&&(0,Xn.jsx)("div",{className:"text-green-600",children:"\u2713 \u30b4\u30fc\u30eb\u9054\u6210\u6e08\u307f"})]})}),(0,Xn.jsx)("div",{className:"flex items-center space-x-2",children:(0,Xn.jsx)("button",{onClick:()=>l(!o),className:"flex items-center px-3 py-1 rounded text-xs transition-colors ".concat(o?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:o?(0,Xn.jsxs)(Xn.Fragment,{children:[(0,Xn.jsx)(xr,{className:"mr-1",size:12}),"\u58c1\u8868\u793aON"]}):(0,Xn.jsxs)(Xn.Fragment,{children:[(0,Xn.jsx)(Ir,{className:"mr-1",size:12}),"\u58c1\u8868\u793aOFF"]})})}),(0,Xn.jsx)("div",{className:"p-2 bg-white rounded border",children:(0,Xn.jsxs)("div",{className:"text-xs text-gray-600",children:[(0,Xn.jsx)("div",{className:"font-medium mb-1",children:"\u30b2\u30fc\u30e0\u72b6\u614b:"}),(0,Xn.jsxs)("div",{children:["\u30b9\u30c6\u30fc\u30bf\u30b9: ",null===i||void 0===i?void 0:i.status]}),(0,Xn.jsxs)("div",{children:["\u30e2\u30fc\u30c9: ",null===i||void 0===i?void 0:i.mode]}),(null===i||void 0===i?void 0:i.currentTurnPlayerId)&&(0,Xn.jsxs)("div",{children:["\u73fe\u5728\u306e\u30bf\u30fc\u30f3: ",i.currentTurnPlayerId.substring(0,8),"..."]}),(null===i||void 0===i?void 0:i.turnNumber)&&(0,Xn.jsxs)("div",{children:["\u30bf\u30fc\u30f3\u6570: ",i.turnNumber]}),(null===i||void 0===i?void 0:i.roundNumber)&&(0,Xn.jsxs)("div",{children:["\u30e9\u30a6\u30f3\u30c9: ",i.roundNumber]})]})}),(0,Xn.jsx)("div",{className:"p-2 bg-white rounded border",children:(0,Xn.jsxs)("div",{className:"text-xs text-gray-600",children:[(0,Xn.jsx)("div",{className:"font-medium mb-1",children:"\u5168\u30d7\u30ec\u30a4\u30e4\u30fc:"}),h.map((e=>{const t=c[e],n=(null===i||void 0===i?void 0:i.currentTurnPlayerId)===e,r=s===e;return(0,Xn.jsxs)("div",{className:"flex items-center justify-between py-1 px-1 rounded ".concat(r?"bg-blue-100":""),children:[(0,Xn.jsx)("span",{className:"".concat(n?"font-bold text-green-600":""),children:e===u?"\u3042\u306a\u305f":"".concat(e.substring(0,8),"...")}),(0,Xn.jsxs)("div",{className:"flex items-center space-x-1",children:[n&&(0,Xn.jsx)(Nr,{className:"text-green-500",size:10}),(null===t||void 0===t?void 0:t.goalTime)&&(0,Xn.jsx)("span",{className:"text-green-600",children:"\ud83c\udfaf"}),(null===t||void 0===t?void 0:t.inBattleWith)&&(0,Xn.jsx)("span",{className:"text-red-600",children:"\u2694\ufe0f"})]})]},e)}))]})}),(0,Xn.jsx)("div",{className:"text-xs text-yellow-700 bg-yellow-50 p-2 rounded border border-yellow-300",children:"\u26a0\ufe0f \u30c7\u30d0\u30c3\u30b0\u30e2\u30fc\u30c9\u3067\u306f\u30b2\u30fc\u30e0\u30d0\u30e9\u30f3\u30b9\u304c\u5909\u66f4\u3055\u308c\u307e\u3059"})]})]})},Ar=e=>{var t,n,i,s,a,o,l,c,u,d,h,f,p,m,g,y,v,b,w,x;let{userId:_,setScreen:S,gameMode:E,debugMode:k}=e;const[T,I]=(0,r.useState)(null),[N,C]=(0,r.useState)(null),[A,j]=(0,r.useState)(null),[D,P]=(0,r.useState)(null),[O,R]=(0,r.useState)(null),[M,L]=(0,r.useState)(null),[U,F]=(0,r.useState)("\u30b2\u30fc\u30e0\u958b\u59cb\uff01"),[z,V]=(0,r.useState)(!1),[B,G]=(0,r.useState)([]),[q,W]=(0,r.useState)(""),H=(0,r.useRef)(null),[K,Q]=(0,r.useState)(!1),[X,Y]=(0,r.useState)(null),[$,J]=(0,r.useState)("standard"),[Z,ee]=(0,r.useState)(null),[te,ne]=(0,r.useState)(null),[re,ie]=(0,r.useState)(null),[se,ae]=(0,r.useState)(null),[oe,le]=(0,r.useState)(null),[ce,ue]=(0,r.useState)({type:null,duration:null,conditions:""}),[de,he]=(0,r.useState)(!1),[fe,pe]=(0,r.useState)(null),[me,ge]=(0,r.useState)(!1),[ye,ve]=(0,r.useState)([]),[be,we]=(0,r.useState)([]),xe=(0,r.useRef)(null),[_e,Se]=(0,r.useState)(!1),[Ee,ke]=(0,r.useState)(null),[Te,Ie]=(0,r.useState)(!1),[Ne,Ce]=(0,r.useState)(!1),[Ae,je]=(0,r.useState)(!1),[De,Pe]=(0,r.useState)(!1),[Oe,Re]=(0,r.useState)(!1),[Me,Le]=(0,r.useState)(null),[Ue,Fe]=(0,r.useState)(!1),[ze,Ve]=(0,r.useState)([]),[Be,Ge]=(0,r.useState)(!0),[qe,We]=(0,r.useState)(!1),[He,Ke]=(0,r.useState)(!1),[Qe,Xe]=(0,r.useState)(""),[Ye,$e]=(0,r.useState)(!1),[Je,Ze]=(0,r.useState)([]),[et,tt]=(0,r.useState)(_),[nt,rt]=(0,r.useState)({}),[it,st]=(0,r.useState)({}),at=k?et:_,ot=k?nt[et]:A,lt=Kn()||"\u672a\u8a2d\u5b9a\u30e6\u30fc\u30b6\u30fc",ct=(null===N||void 0===N?void 0:N.playerNames)||{},ut=e=>{var t,n;if(e===at)return lt;if(null!==N&&void 0!==N&&null!==(t=N.playerStates)&&void 0!==t&&null!==(n=t[e])&&void 0!==n&&n.playerName)return N.playerStates[e].playerName;if(null!==N&&void 0!==N&&N.playerNames&&N.playerNames[e])return N.playerNames[e];if(e.startsWith("debug_player")){const t=e.charAt(12)||e.split("_")[2];return"\u30c7\u30d0\u30c3\u30b0\u30d7\u30ec\u30a4\u30e4\u30fc".concat(t)}return"\u30d7\u30ec\u30a4\u30e4\u30fc".concat(e.substring(0,8),"...")},dt=(null===N||void 0===N?void 0:N.currentTurnPlayerId)===(k?at:_)&&"standard"===$,ht=(null===(t=k?ot:A)||void 0===t?void 0:t.inBattleWith)&&"standard"===$;(0,r.useEffect)((()=>{var e;if(!N||!A)return;console.log("Loading maze data for game type:",$),console.log("Game data:",N),console.log("My player state:",A),k&&ot&&console.log("Debug effective player state:",ot),"4player"!==N.mode||X||Y(_);const t=k?ot:A;if(null!==t&&void 0!==t&&t.assignedMazeOwnerId&&N.mazes){const e=N.mazes[t.assignedMazeOwnerId];var n;if(e)console.log("\ud83d\uddfa\ufe0f [Maze] Maze to play loaded:",{mazeOwner:t.assignedMazeOwnerId,goalPosition:e.goal,startPosition:e.start,gridSize:e.gridSize,wallCount:(null===(n=e.walls)||void 0===n?void 0:n.length)||0,debugMode:k,effectiveUserId:at.substring(0,8)}),P(e);else console.warn("Assigned maze not found for:",t.assignedMazeOwnerId),F("\u5272\u308a\u5f53\u3066\u3089\u308c\u305f\u8ff7\u8def\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093: ".concat(t.assignedMazeOwnerId))}"standard"===$&&null!==(e=N.mazes)&&void 0!==e&&e[_]&&(console.log("My created maze loaded:",N.mazes[_]),R(N.mazes[_]))}),[N,A,_,$,F,X,k,ot]),(0,r.useEffect)((()=>{const e=k?ot:A;null!==e&&void 0!==e&&e.hitWalls&&Array.isArray(e.hitWalls)&&(Ve(e.hitWalls),console.log("\ud83d\udd27 [HitWalls] Synced from Firestore:",e.hitWalls),k&&console.log("\ud83d\udd27 [DEBUG] Showing walls for player:",at.substring(0,8)))}),[null===A||void 0===A?void 0:A.hitWalls,k,ot,at]),(0,r.useEffect)((()=>{k&&null!==N&&void 0!==N&&N.playerStates&&(rt(N.playerStates),console.log("\ud83d\udd27 [DEBUG] Player states updated:",N.playerStates))}),[k,null===N||void 0===N?void 0:N.playerStates]),(0,r.useEffect)((()=>{k&&null!==N&&void 0!==N&&N.mazes&&st(N.mazes)}),[k,null===N||void 0===N?void 0:N.mazes,et]);const ft=async e=>{var t,n;if(!(dt&&!ht)||Ue||!Be)return;console.log("\ud83d\udeb6 [Movement] Starting move:",{direction:e,debugMode:k,effectiveUserId:at.substring(0,8),actualUserId:_.substring(0,8),operatingAsUserId:k?at.substring(0,8):_.substring(0,8),currentPosition:null===(t=k?ot:A)||void 0===t?void 0:t.position,note:k?"Debug mode - operating as switched player":"Normal mode"}),Ge(!1);const r=k?ot:A,i=k?at:_;if(null!==r&&void 0!==r&&r.skipNextTurn){F("\u30d0\u30c8\u30eb\u6557\u5317\u306b\u3088\u308a1\u30bf\u30fc\u30f3\u884c\u52d5\u4e0d\u80fd\u3067\u3059\u3002");const e=(0,wn.doc)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),T);return await(0,wn.updateDoc)(e,{["playerStates.".concat(i,".skipNextTurn")]:null}),void("standard"===$&&setTimeout((()=>{kt()}),1500))}Fe(!0),F("\u79fb\u52d5\u4e2d..."),await new Promise((e=>setTimeout(e,2e3)));const s=(0,wn.doc)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),T),{r:a,c:o}=r.position;let l=a,c=o;switch(e){case"up":l--;break;case"down":l++;break;case"left":c--;break;case"right":c++;break;default:return Fe(!1),void Ge(!0)}const u=k&&null!==N&&void 0!==N&&null!==(n=N.mazes)&&void 0!==n&&n[null===r||void 0===r?void 0:r.assignedMazeOwnerId]?N.mazes[r.assignedMazeOwnerId]:D,d=(null===u||void 0===u?void 0:u.gridSize)||Fn;if(l<0||l>=d||c<0||c>=d)return F("\u76e4\u5916\u3078\u306e\u79fb\u52d5\u306f\u3067\u304d\u307e\u305b\u3093\u3002\u30bf\u30fc\u30f3\u7d42\u4e86\u3067\u3059\u3002"),Fe(!1),void("standard"===$&&setTimeout((()=>{kt()}),1500));const h=(null===u||void 0===u?void 0:u.walls)||[];let f=null;if(h.some((t=>{if(!t.active)return!1;if("horizontal"===t.type){if("up"===e&&t.r===a-1&&t.c===o)return f=t,!0;if("down"===e&&t.r===a&&t.c===o)return f=t,!0}else if("vertical"===t.type){if("left"===e&&t.r===a&&t.c===o-1)return f=t,!0;if("right"===e&&t.r===a&&t.c===o)return f=t,!0}return!1}))&&f){Ve((e=>{const t="".concat(f.type,"-").concat(f.r,"-").concat(f.c);return e.some((e=>"".concat(e.type,"-").concat(e.r,"-").concat(e.c)===t))?e:[...e,f]}));try{const e=(0,wn.doc)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),T),t={type:f.type,r:f.r,c:f.c,active:!0,discoveredAt:(new Date).toISOString()},n=(null===r||void 0===r?void 0:r.hitWalls)||[],s="".concat(f.type,"-").concat(f.r,"-").concat(f.c),a=n.some((e=>"".concat(e.type,"-").concat(e.r,"-").concat(e.c)===s)),o={["playerStates.".concat(i,".revealedWalls")]:(0,wn.hq)(t)};a||(o["playerStates.".concat(i,".hitWalls")]=[...n,f]),await(0,wn.updateDoc)(e,o),console.log("\ud83d\udd27 [HitWalls] Saved to Firestore:",f)}catch(v){console.error("Error recording hit wall:",v)}return F("\u58c1\u306b\u963b\u307e\u308c\u3066\u79fb\u52d5\u3067\u304d\u307e\u305b\u3093\u3002\u58c1\u3092\u767a\u898b\u3057\u307e\u3057\u305f\uff01 \u30bf\u30fc\u30f3\u7d42\u4e86\u3067\u3059\u3002"),Fe(!1),void("standard"===$&&setTimeout((()=>{kt()}),1500))}try{let e=null;if("4player"===(null===N||void 0===N?void 0:N.mode)){if(!(N.activeBattle&&N.activeBattle.status&&["betting","fighting"].includes(N.activeBattle.status))){const t=Object.entries(N.playerStates||{}).filter((e=>{let[t,n]=e;return t!==i&&n.position})).find((e=>{let[t,n]=e;return n.position.r===l&&n.position.c===c}));t&&(e=t[0],console.log("\ud83e\udd4a [Battle] Position collision detected:",{player1:_.substring(0,8),player2:e.substring(0,8),position:{r:l,c:c}}))}}const t={["playerStates.".concat(i,".position")]:{r:l,c:c},["playerStates.".concat(i,".lastMoveTime")]:(0,wn.serverTimestamp)()};let n="";if(r.revealedCells["".concat(l,"-").concat(c)]?(n="(".concat(l,",").concat(c,")\u306b\u79fb\u52d5\u3057\u307e\u3057\u305f\u3002"),F(n)):(t["playerStates.".concat(i,".score")]=(0,wn.GV)(1),t["playerStates.".concat(i,".revealedCells.").concat(l,"-").concat(c)]=!0,"4player"===(null===N||void 0===N?void 0:N.mode)?(n="(".concat(l,",").concat(c,")\u306b\u79fb\u52d5\uff01 +1pt"),F(n)):n="(".concat(l,",").concat(c,")\u306b\u79fb\u52d5\u3057\u307e\u3057\u305f\u3002")),console.log("\ud83d\udd0d [Goal Check]",{mazeToPlayData:!!u,playerPosition:{r:l,c:c},goalPosition:u?{r:u.goal.r,c:u.goal.c}:null,hasGoalTime:!!r.goalTime,debugMode:k,effectiveUserId:at.substring(0,8),operatingUserId:i.substring(0,8)}),u&&l===u.goal.r&&c===u.goal.c&&!r.goalTime){console.log("\ud83c\udfaf [Goal] Goal reached!",{playerPosition:{r:l,c:c},goalPosition:{r:u.goal.r,c:u.goal.c},mazeOwner:r.assignedMazeOwnerId,debugMode:k,effectiveUserId:at.substring(0,8),operatingUserId:i.substring(0,8)}),t["playerStates.".concat(i,".goalTime")]=(0,wn.serverTimestamp)(),t.goalCount=(0,wn.GV)(1);const e=N.goalCount||0;let n=0,s="";if("4player"===(null===N||void 0===N?void 0:N.mode)){n=[20,15,10,0][e]||0,n>0&&(t["playerStates.".concat(i,".score")]=(0,wn.GV)(n)),s="".concat(e+1,"\u4f4d\u3067\u30b4\u30fc\u30eb\u9054\u6210\uff01"),F("\u30b4\u30fc\u30eb\u9054\u6210\uff01".concat(e+1,"\u4f4d +").concat(n,"pt"))}else"2player"===(null===N||void 0===N?void 0:N.mode)?(s="\u30b4\u30fc\u30eb\u9054\u6210\uff01\u52dd\u5229\u3067\u3059\uff01",F("\ud83c\udf89 \u30b4\u30fc\u30eb\u9054\u6210\uff01\u52dd\u5229\u3067\u3059\uff01")):(s="\u30b4\u30fc\u30eb\u9054\u6210\uff01",F("\u30b4\u30fc\u30eb\u9054\u6210\uff01"));setTimeout((()=>{Le({isGoal:!0,rank:e+1,points:n,message:s,totalScore:(r.score||0)+n,goalTime:new Date}),Re(!0)}),1e3)}if(e&&"4player"===(null===N||void 0===N?void 0:N.mode)){var p,m,g,y;const n=N.playerStates[e],r=N.playerStates[i],s=(null===n||void 0===n?void 0:n.inBattleWith)||(null===(p=N.activeBattle)||void 0===p||null===(m=p.participants)||void 0===m?void 0:m.includes(e)),a=(null===r||void 0===r?void 0:r.inBattleWith)||(null===(g=N.activeBattle)||void 0===g||null===(y=g.participants)||void 0===y?void 0:y.includes(i));if(s||a)console.log("\u26a0\ufe0f [Battle] Cannot start battle - one or both players already in battle:",{currentPlayerInBattle:a,opponentInBattle:s});else{console.log("\ud83e\udd4a [Battle] Starting new battle:",{player1:i.substring(0,8),player2:e.substring(0,8),position:{r:l,c:c}}),t.activeBattle={participants:[i,e],startTime:(0,wn.serverTimestamp)(),status:"betting"},t["playerStates.".concat(i,".battleBet")]=null,t["playerStates.".concat(e,".battleBet")]=null,t["playerStates.".concat(i,".inBattleWith")]=e,t["playerStates.".concat(e,".inBattleWith")]=i;const n=ut(i),r=ut(e);xt("".concat(n,"\u3068").concat(r,"\u3067\u30d0\u30c8\u30eb\u304c\u767a\u751f\u3057\u307e\u3057\u305f\uff01")),Q(!0),F("\u30d0\u30c8\u30eb\u767a\u751f\uff01\u30dd\u30a4\u30f3\u30c8\u3092\u8ced\u3051\u3066\u304f\u3060\u3055\u3044\u3002")}}try{await(0,wn.updateDoc)(s,t),console.log("\u2705 [Movement] Successfully updated game data:",{playerId:i.substring(0,8),newPosition:{r:l,c:c},hasBattle:!!e,updatesKeys:Object.keys(t),debugMode:k})}catch(v){return console.error("\u274c [Movement] Failed to update game data:",v),void F("\u79fb\u52d5\u306e\u66f4\u65b0\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}u&&l===u.goal.r&&c===u.goal.c||(Ge(!0),"standard"===$&&F("".concat(n," \u9023\u7d9a\u79fb\u52d5\u53ef\u80fd\u3067\u3059\u3002")))}catch(v){console.error("Error moving:",v),F("\u79fb\u52d5\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002"),Ge(!0)}finally{Fe(!1)}},pt=()=>{console.log("\ud83e\uddf9 [StateReset] Performing complete state reset"),vt(!0),xe.current&&(clearInterval(xe.current),xe.current=null);["labyrinthGameId","labyrinthGameType","currentUserName","userId","gameState","playerPosition","lastActivity"].forEach((e=>localStorage.removeItem(e))),I(null),C(null),j(null),P(null),R(null),L(null),F("\u30b2\u30fc\u30e0\u958b\u59cb\uff01"),V(!1),G([]),W(""),Q(!1),Y(null),J("standard"),ee(null),ne(null),ie(null),ae(null),le(null),ue({type:null,duration:null,conditions:""}),he(!1),pe(null),ge(!1),ve([]),we([]),Se(!1),ke(null),Ie(!1),Ce(!1),je(!1),Pe(!1),Re(!1),Le(null),Fe(!1),Ve([]),Ge(!0),We(!1),Ke(!1),Xe(""),$e(!1),Ze([]),tt(_),rt({}),st({}),setTimeout((()=>{vt(!1)}),500),console.log("\u2705 [StateReset] All states reset to initial values",{debugMode:k,actualUserId:_.substring(0,8),actualUserName:lt,debugCurrentPlayerId:k?at.substring(0,8):"N/A",note:k?"Debug mode was active but exit was executed as actual user":"Normal mode operation"})},mt=(e,t)=>{me&&"sabotage"===re&&"trap"===oe&&(pe({r:e,c:t}),ge(!1),F("\u30c8\u30e9\u30c3\u30d7\u8a2d\u7f6e\u5ea7\u6a19 (".concat(e,", ").concat(t,") \u3092\u9078\u629e\u3057\u307e\u3057\u305f\u3002")))},gt=(e,t)=>{if("extra"===$)Te&&"move"===re?bt(e,t):me&&"sabotage"===re&&"trap"===oe&&mt(e,t);else if("standard"===$){if(dt&&!ht&&Be){const n=k?ot:A,{r:r,c:i}=n.position;1===Math.abs(e-r)&&t===i||1===Math.abs(t-i)&&e===r?e<r?ft("up"):e>r?ft("down"):t<i?ft("left"):t>i&&ft("right"):F("\u96a3\u63a5\u3059\u308b\u30bb\u30eb\u306b\u306e\u307f\u79fb\u52d5\u3067\u304d\u307e\u3059\u3002")}}};(0,r.useEffect)((()=>{const e=e=>{if("standard"===$&&dt&&!ht&&Be)switch(e.key){case"ArrowUp":case"w":case"W":e.preventDefault(),ft("up");break;case"ArrowDown":case"s":case"S":e.preventDefault(),ft("down");break;case"ArrowLeft":case"a":case"A":e.preventDefault(),ft("left");break;case"ArrowRight":case"d":case"D":e.preventDefault(),ft("right")}};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[$,dt,ht,ft,Be]),(0,r.useEffect)((()=>{dt&&Ge(!0)}),[dt]);const[yt,vt]=(0,r.useState)(!1);(0,r.useEffect)((()=>{if(!T||yt){const e=localStorage.getItem("labyrinthGameId"),t=localStorage.getItem("labyrinthGameType");return e&&t&&!yt?(I(e),void J(t)):(pt(),void S("lobby"))}const e=(0,wn.doc)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),T),t=(0,wn.aQ)(e,(e=>{if(!yt)if(e.exists()){var t,n;const i=e.data();console.log("Game data loaded:",i),C(i);const s=null===(t=i.playerStates)||void 0===t?void 0:t[_];if(console.log("My player state:",s),j(s),k&&i.playerStates&&(rt(i.playerStates),console.log("\ud83d\udd27 [DEBUG] All player states updated:",i.playerStates)),"finished"===i.status){if(Se(!0),!Oe){var r;const e=null===(r=i.playerStates)||void 0===r?void 0:r[_],t=(i.players||[]).filter((e=>{var t;return null===(t=i.playerStates[e])||void 0===t?void 0:t.goalTime})),n=(null===e||void 0===e?void 0:e.rank)||t.length+1;Le({isGoal:!(null===e||void 0===e||!e.goalTime),rank:n,points:0,message:null!==e&&void 0!==e&&e.goalTime?"\u30b4\u30fc\u30eb\u9054\u6210\uff01":"\u30b2\u30fc\u30e0\u7d42\u4e86",totalScore:(null===e||void 0===e?void 0:e.score)||0,goalTime:null!==e&&void 0!==e&&e.goalTime?new Date(1e3*e.goalTime.seconds):new Date}),Re(!0)}return}if(null!==s&&void 0!==s&&s.assignedMazeOwnerId&&i.mazes){console.log("Assigned maze owner:",s.assignedMazeOwnerId),console.log("Available mazes:",Object.keys(i.mazes));const e=i.mazes[s.assignedMazeOwnerId];e?(console.log("Maze to play loaded:",e),P(e)):(console.warn("Assigned maze not found for:",s.assignedMazeOwnerId),F("\u5272\u308a\u5f53\u3066\u3089\u308c\u305f\u8ff7\u8def\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093: ".concat(s.assignedMazeOwnerId)))}if(null!==(n=i.mazes)&&void 0!==n&&n[_]){console.log("My created maze loaded:",i.mazes[_]),R(i.mazes[_]);const e=Object.entries(i.playerStates||{}).find((e=>{let[t,n]=e;return n.assignedMazeOwnerId===_&&t!==_}));e?(L((0,Tn.A)({id:e[0]},e[1])),console.log("Player solving my maze:",e[0])):L(null)}else console.warn("My created maze not found for userId:",_)}else console.error("Game document does not exist"),yt||(F("\u30b2\u30fc\u30e0\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3002\u30ed\u30d3\u30fc\u306b\u623b\u308a\u307e\u3059\u3002"),setTimeout((()=>{pt(),S("lobby")}),3e3))}),(e=>{console.error("Error loading game data:",e),yt||(F("\u30b2\u30fc\u30e0\u30c7\u30fc\u30bf\u306e\u8aad\u307f\u8fbc\u307f\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u30ed\u30d3\u30fc\u306b\u623b\u308a\u307e\u3059\u3002"),setTimeout((()=>{pt(),S("lobby")}),3e3))}));return()=>{console.log("\ud83d\udd04 [Cleanup] Unsubscribing game data listener"),t()}}),[T,_,S,yt]);const bt=(e,t)=>{if(Te&&"move"===re){const{r:n,c:r}=A.position,i=1===Math.abs(e-n)&&t===r||1===Math.abs(t-r)&&e===n,s=(null===D||void 0===D?void 0:D.gridSize)||wt;i&&e>=0&&e<s&&t>=0&&t<s?(ke({r:e,c:t}),Ie(!1),F("\u79fb\u52d5\u5148 (".concat(e,", ").concat(t,") \u3092\u9078\u629e\u3057\u307e\u3057\u305f\u3002"))):F("\u96a3\u63a5\u3059\u308b\u30bb\u30eb\u306b\u306e\u307f\u79fb\u52d5\u3067\u304d\u307e\u3059\u3002")}};(0,r.useEffect)((()=>{if(!T||!kn||yt)return;const e=(0,wn.rJ)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames/").concat(T,"/chatMessages")),t=(0,wn.P)(e,(0,wn.My)("timestamp","asc"),(0,wn.AB)(50)),n=(0,wn.aQ)(t,(e=>{if(yt)return;const t=e.docs.map((e=>(0,Tn.A)({id:e.id},e.data())));G(t)}),(e=>{yt||console.error("Error loading chat messages:",e)}));return()=>{console.log("\ud83d\udd04 [Cleanup] Unsubscribing chat listener"),n()}}),[T,kn,yt]),(0,r.useEffect)((()=>{if(!N||!N.players||Oe)return;const e=N.players.filter((e=>{var t;return null===(t=N.playerStates[e])||void 0===t?void 0:t.goalTime}));if(null===A||void 0===A||!A.goalTime){let t=!1,n="\u30b2\u30fc\u30e0\u7d42\u4e86";if("2player"===N.mode&&e.length>=1?(t=!0,n="\u76f8\u624b\u304c\u30b4\u30fc\u30eb\u3057\u307e\u3057\u305f"):"4player"===N.mode&&e.length>=3&&(t=!0,n="\u30b2\u30fc\u30e0\u7d42\u4e86"),t){const t=e.length+1;setTimeout((()=>{Le({isGoal:!1,rank:t,points:0,message:n,totalScore:(null===A||void 0===A?void 0:A.score)||0,goalTime:new Date}),Re(!0)}),2e3)}}}),[null===N||void 0===N?void 0:N.playerStates,null===N||void 0===N?void 0:N.players,null===N||void 0===N?void 0:N.mode,null===A||void 0===A?void 0:A.goalTime,Oe,null===A||void 0===A?void 0:A.score]);const wt="extra"===$?11:Fn,xt=(0,r.useCallback)((async e=>{if(!T)return;const t=(0,wn.rJ)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames/").concat(T,"/chatMessages"));try{await(0,wn.gS)(t,{senderId:"system",senderName:"\u30b7\u30b9\u30c6\u30e0",text:e,timestamp:(0,wn.serverTimestamp)()})}catch(n){console.error("Error sending system chat message:",n)}}),[T]),_t=(0,r.useCallback)((async(e,t)=>{if(!e||!t||"finished"===t.status)return;xt("\u30b2\u30fc\u30e0\u7d42\u4e86\uff01\u6700\u7d42\u30dd\u30a4\u30f3\u30c8\u8a08\u7b97\u4e2d...");const n=(0,wn.doc)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),e);try{await(0,wn.runTransaction)(En,(async e=>{const t=await e.get(n);if(!t.exists())throw new Error("Game not found for finalization!");const r=t.data();if("finished"===r.status)return;let i=JSON.parse(JSON.stringify(r.playerStates));r.players.forEach((e=>{const t=i[e];if(t.personalTimeUsed>Vn){const e=t.personalTimeUsed-Vn,n=Math.floor(e/30);if(n>0){const e=-5*n;t.score+=e}}i[e].scoreBeforeFullAllianceBonus=t.score}));let s=r.players.map((e=>({id:e,score:i[e].score||0,goalTime:i[e].goalTime?i[e].goalTime.toMillis?i[e].goalTime.toMillis():i[e].goalTime:1/0,allianceId:i[e].allianceId,secretObjective:i[e].secretObjective,betrayedAllies:i[e].betrayedAllies||[]}))).sort(((e,t)=>e.goalTime!==t.goalTime?e.goalTime-t.goalTime:t.score-e.score));s.forEach(((e,t)=>{i[e.id].rank=t+1}));const a=[50,30,20,10];s.forEach(((e,t)=>{e.goalTime!==1/0&&(i[e.id].score+=a[t]||0)})),r.players.forEach((e=>{var t,n,s;const a=i[e],o=a.secretObjective;if(o&&!o.achieved&&o.gameEndCondition){let e=!1;switch(o.id){case"COMP_TARGET_LAST":o.targetPlayerId&&(null===(t=i[o.targetPlayerId])||void 0===t?void 0:t.rank)===r.players.length&&(e=!0);break;case"COMP_SOLO_TOP3":!a.allianceId&&a.rank<=3&&(e=!0);break;case"COOP_ALLY_TOP2":a.allianceId&&o.targetPlayerId&&(null===(n=i[o.targetPlayerId])||void 0===n?void 0:n.allianceId)===a.allianceId&&a.rank<=2&&(null===(s=i[o.targetPlayerId])||void 0===s?void 0:s.rank)<=2&&(e=!0);break;case"SAB_BETRAY_AND_WIN":if(a.betrayedAllies.length>0){a.betrayedAllies.every((e=>!i[e]||a.rank<i[e].rank))&&(e=!0)}}e&&(a.score+=o.points,a.secretObjective.achieved=!0)}if(a.allianceId){const t=r.alliances.find((e=>e.id===a.allianceId&&"betrayed"!==e.status));if(t){t.members.find((t=>t!==e&&i[t]&&i[t].rank<a.rank))&&(a.score+=10)}}const l=r.alliances.some((t=>t.members.includes(e)));1!==a.rank||l||(a.score+=25)}));r.alliances.filter((e=>"full_alliance"===e.type&&"betrayed"!==e.status)).forEach((e=>{const t=e.members.filter((e=>i[e]));if(t.length>0){const e=t.reduce(((e,t)=>e+(void 0!==i[t].scoreBeforeFullAllianceBonus?i[t].scoreBeforeFullAllianceBonus:i[t].score)),0),n=Math.floor(.5*e),r=t.length>0?Math.floor(n/t.length):0;t.forEach((e=>{const t=void 0!==i[e].scoreBeforeFullAllianceBonus?i[e].scoreBeforeFullAllianceBonus:i[e].score;i[e].score=Math.floor(.5*t)+r}))}})),e.update(n,{playerStates:i,status:"finished",currentExtraModePhase:"gameOver",phaseTimerEnd:null,currentActionPlayerId:null})}))}catch(r){console.error("Error finalizing game:",r),xt("\u30b2\u30fc\u30e0\u7d42\u4e86\u51e6\u7406\u30a8\u30e9\u30fc: "+r.message)}}),[xt,$]),St=(0,r.useCallback)((async(e,t)=>{if(!e||!t||"extra"!==t.gameType||"finished"===t.status)return;const n=(0,wn.doc)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),e);let r={},i=t.currentExtraModePhase;switch(t.currentExtraModePhase){case"declaration":if(t.players.every((e=>{var n;return null===(n=t.playerStates[e])||void 0===n?void 0:n.hasDeclaredThisTurn}))){i="actionExecution";const e=t.players[0];r={currentExtraModePhase:i,currentActionPlayerId:e,phaseTimerEnd:wn.Dc.fromMillis(Date.now()+1500)},xt("\u5168\u54e1\u306e\u5ba3\u8a00\u304c\u5b8c\u4e86\uff01\u30a2\u30af\u30b7\u30e7\u30f3\u5b9f\u884c\u30d5\u30a7\u30fc\u30ba\u306b\u79fb\u884c\u3057\u307e\u3059\u3002")}break;case"actionExecution":const n=t.players.indexOf(t.currentActionPlayerId)+1;if(n<t.players.length){const e=t.players[n];r={currentActionPlayerId:e,phaseTimerEnd:wn.Dc.fromMillis(Date.now()+1500)}}else{const n=(t.roundNumber||1)+1;if(t.players.filter((e=>{var n;return null===(n=t.playerStates[e])||void 0===n?void 0:n.goalTime})).length>=Math.ceil(t.players.length/2)||n>20)return void await _t(e,t);r={currentExtraModePhase:"declaration",currentActionPlayerId:null,roundNumber:n,phaseTimerEnd:wn.Dc.fromMillis(Date.now()+30)},t.players.forEach((e=>{r["playerStates.".concat(e,".hasDeclaredThisTurn")]=!1,r["playerStates.".concat(e,".actionExecutedThisTurn")]=!1,r["playerStates.".concat(e,".declaredAction")]=null})),xt("\u30e9\u30a6\u30f3\u30c9 ".concat(n," \u958b\u59cb\uff01\u5ba3\u8a00\u30d5\u30a7\u30fc\u30ba\u304c\u59cb\u307e\u308a\u307e\u3059\u3002"))}break;default:return void console.log("Unknown phase:",t.currentExtraModePhase)}if(Object.keys(r).length>0)try{await(0,wn.updateDoc)(n,r)}catch(s){console.error("Error advancing extra mode phase:",s)}}),[_t,xt]),Et=(0,r.useCallback)((async()=>{var e,t,n;if(!N||null===A||void 0===A||!A.declaredAction||A.actionExecutedThisTurn)return;const r=A.declaredAction,i=(0,wn.doc)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),T);try{let s={["playerStates.".concat(_,".actionExecutedThisTurn")]:!0};switch(r.type){case"move":if(null!==(e=r.details)&&void 0!==e&&e.targetCell){const{r:e,c:t}=r.details.targetCell;s["playerStates.".concat(_,".position")]={r:e,c:t},s["playerStates.".concat(_,".lastMoveTime")]=(0,wn.serverTimestamp)(),A.revealedCells["".concat(e,"-").concat(t)]||(s["playerStates.".concat(_,".score")]=(0,wn.GV)(2),s["playerStates.".concat(_,".revealedCells.").concat(e,"-").concat(t)]=!0),D&&e===D.goal.r&&t===D.goal.c&&!A.goalTime&&(s["playerStates.".concat(_,".goalTime")]=(0,wn.serverTimestamp)(),s.goalCount=(0,wn.GV)(1),setTimeout((()=>{Le({isGoal:!0,rank:(N.goalCount||0)+1,points:50,message:"\u30b4\u30fc\u30eb\u9054\u6210\uff01",totalScore:(A.score||0)+50,goalTime:new Date}),Re(!0)}),1e3)),F("(".concat(e,",").concat(t,")\u306b\u79fb\u52d5\u3057\u307e\u3057\u305f\uff01"))}break;case"scout":if(r.targetId&&N.playerStates[r.targetId]){const e=N.playerStates[r.targetId].position;s["playerStates.".concat(_,".scoutLogs")]=(0,wn.hq)({targetId:r.targetId,position:e,round:N.roundNumber}),F("".concat(ut(r.targetId),"\u306e\u4f4d\u7f6e\u3092\u5075\u5bdf\u3057\u307e\u3057\u305f\u3002"))}break;case"sabotage":if(null!==(t=r.details)&&void 0!==t&&t.sabotageType&&r.targetId){const e={type:r.details.sabotageType,sourceId:_,expiryRound:(N.roundNumber||1)+2};s["playerStates.".concat(r.targetId,".sabotageEffects")]=(0,wn.hq)(e),F("".concat(ut(r.targetId),"\u306b\u59a8\u5bb3\u3092\u5b9f\u884c\u3057\u307e\u3057\u305f\u3002"))}break;case"negotiate":if(r.targetId&&null!==(n=r.details)&&void 0!==n&&n.negotiation){const e={fromId:_,toId:r.targetId,type:r.details.negotiation.type,conditions:r.details.negotiation.conditions,round:N.roundNumber,status:"pending"};s["negotiations.".concat(_,"-").concat(r.targetId,"-").concat(Date.now())]=e,F("".concat(ut(r.targetId),"\u306b\u4ea4\u6e09\u3092\u63d0\u6848\u3057\u307e\u3057\u305f\u3002"))}break;case"wait":F("\u5f85\u6a5f\u3057\u307e\u3057\u305f\u3002");break;default:F("\u4e0d\u660e\u306a\u30a2\u30af\u30b7\u30e7\u30f3\u3067\u3059\u3002")}await(0,wn.updateDoc)(i,s),setTimeout((()=>{St(T,N)}),1500)}catch(s){console.error("Error executing action:",s),F("\u30a2\u30af\u30b7\u30e7\u30f3\u5b9f\u884c\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}}),[N,A,_,T,D,St]),kt=(0,r.useCallback)((async()=>{if("standard"!==$||!N||!T)return;const e=(0,wn.doc)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),T);try{await(0,wn.runTransaction)(En,(async t=>{const n=await t.get(e);if(!n.exists())return;const r=n.data(),i=(r.players.indexOf(r.currentTurnPlayerId)+1)%r.players.length,s=r.players[i],a={currentTurnPlayerId:s,turnNumber:(0,wn.GV)(1)},o=ut(s);console.log("\ud83d\udd04 Turn switched to: ".concat(o));const l=r.players.filter((e=>{var t;return null===(t=r.playerStates[e])||void 0===t?void 0:t.goalTime}));let c=!1;if(("4player"===r.mode&&l.length>=3||"2player"===r.mode&&l.length>=1)&&(c=!0),c)if(a.status="finished","4player"===r.mode){r.players.map((e=>{var t,n,i;return{id:e,score:(null===(t=r.playerStates[e])||void 0===t?void 0:t.score)||0,goalTime:(null===(n=r.playerStates[e])||void 0===n||null===(i=n.goalTime)||void 0===i?void 0:i.toMillis())||1/0}})).sort(((e,t)=>t.score-e.score)).forEach(((e,t)=>{a["playerStates.".concat(e.id,".rank")]=t+1}))}else{r.players.map((e=>{var t,n,i;return{id:e,goalTime:(null===(t=r.playerStates[e])||void 0===t||null===(n=t.goalTime)||void 0===n?void 0:n.toMillis())||1/0,score:(null===(i=r.playerStates[e])||void 0===i?void 0:i.score)||0}})).sort(((e,t)=>e.goalTime!==t.goalTime?e.goalTime-t.goalTime:t.score-e.score)).forEach(((e,t)=>{a["playerStates.".concat(e.id,".rank")]=t+1}))}t.update(e,a)}))}catch(t){console.error("Error advancing standard turn:",t)}}),[$,N,T]);(0,r.useEffect)((()=>{if("extra"===$&&"actionExecution"===(null===N||void 0===N?void 0:N.currentExtraModePhase)&&(null===N||void 0===N?void 0:N.currentActionPlayerId)===_&&null!==A&&void 0!==A&&A.declaredAction&&(null===A||void 0===A||!A.actionExecutedThisTurn)){const e=setTimeout((()=>{Et()}),1e3);return()=>clearTimeout(e)}}),[null===N||void 0===N?void 0:N.currentExtraModePhase,null===N||void 0===N?void 0:N.currentActionPlayerId,null===A||void 0===A?void 0:A.actionExecutedThisTurn,Et,$,_]),(0,r.useEffect)((()=>{if(null!==N&&void 0!==N&&N.activeBattle&&"4player"===(null===N||void 0===N?void 0:N.mode)){var e;const n=N.activeBattle,r=k?at:_,i=null===(e=n.participants)||void 0===e?void 0:e.includes(r);if(console.log("\ud83e\udd4a [Battle] Battle state monitoring:",{battleExists:!!n,battleStatus:n.status,participants:n.participants,currentUser:r.substring(0,8),actualUser:_.substring(0,8),isParticipant:i,modalOpen:K,waitDialogOpen:Ye,debugMode:k}),i&&!K&&"betting"===n.status&&(console.log("\ud83e\udd4a [Battle] Opening battle modal for participant"),Q(!0),$e(!1)),i||(K&&(console.log("\ud83e\udd4a [Battle] Closing battle modal for non-participant"),Q(!1)),Ye||"betting"!==n.status||(console.log("\ud83e\udd4a [Battle] Showing battle wait dialog for non-participant"),$e(!0),Ze(n.participants||[]))),"betting"===n.status){var t;(null===(t=n.participants)||void 0===t?void 0:t.every((e=>{var t,n;return void 0!==(null===(t=N.playerStates[e])||void 0===t?void 0:t.battleBet)&&null!==(null===(n=N.playerStates[e])||void 0===n?void 0:n.battleBet)})))&&(console.log("\ud83e\udd4a [Battle] All participants have placed bets, processing result"),(async e=>{if(e&&e.participants&&2===e.participants.length)try{const t=(0,wn.doc)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),T),[n,r]=e.participants,i=N.playerStates[n],s=N.playerStates[r],a=(null===i||void 0===i?void 0:i.battleBet)||0,o=(null===s||void 0===s?void 0:s.battleBet)||0;let l=null,c=null;a>o?(l=n,c=r):o>a&&(l=r,c=n);const u={["playerStates.".concat(n,".inBattleWith")]:null,["playerStates.".concat(r,".inBattleWith")]:null,["playerStates.".concat(n,".battleBet")]:null,["playerStates.".concat(r,".battleBet")]:null,activeBattle:null};if(l){u["playerStates.".concat(l,".score")]=(0,wn.GV)(5),u["playerStates.".concat(c,".skipNextTurn")]=!0;const e=ut(l),t=ut(c);await xt("\ud83c\udfc6 \u30d0\u30c8\u30eb\u7d50\u679c: ".concat(e,"\u306e\u52dd\u5229\uff01 (").concat(a," vs ").concat(o,")")),await xt("\ud83d\udc80 ".concat(t,"\u306f\u6b21\u306e\u30bf\u30fc\u30f3\u884c\u52d5\u4e0d\u80fd\u306b\u306a\u308a\u307e\u3059\u3002")),F(l===_?"\ud83c\udfc6 \u30d0\u30c8\u30eb\u52dd\u5229\uff01 +5pt (".concat(a," vs ").concat(o,")"):c===_?"\ud83d\udc80 \u30d0\u30c8\u30eb\u6557\u5317... \u6b21\u306e\u30bf\u30fc\u30f3\u884c\u52d5\u4e0d\u80fd (".concat(a," vs ").concat(o,")"):"\u2694\ufe0f \u30d0\u30c8\u30eb\u7d42\u4e86: ".concat(e,"\u306e\u52dd\u5229"))}else await xt("\ud83e\udd1d \u30d0\u30c8\u30eb\u7d50\u679c: \u5f15\u304d\u5206\u3051 (".concat(a," vs ").concat(o,")")),F("\ud83e\udd1d \u30d0\u30c8\u30eb\u5f15\u304d\u5206\u3051 (".concat(a," vs ").concat(o,")"));await(0,wn.updateDoc)(t,u),Q(!1)}catch(t){console.error("Error processing battle result:",t),F("\u30d0\u30c8\u30eb\u7d50\u679c\u306e\u51e6\u7406\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}})(n))}}else null!==N&&void 0!==N&&N.activeBattle||(K&&(console.log("\ud83e\udd4a [Battle] Closing battle modal - no active battle"),Q(!1)),Ye&&(console.log("\ud83e\udd4a [Battle] Closing battle wait dialog - no active battle"),$e(!1),Ze([])))}),[null===N||void 0===N?void 0:N.activeBattle,null===N||void 0===N?void 0:N.playerStates,null===N||void 0===N?void 0:N.mode,_,K,Ye,k,at]),(0,r.useEffect)((()=>{if("interrupted"===(null===N||void 0===N?void 0:N.status)&&null!==N&&void 0!==N&&N.interruptedBy){const e=_;if(N.interruptedBy!==e){const t=N.interruptedPlayerName||"\u30d7\u30ec\u30a4\u30e4\u30fc";console.log("\ud83d\udea8 [GameInterrupted] Game was interrupted by another player:",{interruptedBy:N.interruptedBy.substring(0,8),interruptedPlayerName:t,actualUserId:e.substring(0,8),debugMode:k,debugCurrentPlayerId:k?at.substring(0,8):"N/A"}),Ke(!0),Xe(t)}else console.log("\ud83d\udd04 [GameInterrupted] Game was interrupted by self, going to lobby immediately:",{actualUserId:e.substring(0,8),debugMode:k})}}),[null===N||void 0===N?void 0:N.status,null===N||void 0===N?void 0:N.interruptedBy,null===N||void 0===N?void 0:N.interruptedPlayerName,_,k,at]);const Tt=async()=>{var e,t;if(!q.trim()||!T)return;if("communication_jam"===(null===N||void 0===N||null===(e=N.specialEventActive)||void 0===e?void 0:e.type)||null!==A&&void 0!==A&&null!==(t=A.sabotageEffects)&&void 0!==t&&t.some((e=>"info_jam"===e.type&&e.expiryRound>=(null===N||void 0===N?void 0:N.roundNumber))))return void F("\u901a\u4fe1\u304c\u59a8\u5bb3\u3055\u308c\u3066\u3044\u307e\u3059\u3002");const n=(0,wn.rJ)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames/").concat(T,"/chatMessages"));try{await(0,wn.gS)(n,{senderId:_,senderName:lt,text:q,timestamp:(0,wn.serverTimestamp)()}),W("")}catch(r){console.error("Error sending chat message:",r),F("\u30e1\u30c3\u30bb\u30fc\u30b8\u9001\u4fe1\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}},It=(0,r.useCallback)((async()=>{if(!re||null!==A&&void 0!==A&&A.hasDeclaredThisTurn||"declaration"!==(null===N||void 0===N?void 0:N.currentExtraModePhase))return;const e=(0,wn.doc)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),T);let t={type:re};switch(re){case"move":if(!Ee)return void F("\u79fb\u52d5\u5148\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002");t.details={targetCell:Ee};break;case"sabotage":if(!oe||!se)return void F("\u59a8\u5bb3\u30bf\u30a4\u30d7\u3068\u5bfe\u8c61\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002");t.targetId=se,t.details={sabotageType:oe},"trap"===oe&&fe&&(t.details.trapCoordinates=fe);break;case"negotiate":if(!se||!ce.type)return void F("\u4ea4\u6e09\u5bfe\u8c61\u3068\u30bf\u30a4\u30d7\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002");t.targetId=se,t.details={negotiation:ce};break;case"scout":if(!se)return void F("\u5075\u5bdf\u5bfe\u8c61\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044\u3002");t.targetId=se;break;case"wait":break;default:return void F("\u7121\u52b9\u306a\u30a2\u30af\u30b7\u30e7\u30f3\u3067\u3059\u3002")}try{await(0,wn.updateDoc)(e,{["playerStates.".concat(_,".declaredAction")]:t,["playerStates.".concat(_,".hasDeclaredThisTurn")]:!0,["declarations.".concat(_)]:(0,Tn.A)((0,Tn.A)({},t),{},{submittedAt:(0,wn.serverTimestamp)()})}),F("".concat(re,"\u3092\u5ba3\u8a00\u3057\u307e\u3057\u305f\uff01")),ie(null),ae(null),le(null),ke(null),Ie(!1),pe(null),ue({type:null,duration:null,conditions:""}),he(!1)}catch(n){console.error("Error declaring action:",n),F("\u30a2\u30af\u30b7\u30e7\u30f3\u5ba3\u8a00\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}}),[re,Ee,se,oe,ce,fe,A,N,_,T]),Nt=()=>{"move"===re&&(Ie(!0),F("\u79fb\u52d5\u5148\u306e\u96a3\u63a5\u30bb\u30eb\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u304f\u3060\u3055\u3044\u3002"))},Ct=e=>{let{actionType:t,label:n,icon:r,currentSelection:i,onSelect:s}=e;const a=i===t;return(0,Xn.jsx)("button",{onClick:()=>{s(t),he(!0)},className:"p-2 rounded-lg border-2 text-sm transition-all duration-200 ".concat(a?"border-blue-500 bg-blue-100 text-blue-800":"border-gray-300 bg-white hover:border-blue-300 hover:bg-blue-50"),children:(0,Xn.jsxs)("div",{className:"flex items-center justify-center space-x-1",children:[(0,Xn.jsx)(r,{size:16}),(0,Xn.jsx)("span",{children:n})]})})},At=()=>k&&null!==N&&void 0!==N&&N.players?(0,Xn.jsx)("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 p-3 mb-4",children:(0,Xn.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,Xn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Xn.jsx)("span",{className:"text-yellow-800 font-semibold",children:"\ud83d\udd27 DEBUG MODE:"}),(0,Xn.jsx)("span",{className:"text-yellow-700",children:"\u30d7\u30ec\u30a4\u30e4\u30fc\u5207\u308a\u66ff\u3048:"}),(0,Xn.jsx)("div",{className:"flex space-x-1",children:N.players.map(((e,t)=>(0,Xn.jsxs)("button",{onClick:()=>{tt(e),console.log("\ud83d\udd27 [DEBUG] Switched to player ".concat(t+1,": ").concat(e.substring(0,8),"..."))},className:"px-3 py-1 rounded text-sm font-medium ".concat(et===e?"bg-blue-500 text-white":"bg-white text-gray-700 hover:bg-gray-100"),children:["P",t+1]},e)))}),(0,Xn.jsxs)("span",{className:"text-yellow-700 text-sm",children:["\u73fe\u5728: ",null===et||void 0===et?void 0:et.substring(0,8),"..."]})]}),(0,Xn.jsx)("div",{className:"flex items-center space-x-4",children:(0,Xn.jsxs)("label",{className:"flex items-center space-x-1 text-sm text-yellow-700",children:[(0,Xn.jsx)("input",{type:"checkbox",checked:z,onChange:e=>V(e.target.checked),className:"rounded"}),(0,Xn.jsx)("span",{children:"\u76f8\u624b\u306e\u58c1\u8868\u793a\u78ba\u8a8d"})]})}),(0,Xn.jsxs)("div",{className:"text-xs text-yellow-600 bg-yellow-50 p-2 rounded border",children:["\ud83d\udcdd \u30c7\u30d0\u30c3\u30b0\u6a5f\u80fd: \u2022 \u30b2\u30fc\u30e0\u6a5f\u80fd\u306f\u901a\u5e38\u30e2\u30fc\u30c9\u3068\u5b8c\u5168\u540c\u4e00\uff08\u79fb\u52d5\u30fb\u30d0\u30c8\u30eb\u30fb\u7d42\u4e86\u306a\u3069\uff09",(0,Xn.jsx)("br",{}),"\u2022 \u30d7\u30ec\u30a4\u30e4\u30fc\u5207\u308a\u66ff\u3048\u3067\u76f8\u624b\u306e\u753b\u9762\u8868\u793a\u78ba\u8a8d\u3068\u64cd\u4f5c\u304c\u53ef\u80fd",(0,Xn.jsx)("br",{}),"\u2022 \u58c1\u306e\u8868\u793a\u72b6\u614b\u3084\u767a\u898b\u6e08\u307f\u30bb\u30eb\u306e\u78ba\u8a8d\u304c\u53ef\u80fd",(0,Xn.jsx)("br",{}),"\u2022 \u5207\u308a\u66ff\u3048\u305f\u30d7\u30ec\u30a4\u30e4\u30fc\u3068\u3057\u3066\u5b9f\u969b\u306b\u79fb\u52d5\u3084\u30d0\u30c8\u30eb\u304c\u5b9f\u884c\u53ef\u80fd",(0,Xn.jsx)("br",{}),"\u2022 \u4e00\u4eba\u3067\u30de\u30eb\u30c1\u30d7\u30ec\u30a4\u30e4\u30fc\u306e\u30c7\u30d0\u30c3\u30b0\u304c\u53ef\u80fd"]})]})}):null;return De?(0,Xn.jsx)(_r,{gameData:N,mazeData:D,allMazeData:(null===N||void 0===N?void 0:N.mazes)||{},userId:_,gameId:T,onExit:()=>{Pe(!1),S("lobby")}}):(0,Xn.jsxs)("div",{className:"w-full max-w-full mx-auto p-2 sm:p-4 bg-gray-100 min-h-screen",children:[(0,Xn.jsx)(At,{}),(0,Xn.jsx)("div",{className:"bg-white rounded-lg shadow-md p-3 sm:p-4 mb-4",children:(0,Xn.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-2",children:[(0,Xn.jsxs)("h1",{className:"text-xl sm:text-2xl font-bold text-gray-800",children:["standard"===$?"\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9\u30e2\u30fc\u30c9 (\u4e8c\u4eba\u5bfe\u6226)":"\u30a8\u30af\u30b9\u30c8\u30e9\u30e2\u30fc\u30c9",k&&(0,Xn.jsx)("span",{className:"text-yellow-600 ml-2 text-base sm:text-lg",children:"\ud83d\udd27 DEBUG"})]}),(0,Xn.jsx)("button",{onClick:async()=>{if(N&&T)try{const e=(0,wn.doc)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),T),t=_,n=lt;console.log("\ud83d\udd04 [Exit] Starting game interruption process:",{debugMode:k,actualUserId:_.substring(0,8),currentUserName:lt,debugCurrentPlayerId:k?at.substring(0,8):"N/A",note:"Exit is always executed as the actual user, regardless of debug mode"}),await(0,wn.updateDoc)(e,{status:"interrupted",interruptedBy:t,interruptedAt:(0,wn.serverTimestamp)(),interruptedPlayerName:n}),await xt("".concat(n,"\u304c\u30b2\u30fc\u30e0\u3092\u4e2d\u65ad\u3057\u307e\u3057\u305f\u3002")),console.log("\u2705 [Exit] Game interrupted successfully, returning to lobby",{debugMode:k,actualUserId:_.substring(0,8),currentUserName:lt}),pt(),S("lobby")}catch(e){console.error("\u274c [Exit] Error interrupting game:",e,{debugMode:k,actualUserId:_.substring(0,8),debugCurrentPlayerId:k?at.substring(0,8):"N/A"}),F("\u30b2\u30fc\u30e0\u4e2d\u65ad\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002"),pt(),S("lobby")}},className:"bg-red-500 hover:bg-red-600 text-white px-3 py-2 sm:px-4 rounded text-sm sm:text-base",title:k?"\u30c7\u30d0\u30c3\u30b0\u30e2\u30fc\u30c9\u3067\u3082\u5b9f\u969b\u306e\u30e6\u30fc\u30b6\u30fc(".concat(lt,")\u3068\u3057\u3066\u7d42\u4e86\u51e6\u7406\u3092\u5b9f\u884c"):"",children:"\u30db\u30fc\u30e0\u306b\u623b\u308b"})]})}),"standard"===$?(0,Xn.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 xl:grid-cols-12 gap-2 sm:gap-4 h-full min-h-[calc(100vh-200px)]",children:[(0,Xn.jsxs)("div",{className:"lg:col-span-1 xl:col-span-4 bg-white rounded-lg shadow-md p-2 sm:p-4 h-fit",children:[(0,Xn.jsx)("h2",{className:"text-base sm:text-lg font-semibold mb-2 sm:mb-4 text-center",children:"\ud83c\udfae \u653b\u7565\u4e2d\u306e\u8ff7\u5bae\uff08\u76f8\u624b\u4f5c\u6210\uff09"}),D?(0,Xn.jsxs)("div",{children:[(0,Xn.jsx)("div",{className:"flex justify-center mb-4",children:(0,Xn.jsx)("div",{className:"w-fit max-w-sm mx-auto",children:(0,Xn.jsx)(rr,{mazeData:D,playerPosition:null===ot||void 0===ot?void 0:ot.position,otherPlayers:[],revealedCells:(null===ot||void 0===ot?void 0:ot.revealedCells)||{},revealedPlayerWalls:(null===ot||void 0===ot?void 0:ot.revealedWalls)||[],hitWalls:k?(null===N||void 0===N||null===(n=N.playerStates)||void 0===n||null===(i=n[at])||void 0===i?void 0:i.hitWalls)||[]:(null===A||void 0===A?void 0:A.hitWalls)||ze,onCellClick:gt,gridSize:wt,sharedWallsFromAllies:ye,highlightPlayer:!0,smallView:!1,showAllPlayerPositions:!1,isCreating:!1,showAllWalls:k&&z,playerNames:ct,currentUserId:at})})}),(0,Xn.jsxs)("div",{className:"mt-3 p-2 bg-blue-50 rounded text-sm",children:[(0,Xn.jsx)("p",{className:"font-semibold text-blue-700",children:"\u3042\u306a\u305f\u306e\u72b6\u614b:"}),(0,Xn.jsxs)("p",{children:["\u4f4d\u7f6e: (",(null===ot||void 0===ot||null===(s=ot.position)||void 0===s?void 0:s.r)||0,", ",(null===ot||void 0===ot||null===(a=ot.position)||void 0===a?void 0:a.c)||0,")"]}),(0,Xn.jsxs)("p",{children:["\u3076\u3064\u304b\u3063\u305f\u58c1: ",((null===ot||void 0===ot?void 0:ot.hitWalls)||[]).length,"\u500b"]}),(null===ot||void 0===ot?void 0:ot.goalTime)&&(0,Xn.jsx)("p",{className:"text-green-600 font-semibold",children:"\u30b4\u30fc\u30eb\u9054\u6210\uff01"}),(0,Xn.jsx)("p",{className:"text-xs text-gray-600 mt-1",children:"\u203b\u76f8\u624b\u306e\u4f4d\u7f6e\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093"})]})]}):(0,Xn.jsx)("div",{className:"flex items-center justify-center h-48 sm:h-64 bg-gray-50 rounded",children:(0,Xn.jsxs)("div",{className:"text-center",children:[(0,Xn.jsx)("p",{className:"text-gray-500 mb-2",children:"\u653b\u7565\u8ff7\u8def\u3092\u8aad\u307f\u8fbc\u307f\u4e2d..."}),(0,Xn.jsxs)("p",{className:"text-xs text-gray-400",children:["\u5272\u308a\u5f53\u3066\u3089\u308c\u305f\u8ff7\u8def\u4f5c\u6210\u8005: ",(null===A||void 0===A?void 0:A.assignedMazeOwnerId)||"\u672a\u5272\u308a\u5f53\u3066"]}),(null===N||void 0===N?void 0:N.mazes)&&(0,Xn.jsxs)("p",{className:"text-xs text-gray-400 mt-2",children:["\u5229\u7528\u53ef\u80fd\u306a\u8ff7\u8def: ",Object.keys(N.mazes).join(", ")||"\u306a\u3057"]})]})})]}),(0,Xn.jsxs)("div",{className:"lg:col-span-1 xl:col-span-4 space-y-2 sm:space-y-4 h-fit",children:[(0,Xn.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-2 sm:p-4 mb-2 sm:mb-4",children:[(0,Xn.jsx)("div",{className:"p-2 sm:p-3 bg-blue-50 rounded-lg",children:(0,Xn.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2",children:[(0,Xn.jsxs)("div",{children:[(0,Xn.jsx)("h4",{className:"font-semibold text-blue-700 text-sm sm:text-base",children:"\u73fe\u5728\u306e\u30bf\u30fc\u30f3"}),(0,Xn.jsxs)("p",{className:"text-xs sm:text-sm text-blue-600",children:[(null===N||void 0===N?void 0:N.currentTurnPlayerId)===at?(0,Xn.jsx)("span",{className:"font-bold text-green-600",children:lt}):(0,Xn.jsx)("span",{className:"font-bold text-orange-600",children:"\u76f8\u624b"})," (\u30bf\u30fc\u30f3\u6570: ",(null===N||void 0===N?void 0:N.turnNumber)||1,")"]})]}),(0,Xn.jsxs)("div",{className:"text-left sm:text-right text-xs sm:text-sm",children:[(0,Xn.jsxs)("p",{className:"text-blue-700",children:[k?"\u30d7\u30ec\u30a4\u30e4\u30fc ".concat(at.substring(0,8),"..."):lt,"\u306e\u72b6\u614b"]}),(0,Xn.jsxs)("p",{className:"text-blue-600",children:["\u4f4d\u7f6e: (",(null===ot||void 0===ot||null===(o=ot.position)||void 0===o?void 0:o.r)||0,", ",(null===ot||void 0===ot||null===(l=ot.position)||void 0===l?void 0:l.c)||0,")"]})]})]})}),"4player"===(null===N||void 0===N?void 0:N.mode)&&(0,Xn.jsxs)("div",{className:"mt-4 p-3 bg-yellow-50 rounded-lg",children:[(0,Xn.jsx)("h4",{className:"font-semibold text-yellow-700 mb-2",children:"\ud83c\udfc6 \u30d7\u30ec\u30a4\u30e4\u30fc\u30dd\u30a4\u30f3\u30c8"}),(0,Xn.jsx)("div",{className:"space-y-1 text-sm",children:null===(c=N.players)||void 0===c?void 0:c.map(((e,t)=>{var n;const r=null===(n=N.playerStates)||void 0===n?void 0:n[e],i=e===at,s=N.currentTurnPlayerId===e,a=null===r||void 0===r?void 0:r.goalTime;return(0,Xn.jsxs)("div",{className:"flex justify-between items-center p-2 rounded ".concat(i?"bg-green-100 border border-green-300":s?"bg-blue-100 border border-blue-300":"bg-white border border-gray-200"),children:[(0,Xn.jsxs)("span",{className:i?"font-bold text-green-700":"text-gray-700",children:[i?lt:"\u30d7\u30ec\u30a4\u30e4\u30fc".concat(t+1),s&&(0,Xn.jsx)("span",{className:"ml-1 text-blue-600",children:"\ud83d\udccd"}),a&&(0,Xn.jsx)("span",{className:"ml-1 text-green-600",children:"\ud83c\udfc1"})]}),(0,Xn.jsxs)("span",{className:"font-semibold ".concat(i?"text-green-700":"text-yellow-600"),children:[(null===r||void 0===r?void 0:r.score)||0,"pt"]})]},e)}))})]})]}),(0,Xn.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-2 sm:p-4 mb-2 sm:mb-4",children:[U&&(0,Xn.jsx)("div",{className:"mb-3 p-3 bg-yellow-50 rounded border-l-4 border-yellow-400",children:(0,Xn.jsx)("p",{className:"text-yellow-800 text-sm",children:U})}),(0,Xn.jsx)("h4",{className:"text-base sm:text-lg font-semibold mb-2 sm:mb-3",children:"\u79fb\u52d5\u64cd\u4f5c"}),null===N||void 0===N||!N.activeBattle||"4player"!==(null===N||void 0===N?void 0:N.mode)||null!==(u=N.activeBattle.participants)&&void 0!==u&&u.includes(k?at:_)?dt&&!ht?(0,Xn.jsxs)("div",{className:"space-y-3",children:[(0,Xn.jsxs)("div",{className:"p-3 bg-green-50 rounded-lg text-center",children:[(0,Xn.jsxs)("p",{className:"text-green-600 font-semibold",children:["\ud83d\udfe2 ",lt,"\u306e\u30bf\u30fc\u30f3"]}),(0,Xn.jsx)("p",{className:"text-sm text-green-500",children:"\u79fb\u52d5\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044"})]}),(0,Xn.jsxs)("div",{className:"p-3 bg-blue-50 rounded-lg",children:[(0,Xn.jsx)("h5",{className:"font-semibold text-blue-700 mb-2",children:"\ud83c\udfae \u79fb\u52d5\u65b9\u6cd5"}),(0,Xn.jsxs)("div",{className:"text-sm text-blue-600 space-y-1",children:[(0,Xn.jsxs)("p",{children:[(0,Xn.jsx)("strong",{children:"\u65b9\u6cd51:"})," \u4e0b\u306e\u79fb\u52d5\u30dc\u30bf\u30f3\u3092\u4f7f\u7528"]}),(0,Xn.jsxs)("p",{children:[(0,Xn.jsx)("strong",{children:"\u65b9\u6cd52:"})," \u5de6\u306e\u8ff7\u8def\u4e0a\u306e\u96a3\u63a5\u30bb\u30eb\u3092\u76f4\u63a5\u30af\u30ea\u30c3\u30af"]}),(0,Xn.jsxs)("p",{children:[(0,Xn.jsx)("strong",{children:"\u65b9\u6cd53:"})," \u30ad\u30fc\u30dc\u30fc\u30c9\u306e\u77e2\u5370\u30ad\u30fc \u307e\u305f\u306f WASD"]}),(0,Xn.jsx)("p",{className:"text-green-600 font-semibold",children:"\ud83d\udca1 \u9023\u7d9a\u79fb\u52d5\u53ef\u80fd\uff01\u58c1\u306b\u3076\u3064\u304b\u308b\u307e\u3067\u79fb\u52d5\u3057\u7d9a\u3051\u3089\u308c\u307e\u3059"})]})]}),(0,Xn.jsxs)("div",{className:"grid grid-cols-3 gap-1 sm:gap-2 max-w-36 sm:max-w-48 mx-auto",children:[(0,Xn.jsx)("div",{}),(0,Xn.jsx)("button",{onClick:()=>ft("up"),disabled:Ue||!Be,className:"bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white p-2 sm:p-3 rounded-lg flex items-center justify-center transition-colors shadow-md",title:"\u4e0a\u306b\u79fb\u52d5 (W \u30ad\u30fc)",children:(0,Xn.jsx)(sr,{size:16,className:"sm:w-5 sm:h-5"})}),(0,Xn.jsx)("div",{}),(0,Xn.jsx)("button",{onClick:()=>ft("left"),disabled:Ue||!Be,className:"bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white p-2 sm:p-3 rounded-lg flex items-center justify-center transition-colors shadow-md",title:"\u5de6\u306b\u79fb\u52d5 (A \u30ad\u30fc)",children:(0,Xn.jsx)(ar,{size:16,className:"sm:w-5 sm:h-5"})}),(0,Xn.jsx)("div",{className:"bg-gray-200 rounded-lg p-2 sm:p-3 flex items-center justify-center",children:(0,Xn.jsx)(On,{size:16,className:"sm:w-5 sm:h-5 text-gray-500"})}),(0,Xn.jsx)("button",{onClick:()=>ft("right"),disabled:Ue||!Be,className:"bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white p-2 sm:p-3 rounded-lg flex items-center justify-center transition-colors shadow-md",title:"\u53f3\u306b\u79fb\u52d5 (D \u30ad\u30fc)",children:(0,Xn.jsx)(or,{size:16,className:"sm:w-5 sm:h-5"})}),(0,Xn.jsx)("div",{}),(0,Xn.jsx)("button",{onClick:()=>ft("down"),disabled:Ue||!Be,className:"bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white p-2 sm:p-3 rounded-lg flex items-center justify-center transition-colors shadow-md",title:"\u4e0b\u306b\u79fb\u52d5 (S \u30ad\u30fc)",children:(0,Xn.jsx)(lr,{size:16,className:"sm:w-5 sm:h-5"})}),(0,Xn.jsx)("div",{})]}),(0,Xn.jsx)("div",{className:"text-center text-xs text-gray-500 bg-gray-50 p-2 rounded",children:"\ud83d\udca1 \u30ad\u30fc\u30dc\u30fc\u30c9: \u2191\u2193\u2190\u2192 \u307e\u305f\u306f WASD \u3067\u3082\u79fb\u52d5\u53ef\u80fd"})]}):ht?(0,Xn.jsxs)("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[(0,Xn.jsx)(cr,{className:"mx-auto mb-2 text-red-600",size:24}),(0,Xn.jsx)("p",{className:"text-red-600 font-semibold",children:"\u30d0\u30c8\u30eb\u4e2d"}),(0,Xn.jsx)("p",{className:"text-sm text-red-500",children:"\u79fb\u52d5\u306f\u3067\u304d\u307e\u305b\u3093"})]}):(0,Xn.jsxs)("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[(0,Xn.jsx)(Jn,{className:"mx-auto mb-2 text-gray-500",size:24}),(0,Xn.jsx)("p",{className:"text-gray-600 font-semibold",children:"\u76f8\u624b\u306e\u30bf\u30fc\u30f3"}),(0,Xn.jsx)("p",{className:"text-sm text-gray-500",children:"\u76f8\u624b\u306e\u79fb\u52d5\u3092\u5f85\u3063\u3066\u3044\u307e\u3059..."}),Ue&&(0,Xn.jsx)("p",{className:"text-blue-600 mt-2",children:"\u79fb\u52d5\u4e2d..."})]}):(0,Xn.jsxs)("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[(0,Xn.jsx)("div",{className:"flex items-center justify-center mb-2",children:(0,Xn.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-orange-600"})}),(0,Xn.jsx)("p",{className:"text-orange-600 font-semibold",children:"\u2694\ufe0f \u30d0\u30c8\u30eb\u304c\u767a\u751f\u3057\u305f\u306e\u3067\u3057\u3070\u3089\u304f\u304a\u5f85\u3061\u304f\u3060\u3055\u3044\u3002"}),(0,Xn.jsx)("p",{className:"text-sm text-orange-500",children:(()=>{const e=(N.activeBattle.participants||[]).map((e=>ut(e))).join(" vs ");return"".concat(e,"\u306e\u30d0\u30c8\u30eb\u4e2d\u3067\u3059")})()}),(0,Xn.jsx)("div",{className:"mt-2 text-xs text-orange-400",children:"\u30d0\u30c8\u30eb\u7d50\u679c\u3092\u304a\u5f85\u3061\u304f\u3060\u3055\u3044"})]})]}),(0,Xn.jsx)(Sr,{chatMessages:B,chatInput:q,setChatInput:W,handleSendChatMessage:Tt,onShowHelp:()=>Ce(!0),onShowTemplate:()=>je(!0),chatLogRef:H,title:"\u30c1\u30e3\u30c3\u30c8"})]}),(0,Xn.jsx)("div",{className:"lg:col-span-1 xl:col-span-4 bg-white rounded-lg shadow-md p-2 sm:p-4 h-fit",children:"4player"===(null===N||void 0===N?void 0:N.mode)?(0,Xn.jsxs)("div",{children:[(0,Xn.jsx)("h2",{className:"text-base sm:text-lg font-semibold mb-2 sm:mb-4 text-center",children:"\ud83c\udfd7\ufe0f \u8ff7\u5bae\u30d3\u30e5\u30fc\u30a2\u30fc"}),(0,Xn.jsx)("div",{className:"mb-4",children:(0,Xn.jsx)("div",{className:"flex flex-wrap gap-1 justify-center",children:null===(d=N.players)||void 0===d?void 0:d.map(((e,t)=>{const n=X===e,r=e===at?"\u81ea\u5206":"P".concat(t+1);return(0,Xn.jsxs)("button",{onClick:()=>Y(e),className:"px-2 py-1 text-xs rounded ".concat(n?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:[r,"\u306e\u8ff7\u8def"]},e)}))})}),null!==N&&void 0!==N&&null!==(h=N.mazes)&&void 0!==h&&h[X]?(0,Xn.jsxs)("div",{children:[(0,Xn.jsx)("div",{className:"flex justify-center mb-4",children:(0,Xn.jsx)("div",{className:"w-fit max-w-sm mx-auto",children:(0,Xn.jsx)(rr,{mazeData:(0,Tn.A)((0,Tn.A)({},N.mazes[X]),{},{walls:X===at?((null===(f=N.mazes[X])||void 0===f?void 0:f.walls)||[]).filter((e=>!0===e.active)):[]}),playerPosition:null,otherPlayers:[],showAllWalls:X===at,onCellClick:()=>{},gridSize:wt,sharedWalls:[],highlightPlayer:!1,smallView:!1})})}),(0,Xn.jsxs)("div",{className:"mt-3 p-2 bg-blue-50 rounded text-sm",children:[(0,Xn.jsx)("p",{className:"font-semibold text-blue-700",children:X===at?"\u81ea\u5206\u306e\u8ff7\u8def":"\u4ed6\u30d7\u30ec\u30a4\u30e4\u30fc\u306e\u8ff7\u8def"}),X===at?(0,Xn.jsx)("p",{className:"text-blue-600",children:"\u5168\u3066\u306e\u58c1\u3068\u30b9\u30bf\u30fc\u30c8\u30fb\u30b4\u30fc\u30eb\u304c\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u3059"}):(0,Xn.jsx)("p",{className:"text-blue-600",children:"\u30b9\u30bf\u30fc\u30c8\u3068\u30b4\u30fc\u30eb\u306e\u307f\u8868\u793a\u3055\u308c\u3066\u3044\u307e\u3059\uff08\u73fe\u5728\u5730\u306f\u975e\u8868\u793a\uff09"})]})]}):(0,Xn.jsx)("div",{className:"flex items-center justify-center h-48 sm:h-64 bg-gray-50 rounded",children:(0,Xn.jsx)("div",{className:"text-center",children:(0,Xn.jsx)("p",{className:"text-gray-500 mb-2",children:"\u8ff7\u8def\u30c7\u30fc\u30bf\u3092\u8aad\u307f\u8fbc\u307f\u4e2d..."})})})]}):(0,Xn.jsxs)("div",{children:[(0,Xn.jsx)("h2",{className:"text-base sm:text-lg font-semibold mb-2 sm:mb-4 text-center",children:"\ud83c\udfd7\ufe0f \u81ea\u5206\u306e\u8ff7\u5bae\uff08\u76f8\u624b\u653b\u7565\u4e2d\uff09"}),(k?null===N||void 0===N||null===(p=N.mazes)||void 0===p?void 0:p[at]:O)?(0,Xn.jsxs)("div",{children:[(0,Xn.jsx)("div",{className:"flex justify-center mb-4",children:(0,Xn.jsx)("div",{className:"w-fit max-w-sm mx-auto",children:(0,Xn.jsx)(rr,{mazeData:(0,Tn.A)((0,Tn.A)({},k?null===N||void 0===N||null===(m=N.mazes)||void 0===m?void 0:m[at]:O),{},{walls:((null===(g=k?null===N||void 0===N||null===(y=N.mazes)||void 0===y?void 0:y[at]:O)||void 0===g?void 0:g.walls)||[]).filter((e=>!0===e.active))}),playerPosition:null,otherPlayers:"2player"===(null===N||void 0===N?void 0:N.mode)&&null!==N&&void 0!==N&&N.players&&null!==N&&void 0!==N&&N.playerStates?N.players.filter((e=>e!==at)).map((e=>{const t=N.playerStates[e];return(null===t||void 0===t?void 0:t.assignedMazeOwnerId)===at&&null!==t&&void 0!==t&&t.position?{id:e,position:t.position,name:ut(e)}:null})).filter((e=>null!==e)):[],showAllWalls:!0,onCellClick:()=>{},gridSize:wt,sharedWalls:[],highlightPlayer:!1,smallView:!1})})}),(0,Xn.jsxs)("div",{className:"mt-3 p-2 bg-blue-50 rounded text-sm",children:[(0,Xn.jsx)("p",{className:"font-semibold text-blue-700",children:"\u3042\u306a\u305f\u306e\u4f5c\u3063\u305f\u8ff7\u8def:"}),(0,Xn.jsx)("p",{children:"\u76f8\u624b\u304c\u653b\u7565\u4e2d\u3067\u3059\uff08\u76f8\u624b\u306e\u73fe\u5728\u4f4d\u7f6e\u3092\u8868\u793a\uff09"}),(0,Xn.jsx)("p",{children:"\u5168\u3066\u306e\u58c1\u304c\u898b\u3048\u3066\u3044\u307e\u3059"})]})]}):(0,Xn.jsx)("div",{className:"flex items-center justify-center h-48 sm:h-64 bg-gray-50 rounded",children:(0,Xn.jsx)("div",{className:"text-center",children:(0,Xn.jsx)("p",{className:"text-gray-500 mb-2",children:"\u81ea\u5206\u306e\u8ff7\u8def\u3092\u8aad\u307f\u8fbc\u307f\u4e2d..."})})})]})})]}):(0,Xn.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,Xn.jsx)("div",{className:"lg:col-span-2 order-1 lg:order-1",children:(0,Xn.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,Xn.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"\u8ff7\u8def (\u30a8\u30af\u30b9\u30c8\u30e9\u30e2\u30fc\u30c9)"}),D?(0,Xn.jsx)("div",{className:"flex justify-center",children:(0,Xn.jsx)("div",{className:"w-fit max-w-lg mx-auto",children:(0,Xn.jsx)(rr,{mazeData:D,playerPosition:null===A||void 0===A?void 0:A.position,otherPlayers:null!==N&&void 0!==N&&N.playerStates?Object.entries(N.playerStates).filter((e=>{let[t]=e;return t!==_})).map((e=>{let[t,n]=e;return{id:t,position:n.position}})):[],revealedCells:(null===A||void 0===A?void 0:A.revealedCells)||{},revealedPlayerWalls:(null===A||void 0===A?void 0:A.revealedWalls)||[],hitWalls:(null===A||void 0===A?void 0:A.hitWalls)||[],onCellClick:gt,gridSize:wt,sharedWalls:ye,isSelectingMoveTarget:Te,selectingTrapCoord:me,onTrapCoordSelect:mt,traps:(null===N||void 0===N?void 0:N.traps)||[],highlightPlayer:!0,smallView:!1})})}):(0,Xn.jsx)("div",{className:"flex items-center justify-center h-64 bg-gray-50 rounded",children:(0,Xn.jsx)("p",{className:"text-gray-500",children:"\u8ff7\u8def\u3092\u8aad\u307f\u8fbc\u307f\u4e2d..."})})]})}),(0,Xn.jsxs)("div",{className:"order-2 lg:order-2 space-y-4",children:[(0,Xn.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,Xn.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"\u30a8\u30af\u30b9\u30c8\u30e9\u30a2\u30af\u30b7\u30e7\u30f3"}),"declaration"===(null===N||void 0===N?void 0:N.currentExtraModePhase)&&!(null!==A&&void 0!==A&&A.hasDeclaredThisTurn)&&(0,Xn.jsxs)("div",{className:"space-y-3",children:[(0,Xn.jsxs)("div",{className:"p-3 bg-blue-50 rounded-lg text-sm",children:[(0,Xn.jsx)("p",{className:"font-semibold text-blue-700 mb-2",children:"\ud83d\udcdd \u64cd\u4f5c\u624b\u9806:"}),(0,Xn.jsxs)("ul",{className:"text-blue-600 space-y-1",children:[(0,Xn.jsxs)("li",{children:["\u2022 ",(0,Xn.jsx)("strong",{children:"\u79fb\u52d5"}),": \u79fb\u52d5\u30dc\u30bf\u30f3 \u2192 \u96a3\u63a5\u30bb\u30eb\u30af\u30ea\u30c3\u30af \u2192 \u5ba3\u8a00"]}),(0,Xn.jsxs)("li",{children:["\u2022 ",(0,Xn.jsx)("strong",{children:"\u5f85\u6a5f"}),": \u5f85\u6a5f\u30dc\u30bf\u30f3 \u2192 \u5ba3\u8a00"]})]})]}),(0,Xn.jsxs)("div",{className:"grid grid-cols-1 gap-2",children:[(0,Xn.jsx)(Ct,{actionType:"move",label:"\u79fb\u52d5",icon:ur,currentSelection:re,onSelect:ie}),(0,Xn.jsx)(Ct,{actionType:"wait",label:"\u5f85\u6a5f",icon:dr,currentSelection:re,onSelect:ie})]}),de&&re?(0,Xn.jsxs)("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg shadow-inner text-sm",children:[(0,Xn.jsxs)("h4",{className:"font-semibold mb-2",children:["\u30a2\u30af\u30b7\u30e7\u30f3\u8a73\u7d30: ",re]}),"move"===re&&(0,Xn.jsxs)("div",{className:"space-y-2",children:[(0,Xn.jsx)("p",{children:"\u96a3\u63a5\u3059\u308b\u30bb\u30eb\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002"}),Ee?(0,Xn.jsxs)("div",{className:"space-y-2",children:[(0,Xn.jsxs)("p",{className:"text-green-600",children:["\u79fb\u52d5\u5148: (",Ee.r,", ",Ee.c,")"]}),(0,Xn.jsxs)("div",{className:"flex space-x-2",children:[(0,Xn.jsx)("button",{onClick:()=>{ke(null),Ie(!1)},className:"flex-1 bg-gray-500 hover:bg-gray-600 text-white p-1 rounded text-xs",children:"\u30ea\u30bb\u30c3\u30c8"}),(0,Xn.jsx)("button",{onClick:It,className:"flex-1 bg-green-500 hover:bg-green-600 text-white p-1 rounded text-xs",children:"\u5ba3\u8a00"})]})]}):(0,Xn.jsx)("button",{onClick:Nt,className:"w-full bg-cyan-500 hover:bg-cyan-600 text-white p-2 rounded",children:"\u79fb\u52d5\u5148\u3092\u9078\u629e"})]}),"wait"===re&&(0,Xn.jsxs)("div",{className:"space-y-2",children:[(0,Xn.jsx)("p",{children:"\u4f55\u3082\u3057\u306a\u3044\u3053\u3068\u3092\u5ba3\u8a00\u3057\u307e\u3059\u3002"}),(0,Xn.jsx)("button",{onClick:It,className:"w-full bg-green-500 hover:bg-green-600 text-white p-1 rounded text-xs",children:"\u5f85\u6a5f\u3092\u5ba3\u8a00"})]})]}):null]}),"declaration"===(null===N||void 0===N?void 0:N.currentExtraModePhase)&&(null===A||void 0===A?void 0:A.hasDeclaredThisTurn)&&(0,Xn.jsxs)("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[(0,Xn.jsx)(Zn,{className:"mx-auto mb-2 text-green-600",size:24}),(0,Xn.jsx)("p",{className:"text-green-600 font-semibold",children:"\u5ba3\u8a00\u5b8c\u4e86"}),(0,Xn.jsx)("p",{className:"text-sm text-green-500",children:"\u4ed6\u30d7\u30ec\u30a4\u30e4\u30fc\u3092\u5f85\u3063\u3066\u3044\u307e\u3059..."})]}),"actionExecution"===(null===N||void 0===N?void 0:N.currentExtraModePhase)&&(0,Xn.jsxs)("div",{className:"p-4 bg-gray-50 rounded-lg",children:[(0,Xn.jsx)("h4",{className:"font-semibold mb-2",children:"\u30a2\u30af\u30b7\u30e7\u30f3\u5b9f\u884c\u4e2d"}),(0,Xn.jsxs)("p",{className:"text-sm",children:["\u73fe\u5728: ",N.currentActionPlayerId===_?(0,Xn.jsx)("span",{className:"text-blue-600 font-semibold",children:lt}):(0,Xn.jsx)("span",{className:"text-orange-600 font-semibold",children:"\u76f8\u624b"})]}),N.currentActionPlayerId===_&&A.declaredAction&&!A.actionExecutedThisTurn&&(0,Xn.jsx)("p",{className:"text-blue-600 mt-1 text-sm",children:"\u30a2\u30af\u30b7\u30e7\u30f3\u3092\u5b9f\u884c\u4e2d..."})]})]}),(0,Xn.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-4",children:[(0,Xn.jsx)("h3",{className:"text-lg font-semibold mb-3",children:"\u30d7\u30ec\u30a4\u30e4\u30fc\u60c5\u5831"}),(0,Xn.jsx)("div",{className:"space-y-2",children:null===N||void 0===N||null===(v=N.players)||void 0===v?void 0:v.map((e=>{var t,n;const r=N.playerStates[e],i=e===_,s=N.currentActionPlayerId===e;return(0,Xn.jsxs)("div",{className:"p-3 rounded-lg border-2 ".concat(i?"border-blue-300 bg-blue-50":"border-gray-200 bg-gray-50"," ").concat(s?"ring-2 ring-green-300":""),children:[(0,Xn.jsxs)("div",{className:"flex items-center justify-between",children:[(0,Xn.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,Xn.jsx)(On,{size:16,className:i?"text-blue-600":"text-gray-500"}),(0,Xn.jsx)("span",{className:"font-medium ".concat(i?"text-blue-800":"text-gray-700"),children:i?lt:"\u30d7\u30ec\u30a4\u30e4\u30fc ".concat(e.substring(0,8),"...")}),s&&(0,Xn.jsx)("span",{className:"bg-green-500 text-white text-xs px-2 py-1 rounded-full",children:"\u5b9f\u884c\u4e2d"})]}),(0,Xn.jsxs)("div",{className:"text-right text-sm",children:[(0,Xn.jsxs)("div",{children:["\u30b9\u30b3\u30a2: ",(null===r||void 0===r?void 0:r.score)||0,"pt"]}),(0,Xn.jsxs)("div",{className:"text-xs text-gray-500",children:["\u4f4d\u7f6e: (",(null===r||void 0===r||null===(t=r.position)||void 0===t?void 0:t.r)||0,", ",(null===r||void 0===r||null===(n=r.position)||void 0===n?void 0:n.c)||0,")"]})]})]}),(null===r||void 0===r?void 0:r.goalTime)&&(0,Xn.jsxs)("div",{className:"mt-2 flex items-center space-x-1",children:[(0,Xn.jsx)(hr,{size:14,className:"text-yellow-500"}),(0,Xn.jsx)("span",{className:"text-sm text-yellow-600 font-semibold",children:"\u30b4\u30fc\u30eb\u9054\u6210\uff01"})]})]},e)}))})]}),(0,Xn.jsx)(Sr,{chatMessages:B,chatInput:q,setChatInput:W,handleSendChatMessage:Tt,onShowHelp:()=>Ce(!0),onShowTemplate:()=>je(!0),chatLogRef:H,title:"\u30c1\u30e3\u30c3\u30c8"})]})]}),K&&(null===N||void 0===N?void 0:N.activeBattle)&&(null===(b=N.activeBattle.participants)||void 0===b?void 0:b.includes(k?at:_))&&(0,Xn.jsx)(mr,{isOpen:K,onClose:()=>Q(!1),onBet:async e=>{if(null!==N&&void 0!==N&&N.activeBattle)try{const t=(0,wn.doc)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),T),n=k?at:_,r={["playerStates.".concat(n,".battleBet")]:e,["playerStates.".concat(n,".score")]:(0,wn.GV)(-e)};await(0,wn.updateDoc)(t,r),Q(!1),F("\u30dd\u30a4\u30f3\u30c8\u3092\u8ced\u3051\u307e\u3057\u305f\u3002\u76f8\u624b\u306e\u5165\u529b\u3092\u5f85\u3063\u3066\u3044\u307e\u3059...")}catch(t){console.error("Error placing battle bet:",t),F("\u8ced\u3051\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002")}},maxBet:(null===ot||void 0===ot?void 0:ot.score)||0,opponentName:(null===N||void 0===N||null===(w=N.activeBattle)||void 0===w||null===(x=w.participants)||void 0===x?void 0:x.filter((e=>e!==(k?at:_))).map((e=>ut(e))).join(", "))||"\u76f8\u624b",myName:at,myCurrentScore:(null===ot||void 0===ot?void 0:ot.score)||0}),_e&&(0,Xn.jsx)(yr,{isOpen:_e,onClose:()=>Se(!1),gameData:N,userId:_,onReturnToLobby:()=>{pt(),S("lobby")},onStartReview:()=>Pe(!0)}),Oe&&Me&&(0,Xn.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Xn.jsx)("div",{className:"bg-white rounded-lg p-8 max-w-md w-11/12",children:(0,Xn.jsxs)("div",{className:"text-center",children:[(0,Xn.jsx)(hr,{className:"mx-auto mb-4 text-yellow-500",size:48}),(0,Xn.jsx)("h2",{className:"text-2xl font-bold mb-4 text-gray-800",children:Me.message}),(0,Xn.jsxs)("div",{className:"mb-6 space-y-2",children:[Me.rank&&(0,Xn.jsxs)("p",{className:"text-lg text-gray-700",children:["\u9806\u4f4d: ",Me.rank,"\u4f4d"]}),Me.points>0&&(0,Xn.jsxs)("p",{className:"text-lg text-green-600",children:["\u7372\u5f97\u30dd\u30a4\u30f3\u30c8: +",Me.points,"pt"]}),(0,Xn.jsxs)("p",{className:"text-sm text-gray-500",children:["\u30b4\u30fc\u30eb\u6642\u523b: ",Me.goalTime.toLocaleTimeString()]})]}),(0,Xn.jsxs)("div",{className:"flex flex-col space-y-3",children:[(0,Xn.jsx)("button",{onClick:()=>{Re(!1),Pe(!0)},className:"w-full bg-blue-500 text-white py-2 px-4 rounded-lg hover:bg-blue-600 transition-colors",children:"\u611f\u60f3\u6226\u30e2\u30fc\u30c9\u3078"}),(0,Xn.jsx)("button",{onClick:()=>{Re(!1),pt(),S("lobby")},className:"w-full bg-gray-500 text-white py-2 px-4 rounded-lg hover:bg-gray-600 transition-colors",children:"\u30ed\u30d3\u30fc\u306b\u623b\u308b"})]})]})})}),De&&(0,Xn.jsx)(_r,{gameData:N,mazeData:D,allMazeData:(null===N||void 0===N?void 0:N.mazes)||{},userId:_,gameId:T,onExit:()=>{Pe(!1),pt(),S("lobby")}}),Ne&&(0,Xn.jsx)(Yn,{page:1,onClose:()=>Ce(!1)}),Ae&&(0,Xn.jsx)(kr,{isOpen:Ae,onClose:()=>je(!1),onSelectTemplate:e=>{W(e)}}),He&&(0,Xn.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Xn.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-11/12",children:[(0,Xn.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-800",children:"\u30b2\u30fc\u30e0\u304c\u4e2d\u65ad\u3055\u308c\u307e\u3057\u305f"}),(0,Xn.jsxs)("p",{className:"text-gray-600 mb-6",children:[Qe,"\u304c\u30b2\u30fc\u30e0\u3092\u4e2d\u65ad\u3057\u307e\u3057\u305f\u3002",(0,Xn.jsx)("br",{}),"\u30db\u30fc\u30e0\u306b\u623b\u308a\u307e\u3059\u3002"]}),(0,Xn.jsx)("div",{className:"flex justify-center",children:(0,Xn.jsx)("button",{onClick:()=>{console.log("\ud83c\udfe0 [GameInterrupted] User confirmed game interruption, returning to lobby:",{interruptedBy:Qe,debugMode:k,actualUserId:_.substring(0,8)}),Ke(!1),Xe(""),pt(),S("lobby")},className:"px-6 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg font-semibold",children:"\u78ba\u8a8d"})})]})}),Ye&&(0,Xn.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,Xn.jsxs)("div",{className:"bg-white rounded-lg p-6 max-w-md w-11/12",children:[(0,Xn.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-800 text-center",children:"\u2694\ufe0f \u30d0\u30c8\u30eb\u304c\u767a\u751f\u3057\u307e\u3057\u305f"}),(0,Xn.jsx)("div",{className:"text-center mb-6",children:(0,Xn.jsxs)("div",{className:"mb-4",children:[(0,Xn.jsx)("div",{className:"flex items-center justify-center mb-2",children:(0,Xn.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600"})}),(0,Xn.jsx)("p",{className:"text-gray-600 mb-2",children:"\u4ee5\u4e0b\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u9593\u3067\u30d0\u30c8\u30eb\u304c\u767a\u751f\u3057\u3066\u3044\u307e\u3059\uff1a"}),(0,Xn.jsx)("div",{className:"flex justify-center space-x-2 mb-4",children:Je.map(((e,t)=>(0,Xn.jsxs)("span",{className:"font-semibold text-blue-600",children:[ut(e),t<Je.length-1&&" vs "]},e)))}),(0,Xn.jsx)("p",{className:"text-orange-600 font-semibold",children:"\u30d0\u30c8\u30eb\u7d42\u4e86\u307e\u3067\u304a\u5f85\u3061\u304f\u3060\u3055\u3044"}),(0,Xn.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"\u4e21\u30d7\u30ec\u30a4\u30e4\u30fc\u304c\u30dd\u30a4\u30f3\u30c8\u3092\u8ced\u3051\u3001\u7d50\u679c\u304c\u6c7a\u307e\u308b\u307e\u3067\u30b2\u30fc\u30e0\u306f\u4e00\u6642\u505c\u6b62\u3055\u308c\u307e\u3059"})]})}),(0,Xn.jsx)("div",{className:"text-center text-xs text-gray-400",children:"\u3053\u306e\u30c0\u30a4\u30a2\u30ed\u30b0\u306f\u81ea\u52d5\u7684\u306b\u9589\u3058\u3089\u308c\u307e\u3059"})]})}),k&&(0,Xn.jsx)(Cr,{debugMode:k,gameData:N,debugCurrentPlayerId:et,setDebugCurrentPlayerId:tt,showOpponentWallsDebug:z,setShowOpponentWallsDebug:V,debugPlayerStates:nt,userId:_})]})};const jr=function(){const[e,t]=(0,r.useState)("lobby"),[i,s]=(0,r.useState)(null),[o,l]=(0,r.useState)(!1),[c,u]=(0,r.useState)("2player"),[d,h]=(0,r.useState)(!1),[f,p]=(0,r.useState)(navigator.onLine);(0,r.useEffect)((()=>{(async()=>{try{!function(e,t,n,r){(0,a.Ku)(e).onAuthStateChanged(t,n,r)}(Sn,(async e=>{if(e)s(e.uid),await m(e.uid);else if("undefined"!==typeof window&&"undefined"!==typeof window.__initial_auth_token&&window.__initial_auth_token)try{await rt(Sn,window.__initial_auth_token)}catch(t){console.error("Error signing in with custom token, falling back to anonymous:",t),await $e(Sn)}else await $e(Sn);l(!0)}))}catch(e){console.error("Firebase Auth Error:",e),l(!0)}})()}),[]),(0,r.useEffect)((()=>{const e=async()=>{console.log("\ud83c\udf10 [Network] Connection restored"),p(!0);try{await(0,wn.Os)(En),console.log("\u2705 [Network] Firestore network enabled")}catch(e){console.error("\u274c [Network] Error enabling Firestore network:",e)}},t=async()=>{console.log("\ud83c\udf10 [Network] Connection lost"),p(!1);try{await(0,wn.LA)(En),console.log("\u26a0\ufe0f [Network] Firestore network disabled")}catch(e){console.error("\u274c [Network] Error disabling Firestore network:",e)}};return window.addEventListener("online",e),window.addEventListener("offline",t),navigator.onLine?e():t(),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",t)}}),[]);const m=async e=>{try{console.log("\ud83e\uddf9 [App] Starting stale game data cleanup for user:",e);const r=localStorage.getItem("labyrinthGameId");if(r){const i=(0,wn.doc)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),r),s=await(0,wn.getDoc)(i);if(s.exists()){var n;const r=s.data(),i=null===(n=r.createdAt)||void 0===n?void 0:n.toDate(),a=new Date,o=new Date(a.getTime()-36e5);!i||i<o||!r.players||!r.players.includes(e)||"abandoned"===r.status||"disbanded"===r.status?(console.log("\ud83d\uddd1\ufe0f [App] Clearing stale game data from localStorage"),localStorage.removeItem("labyrinthGameId"),localStorage.removeItem("labyrinthGameType")):(console.log("\u2705 [App] Game data is valid, keeping it"),"creating"===r.status?t("courseCreation"):"playing"===r.status&&t("play"))}else console.log("\ud83d\uddd1\ufe0f [App] Game document does not exist, clearing localStorage"),localStorage.removeItem("labyrinthGameId"),localStorage.removeItem("labyrinthGameType")}}catch(r){console.error("\u274c [App] Error during stale game data cleanup:",r),localStorage.removeItem("labyrinthGameId"),localStorage.removeItem("labyrinthGameType")}};if((0,r.useEffect)((()=>{const e=async e=>{console.log("\ud83d\udeaa [Cleanup] User is leaving the page, starting cleanup...");const t=localStorage.getItem("labyrinthGameId");if(t&&i)try{const{updateDoc:e,doc:r,getDoc:s,deleteField:a,runTransaction:o,serverTimestamp:l}=await Promise.resolve().then(n.bind(n,472)),c=r(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),t);await o(En,(async e=>{const t=await e.get(c);if(t.exists()){const n=(t.data().players||[]).filter((e=>e!==i)),r={["playerStates.".concat(i)]:a(),players:n,["mazes.".concat(i)]:a(),["declarations.".concat(i)]:a(),lastActivity:l()};0===n.length&&(r.status="disbanded",r.disbandReason="\u30d7\u30ec\u30a4\u30e4\u30fc\u304c\u5168\u54e1\u96e2\u8131\u3057\u305f\u305f\u3081",r.disbandedAt=l()),e.update(c,r)}})),console.log("\u2705 [Cleanup] Firebase game data cleaned up")}catch(s){console.error("\u274c [Cleanup] Error cleaning up Firebase data:",s)}["labyrinthGameId","labyrinthGameType","labyrinth_username","userId","gameState","playerPosition","lastActivity"].forEach((e=>localStorage.removeItem(e))),console.log("\ud83d\udd04 [Cleanup] Local storage cleared on page unload");const r="\u30da\u30fc\u30b8\u3092\u96e2\u308c\u308b\u3068\u30e6\u30fc\u30b6\u30fc\u60c5\u5831\u304c\u30ea\u30bb\u30c3\u30c8\u3055\u308c\u307e\u3059\u3002";return e.returnValue=r,r},t=async()=>{"hidden"===document.visibilityState&&(console.log("\ud83d\udc41\ufe0f [Cleanup] Page hidden, clearing local data..."),localStorage.removeItem("labyrinthGameId"),localStorage.removeItem("labyrinthGameType"),localStorage.removeItem("labyrinth_username"),localStorage.removeItem("userId"),console.log("\ud83d\udd04 [Cleanup] Local storage cleared on visibility change"))};return window.addEventListener("beforeunload",e),document.addEventListener("visibilitychange",t),()=>{window.removeEventListener("beforeunload",e),document.removeEventListener("visibilitychange",t)}}),[i]),(0,r.useEffect)((()=>{if(o&&i){const e=new URLSearchParams(window.location.search).get("debug");"true"!==e&&"1"!==e||(h(!0),console.log("\ud83d\udd27 [DEBUG MODE] Enabled for 2-player and 4-player testing"));const n=localStorage.getItem("labyrinthGameId");if(n){console.log("\ud83d\udd0d [DEBUG] Checking existing game:",n);const e=(0,wn.doc)(En,"artifacts/".concat(kn,"/public/data/labyrinthGames"),n);(0,wn.getDoc)(e).then((e=>{if(e.exists()){const n=e.data();console.log("\ud83d\udd0d [DEBUG] Game data found:",{mode:n.mode,gameType:n.gameType,status:n.status,players:n.players,currentUserId:i});if("disbanded"===n.status||"finished"===n.status||!n.players||!n.players.includes(i)||!n.playerStates||!n.playerStates[i]){console.log("\u274c [DEBUG] Game is invalid or user not in players, clearing localStorage");return void["labyrinthGameId","labyrinthGameType","labyrinth_username","userId","gameState","playerPosition","lastActivity"].forEach((e=>localStorage.removeItem(e)))}u(n.mode),"creating"===n.status?(console.log("\ud83c\udfd7\ufe0f [DEBUG] Redirecting to course creation"),t("courseCreation")):"playing"===n.status||"finished"===n.status||"extra"===n.gameType&&n.currentExtraModePhase?(console.log("\ud83c\udfae [DEBUG] Redirecting to play screen"),t("play")):(console.log("\ud83d\uddd1\ufe0f [DEBUG] Invalid game status, clearing localStorage"),localStorage.removeItem("labyrinthGameId"),localStorage.removeItem("labyrinthGameType"))}else console.log("\u274c [DEBUG] Game document not found, clearing localStorage"),localStorage.removeItem("labyrinthGameId"),localStorage.removeItem("labyrinthGameType")})).catch((e=>{console.error("\u274c [DEBUG] Error checking for existing game:",e),localStorage.removeItem("labyrinthGameId"),localStorage.removeItem("labyrinthGameType")}))}else console.log("\ud83d\udcdd [DEBUG] No stored game ID, staying on lobby")}}),[o,i]),!o)return(0,Xn.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-slate-800 text-white text-xl",children:"\u8a8d\u8a3c\u60c5\u5831\u3092\u8aad\u307f\u8fbc\u307f\u4e2d..."});if(!i&&o)return(0,Xn.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-slate-800 text-white text-xl",children:"\u8a8d\u8a3c\u306b\u5931\u6557\u3057\u307e\u3057\u305f\u3002\u30da\u30fc\u30b8\u3092\u30ea\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\u3002"});switch(e){case"courseCreation":return(0,Xn.jsx)(ir,{userId:i,setScreen:t,gameMode:c,debugMode:d,isOnline:f});case"play":return(0,Xn.jsx)(Ar,{userId:i,setScreen:t,gameMode:c,debugMode:d,isOnline:f});default:return(0,Xn.jsx)($n,{setGameMode:u,setScreen:t,userId:i,debugMode:d,isOnline:f})}};i.createRoot(document.getElementById("root")).render((0,Xn.jsx)(r.StrictMode,{children:(0,Xn.jsx)(jr,{})}))})();
//# sourceMappingURL=main.0e021878.js.map